2022-03-02 10:57:20.153 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 39189 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 10:57:20.160 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 10:57:21.806 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 10:57:21.810 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 10:57:21.844 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 26 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 10:57:21.852 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 10:57:21.853 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 10:57:21.872 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 10:57:21.902 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 10:57:21.905 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 10:57:21.938 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2022-03-02 10:57:23.054 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 10:57:23.081 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 10:57:23.082 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 10:57:23.082 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 10:57:23.280 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 10:57:23.281 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3027 ms
2022-03-02 10:57:25.167 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 10:57:26.507 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 10:57:26.509 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 10:57:26.509 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 10:57:26.849 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 10:57:26.879 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 10:57:26.900 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 7.792 seconds (JVM running for 8.446)
2022-03-02 10:57:36.225 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 10:57:36.226 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 10:57:36.228 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2022-03-02 10:57:36.515 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 10:57:39.505 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 10:57:39.517 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-02 10:57:39.551 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 10:57:39.692 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 10:57:39.855 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,账户:[UserBalanceChain(userId=51905047, currencyId=6, balance=996.7691794400000000, hold=0E-16)]
2022-03-02 10:58:08.336 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 10:58:08.348 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 13:41:06.127 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 40269 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 13:41:06.130 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 13:41:07.200 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 13:41:07.203 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 13:41:07.229 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 13:41:07.234 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 13:41:07.235 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 13:41:07.243 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 13:41:07.258 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 13:41:07.260 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 13:41:07.279 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2022-03-02 13:41:08.128 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 13:41:08.144 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 13:41:08.145 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 13:41:08.145 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 13:41:08.290 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 13:41:08.290 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2104 ms
2022-03-02 13:41:09.597 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 13:41:10.688 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 13:41:10.689 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 13:41:10.689 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 13:41:10.949 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 13:41:10.967 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 13:41:10.979 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.722 seconds (JVM running for 6.243)
2022-03-02 13:41:19.865 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 13:41:19.866 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 13:41:19.867 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 13:41:20.304 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 13:41:21.486 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 13:41:21.501 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 13:41:21.540 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-02 13:41:21.655 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 13:41:21.660 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-02 13:41:21.661 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 13:41:21.740 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 13:41:21.740 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:995.2283278800000000,hold:0E-16
2022-03-02 13:41:21.756 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:996.76917944,操作后，账户变化金额:-4.7716721200000000,操作后，计算剩余的金额:991.9975073200000000,操作后，数据库存储的总金额:995.2283278800000000
2022-03-02 13:41:21.757 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-02 13:41:21.757 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 13:41:21.839 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 13:41:21.840 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-02 13:41:21.840 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 13:41:21.921 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 13:41:21.922 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-02 13:41:21.922 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 13:41:22.003 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 13:41:22.004 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-02 13:41:22.004 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 13:41:22.086 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 13:41:22.087 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 13:41:22.088 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 13:41:22.169 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 13:41:22.170 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[UserDistributorChain(userId=51905047, parentId=51905041, gparentId=0, partnerId=51905041, distId=0, level=1, type=3, defaulted=0, openBet=1, isProfession=0, config=), UserDistributorChain(userId=51905041, parentId=51905043, gparentId=0, partnerId=51905043, distId=0, level=1, type=0, defaulted=0, openBet=1, isProfession=0, config={"allotLowerFeeRate":0.200000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51905043, parentId=51905052, gparentId=0, partnerId=51905052, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51905052, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 13:41:22.171 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-02 13:41:22.171 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 13:41:22.263 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 7
2022-03-02 13:41:22.263 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=51, size=-0.9072777600000000, preBalance=1000.0000000000000000, postBalance=999.0927222400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1455, note=单号:1455开仓手续费-0.9072777600000000, createdDate=2022-03-01 22:31:37, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.8176628800000000, preBalance=999.0927222400000000, postBalance=998.2750593600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1456, note=单号:1456开仓手续费-0.8176628800000000, createdDate=2022-03-01 22:31:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.5954202400000000, preBalance=998.2750593600000000, postBalance=997.6796391200000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1457, note=单号:1457开仓手续费-0.5954202400000000, createdDate=2022-03-01 23:36:18, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.9104596800000000, preBalance=997.6796391200000000, postBalance=996.7691794400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1458, note=单号:1458开仓手续费-0.9104596800000000, createdDate=2022-03-01 23:36:38, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0790265600000000, preBalance=996.7691794400000000, postBalance=995.6901528800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1463, note=单号:1463开仓手续费-1.0790265600000000, createdDate=2022-03-02 11:09:53, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.2309226400000000, preBalance=995.6901528800000000, postBalance=995.4592302400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1466, note=单号:1466开仓手续费-0.2309226400000000, createdDate=2022-03-02 11:40:39, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.2309023600000000, preBalance=995.4592302400000000, postBalance=995.2283278800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1467, note=单号:1467开仓手续费-0.2309023600000000, createdDate=2022-03-02 11:44:19, fromUserId=0, total=null)]
2022-03-02 13:41:22.265 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-02 13:41:22.265 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9072777600000000
2022-03-02 13:41:22.333 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '41' AND `user_id` = '51905047' AND `source_id` = '1455' 
2022-03-02 13:41:22.334 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 13:41:22.414 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 0
2022-03-02 13:41:46.904 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 13:41:46.918 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 18:13:09.570 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41619 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 18:13:09.572 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 18:13:10.755 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:13:10.759 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:13:10.785 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 18:13:10.791 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:13:10.792 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:13:10.801 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 18:13:10.816 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:13:10.818 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 18:13:10.845 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2022-03-02 18:13:11.612 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 18:13:11.630 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 18:13:11.631 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 18:13:11.631 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 18:13:11.780 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 18:13:11.780 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2138 ms
2022-03-02 18:13:12.714 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'toolController': Unsatisfied dependency expressed through field 'toolService'; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'toolServiceImpl': Unsatisfied dependency expressed through field 'feeAndProfitCalc'; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'com.zmj.demo.common.dev1.FeeAndProfitCalc' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
2022-03-02 18:13:12.719 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2022-03-02 18:13:12.732 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-03-02 18:13:12.762 [main] ERROR o.s.b.diagnostics.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Field feeAndProfitCalc in com.zmj.demo.service.impl.ToolServiceImpl required a bean of type 'com.zmj.demo.common.dev1.FeeAndProfitCalc' that could not be found.

The injection point has the following annotations:
	- @org.springframework.beans.factory.annotation.Autowired(required=true)


Action:

Consider defining a bean of type 'com.zmj.demo.common.dev1.FeeAndProfitCalc' in your configuration.

2022-03-02 18:13:47.050 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41628 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 18:13:47.053 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 18:13:48.071 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:13:48.074 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:13:48.106 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 22 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 18:13:48.112 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:13:48.113 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:13:48.119 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 18:13:48.131 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:13:48.133 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 18:13:48.150 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2022-03-02 18:13:48.815 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 18:13:48.829 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 18:13:48.829 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 18:13:48.830 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 18:13:48.994 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 18:13:48.995 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1873 ms
2022-03-02 18:13:50.300 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 18:13:51.279 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 18:13:51.280 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 18:13:51.280 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 18:13:51.554 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 18:13:51.573 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 18:13:51.585 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.204 seconds (JVM running for 5.704)
2022-03-02 18:15:03.190 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 18:15:03.191 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 18:15:03.193 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2022-03-02 18:15:03.511 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 18:15:04.706 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 18:15:04.723 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:15:04.776 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:15:04.885 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:15:05.005 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,账户:[UserBalanceChain(userId=51905053, currencyId=6, balance=1000.0000000000000000, hold=0E-16)]
2022-03-02 18:15:59.709 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:15:59.710 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:15:59.794 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:15:59.796 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:15:59.798 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:15:59.881 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:15:59.882 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:15:59.895 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:15:59.896 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:15:59.896 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:15:59.987 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:15:59.988 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:15:59.988 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:16:00.078 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:16:00.078 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:16:00.079 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:16:00.080 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:16:00.173 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:16:00.179 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:16:00.180 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:16:00.180 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:16:00.248 [http-nio-10090-exec-3] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:17:48.638 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:17:48.639 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:17:48.727 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:17:48.728 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:17:48.728 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:17:48.815 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:17:48.815 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:17:48.816 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:17:48.817 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:17:48.817 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:17:48.902 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:17:48.903 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:17:48.903 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:17:48.989 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:17:48.990 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:17:48.990 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:17:48.991 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:17:49.079 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:17:49.080 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:17:49.080 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:17:49.080 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:17:49.081 [http-nio-10090-exec-6] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:18:04.626 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 18:18:04.637 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 18:18:13.908 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41669 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 18:18:13.911 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 18:18:14.927 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:18:14.930 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:18:14.949 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 18:18:14.954 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:18:14.955 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:18:14.963 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 18:18:14.973 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:18:14.974 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 18:18:14.990 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2022-03-02 18:18:15.885 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 18:18:15.900 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 18:18:15.901 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 18:18:15.901 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 18:18:16.001 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 18:18:16.002 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2027 ms
2022-03-02 18:18:17.428 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 18:18:18.311 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 18:18:18.313 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 18:18:18.313 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 18:18:18.584 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 18:18:18.605 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 18:18:18.618 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.497 seconds (JVM running for 6.136)
2022-03-02 18:18:58.637 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 18:18:58.637 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 18:18:58.639 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 18:18:59.033 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 18:19:00.168 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 18:19:00.182 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:19:00.219 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:19:00.341 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:19:00.346 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:19:00.346 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:19:00.430 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:19:00.431 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:19:00.449 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:19:00.450 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:19:00.450 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:19:00.538 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:19:00.539 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:19:00.539 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:19:00.648 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:19:00.649 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:19:00.650 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:19:00.651 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:19:00.770 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:19:00.770 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:19:00.771 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:19:00.771 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:22:11.918 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m1s450ms).
2022-03-02 18:22:12.106 [http-nio-10090-exec-1] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:23:56.859 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 18:23:56.864 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 18:24:03.407 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41700 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 18:24:03.409 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 18:24:04.471 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:24:04.473 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:24:04.495 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 18:24:04.501 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:24:04.502 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:24:04.512 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 18:24:04.525 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:24:04.526 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 18:24:04.552 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
2022-03-02 18:24:05.270 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 18:24:05.283 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 18:24:05.283 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 18:24:05.283 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 18:24:05.416 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 18:24:05.416 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1952 ms
2022-03-02 18:24:06.508 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 18:24:07.376 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 18:24:07.378 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 18:24:07.378 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 18:24:07.649 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 18:24:07.670 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 18:24:07.689 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.105 seconds (JVM running for 5.718)
2022-03-02 18:24:12.650 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 18:24:12.650 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 18:24:12.651 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 18:24:13.049 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 18:24:14.727 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 18:24:14.739 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:24:14.770 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:24:15.092 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:24:15.098 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:24:15.098 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:24:15.182 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:24:15.183 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:24:15.199 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:24:15.200 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:24:15.200 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:24:15.285 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:24:15.286 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:24:15.287 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:24:15.374 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:24:15.374 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:24:15.376 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:24:15.376 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:24:15.466 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:24:15.467 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:24:15.467 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:24:15.467 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:24:15.538 [http-nio-10090-exec-1] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:24:39.417 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 18:24:39.428 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 18:24:46.509 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41712 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 18:24:46.512 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 18:24:47.915 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:24:47.918 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:24:47.939 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 18:24:47.944 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:24:47.945 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:24:47.955 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 18:24:47.965 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:24:47.966 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 18:24:47.982 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2022-03-02 18:24:49.015 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 18:24:49.030 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 18:24:49.031 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 18:24:49.032 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 18:24:49.162 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 18:24:49.162 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2579 ms
2022-03-02 18:24:50.607 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 18:24:51.564 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 18:24:51.566 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 18:24:51.566 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 18:24:51.840 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 18:24:51.858 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 18:24:51.870 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 6.298 seconds (JVM running for 7.116)
2022-03-02 18:24:55.606 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 18:24:55.607 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 18:24:55.608 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 18:24:56.024 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 18:24:57.176 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 18:24:57.185 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:24:57.220 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:24:57.345 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:24:57.351 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:24:57.352 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:24:57.435 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:24:57.436 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:24:57.447 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:24:57.448 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:24:57.448 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:24:57.536 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:24:57.537 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:24:57.538 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:24:57.625 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:24:57.626 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:24:57.627 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:24:57.628 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:24:57.718 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:24:57.719 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:24:57.720 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:24:57.720 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:25:25.969 [http-nio-10090-exec-1] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:25:37.775 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 18:25:37.787 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 18:25:42.344 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41720 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 18:25:42.348 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 18:25:43.386 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:25:43.391 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:25:43.413 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 18:25:43.418 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:25:43.419 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:25:43.426 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 18:25:43.437 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:25:43.439 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 18:25:43.455 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2022-03-02 18:25:44.443 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 18:25:44.528 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 18:25:44.529 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 18:25:44.529 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 18:25:44.634 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 18:25:44.635 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2220 ms
2022-03-02 18:25:46.094 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 18:25:46.997 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 18:25:46.999 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 18:25:46.999 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 18:25:47.274 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 18:25:47.294 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 18:25:47.309 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.849 seconds (JVM running for 6.507)
2022-03-02 18:25:50.537 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 18:25:50.537 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 18:25:50.540 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2022-03-02 18:25:51.084 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 18:25:52.267 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 18:25:52.278 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:25:52.327 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:25:52.443 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:25:52.448 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:25:52.449 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:25:52.539 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:25:52.540 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:25:52.562 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:25:52.577 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:25:52.577 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:25:52.668 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:25:52.669 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:25:52.669 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:25:52.759 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:25:52.760 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:25:52.760 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:25:52.761 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:25:52.863 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:25:52.864 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:25:52.865 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:25:52.865 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:25:58.152 [http-nio-10090-exec-1] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:28:35.606 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:28:35.609 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:28:35.697 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:28:35.698 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:28:35.698 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:28:35.789 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:28:35.789 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:28:35.790 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:28:35.791 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:28:35.791 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:28:35.884 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:28:35.885 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:28:35.885 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:28:35.989 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:28:35.991 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:28:35.992 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:28:35.993 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:28:36.083 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:28:36.083 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:28:36.083 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:28:36.084 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:29:33.490 [http-nio-10090-exec-4] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:29:33.596 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 18:29:33.606 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 18:29:38.272 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41742 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 18:29:38.278 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 18:29:39.505 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:29:39.508 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:29:39.531 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 18:29:39.537 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:29:39.538 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 18:29:39.546 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 18:29:39.559 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 18:29:39.561 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 18:29:39.580 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2022-03-02 18:29:40.436 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 18:29:40.451 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 18:29:40.451 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 18:29:40.452 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 18:29:40.555 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 18:29:40.556 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2180 ms
2022-03-02 18:29:41.874 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 18:29:42.814 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 18:29:42.815 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 18:29:42.816 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 18:29:43.108 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 18:29:43.129 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 18:29:43.143 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.609 seconds (JVM running for 6.229)
2022-03-02 18:37:58.457 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 18:37:58.459 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 18:37:58.460 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 18:37:58.865 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 18:38:00.058 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 18:38:00.068 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:38:00.099 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:38:00.231 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:38:00.237 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:38:00.237 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:38:00.327 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:38:00.328 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:38:00.339 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:38:00.340 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:38:00.340 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:38:00.436 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:38:00.437 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:38:00.437 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:38:00.527 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:38:00.528 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:38:00.529 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:38:00.529 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:38:00.623 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:38:00.624 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:38:00.624 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:38:00.625 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:38:22.527 [http-nio-10090-exec-1] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:38:45.314 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:38:45.315 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:38:45.405 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:38:45.407 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:38:45.407 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:38:45.497 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:38:45.497 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:38:45.498 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:38:45.499 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:38:45.499 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:38:45.595 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:38:45.597 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:38:45.598 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:38:45.691 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:38:45.692 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:38:45.693 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:38:45.693 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:38:45.787 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:38:45.788 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:38:45.788 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:38:45.788 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:38:53.180 [http-nio-10090-exec-3] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:40:47.046 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 18:40:47.048 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 18:40:47.138 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 18:40:47.139 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:40:47.140 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 18:40:47.230 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 18:40:47.230 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 18:40:47.231 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 18:40:47.231 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 18:40:47.231 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:40:47.325 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:40:47.326 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 18:40:47.326 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 18:40:47.419 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 18:40:47.419 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 18:40:47.420 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 18:40:47.420 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 18:40:47.509 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 18:40:47.510 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 18:40:47.510 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 18:40:47.510 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 18:42:48.557 [http-nio-10090-exec-6] ERROR com.zmj.demo.service.impl.ToolServiceImpl - java.lang.NullPointerException
2022-03-02 18:42:48.664 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 18:42:48.675 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 19:18:49.657 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41964 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 19:18:49.660 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 19:18:50.681 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:18:50.685 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:18:50.710 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 19:18:50.715 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:18:50.716 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:18:50.725 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 19:18:50.739 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:18:50.741 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 19:18:50.757 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2022-03-02 19:18:51.636 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 19:18:51.653 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 19:18:51.654 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 19:18:51.654 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 19:18:51.805 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 19:18:51.806 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2095 ms
2022-03-02 19:18:53.415 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 19:18:54.453 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 19:18:54.454 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 19:18:54.454 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 19:18:54.745 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 19:18:54.774 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 19:18:54.792 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 6.154 seconds (JVM running for 6.767)
2022-03-02 19:19:01.032 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 19:19:01.033 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 19:19:01.035 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2022-03-02 19:19:01.473 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 19:19:02.690 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 19:19:02.704 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:19:02.757 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:19:02.871 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:19:02.879 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:19:02.879 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:19:02.966 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:19:02.967 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 19:19:02.984 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 19:19:02.985 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:19:02.985 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:19:03.070 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:19:03.071 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:19:03.071 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:19:03.157 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:19:03.158 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:19:03.159 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:19:03.159 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:19:03.255 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 19:19:03.256 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 19:19:03.257 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:19:03.257 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 19:19:03.302 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1582' and type=? limit 0,1 
2022-03-02 19:19:03.303 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:19:03.396 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:19:03.397 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1582,比列:1,数据库:-0.9696654000000000,计算:0.96966500
2022-03-02 19:19:03.397 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:19:31.272 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 19:19:31.284 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 19:22:07.688 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41982 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 19:22:07.696 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 19:22:08.828 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:22:08.835 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:22:08.882 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 37 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 19:22:08.895 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:22:08.895 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:22:08.914 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 19:22:08.942 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:22:08.945 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 19:22:08.979 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2022-03-02 19:22:09.949 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 19:22:09.962 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 19:22:09.963 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 19:22:09.963 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 19:22:10.096 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 19:22:10.097 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2348 ms
2022-03-02 19:22:11.603 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 19:22:12.442 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 19:22:12.444 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 19:22:12.445 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 19:22:12.769 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 19:22:12.785 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 19:22:12.797 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.884 seconds (JVM running for 6.379)
2022-03-02 19:22:18.028 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 19:22:18.028 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 19:22:18.029 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 19:22:18.428 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 19:22:19.638 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 19:22:19.650 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:22:19.683 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:22:19.804 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:22:19.809 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:22:19.809 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:22:19.899 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:22:19.899 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 19:22:19.913 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 19:22:19.914 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:22:19.915 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:22:20.006 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:22:20.007 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:22:20.007 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:22:20.099 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:22:20.100 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:22:20.101 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:22:20.102 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:22:20.194 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 19:22:20.195 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 19:22:20.195 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:22:20.195 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 19:22:20.255 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1582' and type=? limit 0,1 
2022-03-02 19:22:20.255 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:22:20.347 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:22:20.348 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1582,比列:1,数据库:0.9696654000000000,计算:0.96966500
2022-03-02 19:22:20.348 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:23:19.614 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 19:23:19.624 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 19:23:24.558 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 41992 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 19:23:24.560 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 19:23:25.925 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:23:25.927 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:23:25.948 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 19:23:25.954 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:23:25.954 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:23:25.963 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 19:23:25.975 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:23:25.976 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 19:23:25.991 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2022-03-02 19:23:26.673 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 19:23:26.686 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 19:23:26.687 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 19:23:26.687 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 19:23:26.855 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 19:23:26.855 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2208 ms
2022-03-02 19:23:28.046 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 19:23:28.869 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 19:23:28.870 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 19:23:28.870 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 19:23:29.105 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 19:23:29.122 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 19:23:29.134 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.394 seconds (JVM running for 5.953)
2022-03-02 19:23:31.933 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 19:23:31.933 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 19:23:31.934 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 19:23:32.352 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 19:23:33.515 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 19:23:33.526 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:23:33.558 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:23:33.676 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:23:33.681 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:23:33.681 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:23:33.767 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:23:33.768 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 19:23:33.784 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 19:23:33.785 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:23:33.785 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:23:33.874 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:23:33.875 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:23:33.875 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:23:33.964 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:23:33.965 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:23:33.966 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:23:33.967 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:23:34.056 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 19:23:34.058 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 19:23:34.059 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:23:34.059 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 19:23:34.115 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1582' and type=? limit 0,1 
2022-03-02 19:23:34.116 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:23:34.204 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:23:34.204 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1582,比列:1,数据库:0.9696654000000000,计算:0.96966500
2022-03-02 19:23:34.205 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:36:44.357 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 19:36:44.368 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 19:36:51.578 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 42067 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 19:36:51.581 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 19:36:52.792 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:36:52.797 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:36:52.827 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 19:36:52.834 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:36:52.835 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:36:52.844 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 19:36:52.866 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:36:52.869 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 19:36:52.892 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2022-03-02 19:36:53.761 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 19:36:53.787 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 19:36:53.787 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 19:36:53.788 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 19:36:54.004 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 19:36:54.005 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2356 ms
2022-03-02 19:36:55.746 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 19:36:56.678 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 19:36:56.680 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 19:36:56.680 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 19:36:56.988 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 19:36:57.003 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 19:36:57.015 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 6.384 seconds (JVM running for 6.94)
2022-03-02 19:37:08.958 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 19:37:08.959 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 19:37:08.961 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 19:37:09.366 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 19:37:10.510 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 19:37:10.520 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:37:10.552 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:37:10.677 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:37:10.682 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:37:10.683 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:37:10.769 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:37:10.770 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0303346000000000,hold:0E-16
2022-03-02 19:37:10.785 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.9696654000000000,操作后，计算剩余的金额:999.0303346000000000,操作后，数据库存储的总金额:999.0303346000000000
2022-03-02 19:37:10.786 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:37:10.787 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:37:10.875 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:37:10.876 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:37:10.877 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:37:10.964 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:37:10.964 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:37:10.965 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:37:10.966 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:37:11.056 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 19:37:11.056 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null)]
2022-03-02 19:37:11.056 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:37:11.056 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 19:37:11.111 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1582' and type=? limit 0,1 
2022-03-02 19:37:11.112 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:37:11.200 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:37:11.200 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1582,比列:1,数据库:0.9696654000000000,计算:0.96966500
2022-03-02 19:37:11.201 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:38:06.719 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:38:06.720 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:38:06.807 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:38:06.808 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:38:06.809 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:38:06.896 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:38:06.897 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.9653346000000000,hold:0E-16
2022-03-02 19:38:06.898 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.0346654000000000,操作后，计算剩余的金额:999.9653346000000000,操作后，数据库存储的总金额:999.9653346000000000
2022-03-02 19:38:06.898 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:38:06.899 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:38:06.987 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:38:06.987 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:38:06.988 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:38:07.081 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:38:07.082 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:38:07.083 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:38:07.083 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:38:07.172 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 2
2022-03-02 19:38:07.172 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null), UserBillChain(userId=51905053, type=4, size=0.9350000000000000, preBalance=999.0303346000000000, postBalance=999.9653346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1598, note=单号:1598平仓收益0.9350000000000000, createdDate=2022-03-02 19:38:05, fromUserId=0, total=null)]
2022-03-02 19:38:07.173 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:38:07.173 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 19:38:07.173 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1582' and type=? limit 0,1 
2022-03-02 19:38:07.174 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:38:07.262 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:38:07.263 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1582,比列:1,数据库:0.9696654000000000,计算:0.96966500
2022-03-02 19:38:07.264 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:0.9350000000000000
2022-03-02 19:38:07.265 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '1598' 
2022-03-02 19:38:07.266 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-02 19:38:07.355 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-02 19:38:07.356 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1598' and type=? limit 0,1 
2022-03-02 19:38:07.356 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 27(Integer)
2022-03-02 19:38:07.446 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 0
2022-03-02 19:38:07.447 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:38:16.273 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:38:16.273 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:38:16.360 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:38:16.361 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:38:16.363 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:38:16.456 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:38:16.458 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:998.9952952000000000,hold:0E-16
2022-03-02 19:38:16.458 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-1.0047048000000000,操作后，计算剩余的金额:998.9952952000000000,操作后，数据库存储的总金额:998.9952952000000000
2022-03-02 19:38:16.459 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:38:16.460 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:38:16.548 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:38:16.549 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:38:16.549 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:38:16.640 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:38:16.641 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:38:16.642 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:38:16.643 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:38:16.734 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 3
2022-03-02 19:38:16.735 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null), UserBillChain(userId=51905053, type=4, size=0.9350000000000000, preBalance=999.0303346000000000, postBalance=999.9653346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1598, note=单号:1598平仓收益0.9350000000000000, createdDate=2022-03-02 19:38:05, fromUserId=0, total=null), UserBillChain(userId=51905053, type=52, size=-0.9700394000000000, preBalance=999.9653346000000000, postBalance=998.9952952000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1598, note=单号:1598平仓手续费-0.9700394000000000, createdDate=2022-03-02 19:38:13, fromUserId=0, total=null)]
2022-03-02 19:38:16.735 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:38:16.735 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 19:38:16.736 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1582' and type=? limit 0,1 
2022-03-02 19:38:16.737 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:38:16.826 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:38:16.827 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1582,比列:1,数据库:0.9696654000000000,计算:0.96966500
2022-03-02 19:38:16.827 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:0.9350000000000000
2022-03-02 19:38:16.828 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '1598' 
2022-03-02 19:38:16.828 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-02 19:38:16.915 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-02 19:38:16.917 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1598' and type=? limit 0,1 
2022-03-02 19:38:16.918 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 27(Integer)
2022-03-02 19:38:17.006 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 0
2022-03-02 19:38:17.007 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.9700394000000000
2022-03-02 19:38:17.009 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1598' and type=? limit 0,1 
2022-03-02 19:38:17.009 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:38:17.101 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:38:17.102 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:52,订单:1598,比列:1,数据库:0.9700394000000000,计算:0.97003900
2022-03-02 19:38:17.103 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:38:29.579 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:38:29.580 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:38:29.666 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:38:29.667 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:38:29.668 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:38:29.754 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:38:29.755 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:998.9952952000000000,hold:0E-16
2022-03-02 19:38:29.755 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-1.0047048000000000,操作后，计算剩余的金额:998.9952952000000000,操作后，数据库存储的总金额:998.9952952000000000
2022-03-02 19:38:29.756 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:38:29.756 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:38:29.841 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:38:29.842 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:38:29.842 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:38:29.929 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:38:29.929 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=3, defaulted=0, openBet=0, isProfession=0, config=), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:38:29.930 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:38:29.931 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:38:30.042 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 3
2022-03-02 19:38:30.042 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9696654000000000, preBalance=1000.0000000000000000, postBalance=999.0303346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1582, note=单号:1582开仓手续费-0.9696654000000000, createdDate=2022-03-02 18:15:27, fromUserId=0, total=null), UserBillChain(userId=51905053, type=4, size=0.9350000000000000, preBalance=999.0303346000000000, postBalance=999.9653346000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1598, note=单号:1598平仓收益0.9350000000000000, createdDate=2022-03-02 19:38:05, fromUserId=0, total=null), UserBillChain(userId=51905053, type=52, size=-0.9700394000000000, preBalance=999.9653346000000000, postBalance=998.9952952000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1598, note=单号:1598平仓手续费-0.9700394000000000, createdDate=2022-03-02 19:38:13, fromUserId=0, total=null)]
2022-03-02 19:38:30.043 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:38:30.043 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9696654000000000
2022-03-02 19:38:30.044 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1582' and type=? limit 0,1 
2022-03-02 19:38:30.044 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:38:30.133 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:38:30.134 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1582,比列:1,数据库:0.9696654000000000,计算:0.96966500
2022-03-02 19:38:30.134 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:0.9350000000000000
2022-03-02 19:38:30.135 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '1598' 
2022-03-02 19:38:30.135 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-02 19:38:30.221 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-02 19:38:30.221 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1598' and type=? limit 0,1 
2022-03-02 19:38:30.222 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 27(Integer)
2022-03-02 19:38:30.308 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 0
2022-03-02 19:38:30.309 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.9700394000000000
2022-03-02 19:38:30.310 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1598' and type=? limit 0,1 
2022-03-02 19:38:30.310 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 19:38:30.399 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 19:38:30.399 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己无返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:52,订单:1598,比列:1,数据库:0.9700394000000000,计算:0.97003900
2022-03-02 19:38:30.400 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:41:25.454 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:41:25.457 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:41:25.544 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:41:25.578 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,账户:[UserBalanceChain(userId=51905053, currencyId=6, balance=1000.0000000000000000, hold=0E-16)]
2022-03-02 19:42:02.765 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:42:02.765 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:42:02.852 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:42:02.853 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:42:02.854 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:42:02.940 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:42:02.940 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.7884779200000000,hold:0E-16
2022-03-02 19:42:02.941 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.2115220800000000,操作后，计算剩余的金额:999.7884779200000000,操作后，数据库存储的总金额:999.7884779200000000
2022-03-02 19:42:02.942 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:42:02.942 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:42:03.036 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:42:03.036 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:42:03.038 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:42:03.124 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:42:03.125 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:42:03.126 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:42:03.127 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:42:03.223 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 19:42:03.223 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.2115220800000000, preBalance=1000.0000000000000000, postBalance=999.7884779200000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1599, note=单号:1599开仓手续费-0.2115220800000000, createdDate=2022-03-02 19:41:43, fromUserId=0, total=null)]
2022-03-02 19:42:03.224 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:42:03.224 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.2115220800000000
2022-03-02 19:42:03.226 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1599' 
2022-03-02 19:42:03.226 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 19:42:03.316 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 0
2022-03-02 19:42:03.317 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:42:34.903 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:42:34.903 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:42:34.989 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:42:34.990 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:42:34.990 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:42:35.086 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:42:35.086 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.7884779200000000,hold:0E-16
2022-03-02 19:42:35.087 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.2115220800000000,操作后，计算剩余的金额:999.7884779200000000,操作后，数据库存储的总金额:999.7884779200000000
2022-03-02 19:42:35.087 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:42:35.088 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:42:35.180 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:42:35.181 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:42:35.181 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:42:35.267 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:42:35.268 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:42:35.269 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:42:35.269 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:42:35.357 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 19:42:35.358 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.2115220800000000, preBalance=1000.0000000000000000, postBalance=999.7884779200000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1599, note=单号:1599开仓手续费-0.2115220800000000, createdDate=2022-03-02 19:41:43, fromUserId=0, total=null)]
2022-03-02 19:42:35.358 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:42:35.359 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.2115220800000000
2022-03-02 19:42:35.360 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1599' 
2022-03-02 19:42:35.360 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 19:42:35.462 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 0
2022-03-02 19:42:35.463 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:43:37.445 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:43:37.446 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:43:37.549 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:43:37.550 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:43:37.550 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:43:37.652 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:43:37.653 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.7884779200000000,hold:0E-16
2022-03-02 19:43:37.653 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.2115220800000000,操作后，计算剩余的金额:999.7884779200000000,操作后，数据库存储的总金额:999.7884779200000000
2022-03-02 19:43:37.653 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:43:37.654 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:43:37.741 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:43:37.742 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:43:37.742 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:43:37.840 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:43:37.841 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:43:37.842 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:43:37.843 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:43:37.932 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 1
2022-03-02 19:43:37.932 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.2115220800000000, preBalance=1000.0000000000000000, postBalance=999.7884779200000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1599, note=单号:1599开仓手续费-0.2115220800000000, createdDate=2022-03-02 19:41:43, fromUserId=0, total=null)]
2022-03-02 19:43:37.932 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:43:37.932 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.2115220800000000
2022-03-02 19:43:37.933 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1599' 
2022-03-02 19:43:37.933 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 19:43:38.031 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 0
2022-03-02 19:43:38.032 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:50:00.672 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 19:50:00.685 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 19:50:06.408 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 42116 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 19:50:06.410 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 19:50:07.450 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:50:07.453 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:50:07.480 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 19:50:07.487 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:50:07.488 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 19:50:07.497 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 19:50:07.513 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 19:50:07.514 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 19:50:07.544 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
2022-03-02 19:50:08.394 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 19:50:08.407 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 19:50:08.407 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 19:50:08.407 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 19:50:08.542 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 19:50:08.542 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2078 ms
2022-03-02 19:50:10.243 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 19:50:11.432 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 19:50:11.435 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 19:50:11.435 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 19:50:11.833 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 19:50:11.849 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 19:50:11.862 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 6.26 seconds (JVM running for 6.913)
2022-03-02 19:50:26.649 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 19:50:26.649 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 19:50:26.651 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2022-03-02 19:50:27.040 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 19:50:28.290 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 19:50:28.302 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 19:50:28.334 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 19:50:28.466 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 19:50:28.472 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:50:28.472 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 19:50:28.566 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 19:50:28.566 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:994.1740532400000000,hold:0E-16
2022-03-02 19:50:28.585 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-5.8259467600000000,操作后，计算剩余的金额:994.1740532400000000,操作后，数据库存储的总金额:994.1740532400000000
2022-03-02 19:50:28.586 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 19:50:28.586 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:50:28.684 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:50:28.685 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 19:50:28.686 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 19:50:29.075 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 19:50:29.076 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 19:50:29.076 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 19:50:29.077 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 19:50:29.178 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 3
2022-03-02 19:50:29.178 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-3.9359767600000000, preBalance=1000.0000000000000000, postBalance=996.0640232400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1600, note=单号:1600开仓手续费-3.9359767600000000, createdDate=2022-03-02 19:44:33, fromUserId=0, total=null), UserBillChain(userId=51905053, type=51, size=-0.9185072000000000, preBalance=996.0640232400000000, postBalance=995.1455160400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1601, note=单号:1601开仓手续费-0.9185072000000000, createdDate=2022-03-02 19:46:03, fromUserId=0, total=null), UserBillChain(userId=51905053, type=51, size=-0.9714628000000000, preBalance=995.1455160400000000, postBalance=994.1740532400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1602, note=单号:1602开仓手续费-0.9714628000000000, createdDate=2022-03-02 19:49:34, fromUserId=0, total=null)]
2022-03-02 19:50:29.179 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 19:50:29.179 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-3.9359767600000000
2022-03-02 19:50:29.237 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1600' 
2022-03-02 19:50:29.238 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 19:50:29.331 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 0
2022-03-02 19:50:29.333 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9185072000000000
2022-03-02 19:50:29.334 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1601' 
2022-03-02 19:50:29.334 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 19:50:29.432 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 0
2022-03-02 19:50:29.432 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9714628000000000
2022-03-02 19:50:29.433 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1602' 
2022-03-02 19:50:29.434 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 19:50:29.531 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 0
2022-03-02 19:50:29.531 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 20:02:21.890 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 20:02:21.892 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 20:02:21.987 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 20:02:21.988 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 20:02:21.988 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 20:02:22.082 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 20:02:22.083 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0298836000000000,hold:0E-16
2022-03-02 20:02:22.084 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.8731054000000000,操作后，计算剩余的金额:999.1268946000000000,操作后，数据库存储的总金额:999.0298836000000000
2022-03-02 20:02:22.085 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 20:02:22.085 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 20:02:22.178 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 20:02:22.179 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 20:02:22.179 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 20:02:22.273 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 20:02:22.273 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 20:02:22.274 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 20:02:22.275 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 20:02:22.370 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 2
2022-03-02 20:02:22.370 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9701164000000000, preBalance=1000.0000000000000000, postBalance=999.0298836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1604, note=单号:1604开仓手续费-0.9701164000000000, createdDate=2022-03-02 20:01:53, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0970110000000000, preBalance=0E-16, postBalance=0.0970116400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1604, note=手续费返佣：0.09701164,单号来源:1604,用户来源: 51905053, createdDate=2022-03-02 20:01:54, fromUserId=51905053, total=null)]
2022-03-02 20:02:22.371 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 20:02:22.371 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9701164000000000
2022-03-02 20:02:22.372 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1604' 
2022-03-02 20:02:22.372 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 20:02:22.469 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 20:02:22.471 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1604' and type=? limit 0,1 
2022-03-02 20:02:22.472 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 20:02:22.567 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 20:02:22.568 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1604,比列:0.900000,数据库:0.87310476,计算:0.87310400
2022-03-02 20:02:22.569 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0970110000000000
2022-03-02 20:02:22.569 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 20:07:02.244 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 20:07:02.256 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 21:12:11.916 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 42659 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 21:12:11.919 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 21:12:12.957 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 21:12:12.960 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 21:12:12.983 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 21:12:12.989 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 21:12:12.989 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 21:12:12.997 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 21:12:13.011 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 21:12:13.013 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 21:12:13.034 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2022-03-02 21:12:13.851 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 21:12:13.869 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 21:12:13.869 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 21:12:13.869 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 21:12:14.026 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 21:12:14.026 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2050 ms
2022-03-02 21:12:15.739 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 21:12:16.899 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 21:12:16.901 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 21:12:16.901 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 21:12:17.180 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 21:12:17.198 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 21:12:17.209 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 6.166 seconds (JVM running for 6.713)
2022-03-02 21:12:20.336 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 21:12:20.336 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 21:12:20.337 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 21:12:20.777 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 21:12:21.997 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 21:12:22.011 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 21:12:22.066 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 21:12:22.179 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 21:12:22.184 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:12:22.184 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 21:12:22.267 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 21:12:22.268 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:999.0298836000000000,hold:0E-16
2022-03-02 21:12:22.286 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-0.8731054000000000,操作后，计算剩余的金额:999.1268946000000000,操作后，数据库存储的总金额:999.0298836000000000
2022-03-02 21:12:22.296 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:12:22.297 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:12:22.381 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:12:22.382 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 21:12:22.382 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:12:22.470 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:12:22.470 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 21:12:22.471 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 21:12:22.472 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 21:12:22.556 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 2
2022-03-02 21:12:22.556 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9701164000000000, preBalance=1000.0000000000000000, postBalance=999.0298836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1604, note=单号:1604开仓手续费-0.9701164000000000, createdDate=2022-03-02 20:01:53, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0970110000000000, preBalance=0E-16, postBalance=0.0970116400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1604, note=手续费返佣：0.09701164,单号来源:1604,用户来源: 51905053, createdDate=2022-03-02 20:01:54, fromUserId=51905053, total=null)]
2022-03-02 21:12:22.557 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:12:22.557 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9701164000000000
2022-03-02 21:12:22.612 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1604' 
2022-03-02 21:12:22.612 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:12:22.695 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:12:22.698 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1604' and type=? limit 0,1 
2022-03-02 21:12:22.698 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:12:22.785 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:12:22.786 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1604,比列:0.900000,数据库:0.87310476,计算:0.87310400
2022-03-02 21:12:22.787 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0970110000000000
2022-03-02 21:12:22.787 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:14:58.211 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 21:14:58.212 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 21:14:58.292 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 21:14:58.293 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:14:58.293 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 21:14:58.376 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 21:14:58.376 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:984.0953552000000000,hold:0E-16
2022-03-02 21:14:58.377 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-15.7111809600000000,操作后，计算剩余的金额:984.2888190400000000,操作后，数据库存储的总金额:984.0953552000000000
2022-03-02 21:14:58.378 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:14:58.378 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:14:58.460 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:14:58.461 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 21:14:58.461 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:14:58.542 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:14:58.542 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 21:14:58.543 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 21:14:58.544 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 21:14:58.632 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 5
2022-03-02 21:14:58.633 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9701164000000000, preBalance=1000.0000000000000000, postBalance=999.0298836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1604, note=单号:1604开仓手续费-0.9701164000000000, createdDate=2022-03-02 20:01:53, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0970110000000000, preBalance=0E-16, postBalance=0.0970116400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1604, note=手续费返佣：0.09701164,单号来源:1604,用户来源: 51905053, createdDate=2022-03-02 20:01:54, fromUserId=51905053, total=null), UserBillChain(userId=51905053, type=4, size=-13.9700000000000000, preBalance=999.0298836000000000, postBalance=985.0598836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓收益-13.9700000000000000, createdDate=2022-03-02 21:14:49, fromUserId=0, total=null), UserBillChain(userId=51905053, type=52, size=-0.9645284000000000, preBalance=985.0598836000000000, postBalance=984.0953552000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓手续费-0.9645284000000000, createdDate=2022-03-02 21:14:52, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0964528400000000, preBalance=0.0970116400000000, postBalance=0.1934644800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1609, note=手续费返佣：0.09645284,单号来源:1609,用户来源: 51905053, createdDate=2022-03-02 21:14:53, fromUserId=51905053, total=null)]
2022-03-02 21:14:58.634 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:14:58.634 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9701164000000000
2022-03-02 21:14:58.635 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1604' 
2022-03-02 21:14:58.636 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:14:58.724 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:14:58.725 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1604' and type=? limit 0,1 
2022-03-02 21:14:58.725 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:14:58.810 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:14:58.811 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1604,比列:0.900000,数据库:0.87310476,计算:0.87310400
2022-03-02 21:14:58.811 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0970110000000000
2022-03-02 21:14:58.811 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-13.9700000000000000
2022-03-02 21:14:58.813 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '1609' 
2022-03-02 21:14:58.813 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-02 21:14:58.895 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-02 21:14:58.896 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:14:58.898 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 27(Integer)
2022-03-02 21:14:58.989 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 0
2022-03-02 21:14:58.991 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.9645284000000000
2022-03-02 21:14:58.992 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1609' 
2022-03-02 21:14:58.993 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:14:59.081 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:14:59.082 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:14:59.083 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:14:59.174 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:14:59.174 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:52,订单:1609,比列:0.900000,数据库:0.86807556,计算:0.86807556
2022-03-02 21:14:59.175 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0964528400000000
2022-03-02 21:14:59.175 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:15:10.294 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 21:15:10.295 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 21:15:10.375 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 21:15:10.376 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:15:10.376 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 21:15:10.462 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 21:15:10.463 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:984.0953552000000000,hold:0E-16
2022-03-02 21:15:10.464 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-15.7111809600000000,操作后，计算剩余的金额:984.2888190400000000,操作后，数据库存储的总金额:984.0953552000000000
2022-03-02 21:15:10.466 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:15:10.466 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:15:10.559 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:15:10.559 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 21:15:10.560 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:15:10.641 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:15:10.641 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 21:15:10.642 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 21:15:10.642 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 21:15:10.733 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 5
2022-03-02 21:15:10.733 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9701164000000000, preBalance=1000.0000000000000000, postBalance=999.0298836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1604, note=单号:1604开仓手续费-0.9701164000000000, createdDate=2022-03-02 20:01:53, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0970110000000000, preBalance=0E-16, postBalance=0.0970116400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1604, note=手续费返佣：0.09701164,单号来源:1604,用户来源: 51905053, createdDate=2022-03-02 20:01:54, fromUserId=51905053, total=null), UserBillChain(userId=51905053, type=4, size=-13.9700000000000000, preBalance=999.0298836000000000, postBalance=985.0598836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓收益-13.9700000000000000, createdDate=2022-03-02 21:14:49, fromUserId=0, total=null), UserBillChain(userId=51905053, type=52, size=-0.9645284000000000, preBalance=985.0598836000000000, postBalance=984.0953552000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓手续费-0.9645284000000000, createdDate=2022-03-02 21:14:52, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0964528400000000, preBalance=0.0970116400000000, postBalance=0.1934644800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1609, note=手续费返佣：0.09645284,单号来源:1609,用户来源: 51905053, createdDate=2022-03-02 21:14:53, fromUserId=51905053, total=null)]
2022-03-02 21:15:10.733 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:15:10.733 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9701164000000000
2022-03-02 21:15:10.734 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1604' 
2022-03-02 21:15:10.734 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:15:10.817 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:15:10.817 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1604' and type=? limit 0,1 
2022-03-02 21:15:10.818 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:15:10.905 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:15:10.905 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1604,比列:0.900000,数据库:0.87310476,计算:0.87310400
2022-03-02 21:15:10.906 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0970110000000000
2022-03-02 21:15:10.906 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-13.9700000000000000
2022-03-02 21:15:10.906 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '1609' 
2022-03-02 21:15:10.907 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-02 21:15:10.988 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-02 21:15:10.989 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:15:10.990 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 27(Integer)
2022-03-02 21:15:11.073 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 0
2022-03-02 21:15:11.073 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.9645284000000000
2022-03-02 21:15:11.075 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1609' 
2022-03-02 21:15:11.075 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:15:11.169 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:15:11.170 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:15:11.171 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:15:11.268 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:15:11.268 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:52,订单:1609,比列:0.900000,数据库:0.86807556,计算:0.86807556
2022-03-02 21:15:11.269 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0964528400000000
2022-03-02 21:15:11.269 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:15:43.671 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 21:15:43.672 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 21:15:43.756 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 21:15:43.757 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:15:43.758 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 21:15:43.838 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 21:15:43.839 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:984.0953552000000000,hold:0E-16
2022-03-02 21:15:43.839 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-15.7111809600000000,操作后，计算剩余的金额:984.2888190400000000,操作后，数据库存储的总金额:984.0953552000000000
2022-03-02 21:15:43.840 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:15:43.841 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:15:43.922 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:15:43.922 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 21:15:43.923 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:15:44.005 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:15:44.006 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 21:15:44.007 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 21:15:44.008 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 21:15:44.100 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 5
2022-03-02 21:15:44.100 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9701164000000000, preBalance=1000.0000000000000000, postBalance=999.0298836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1604, note=单号:1604开仓手续费-0.9701164000000000, createdDate=2022-03-02 20:01:53, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0970110000000000, preBalance=0E-16, postBalance=0.0970116400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1604, note=手续费返佣：0.09701164,单号来源:1604,用户来源: 51905053, createdDate=2022-03-02 20:01:54, fromUserId=51905053, total=null), UserBillChain(userId=51905053, type=4, size=-13.9700000000000000, preBalance=999.0298836000000000, postBalance=985.0598836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓收益-13.9700000000000000, createdDate=2022-03-02 21:14:49, fromUserId=0, total=null), UserBillChain(userId=51905053, type=52, size=-0.9645284000000000, preBalance=985.0598836000000000, postBalance=984.0953552000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓手续费-0.9645284000000000, createdDate=2022-03-02 21:14:52, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0964528400000000, preBalance=0.0970116400000000, postBalance=0.1934644800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1609, note=手续费返佣：0.09645284,单号来源:1609,用户来源: 51905053, createdDate=2022-03-02 21:14:53, fromUserId=51905053, total=null)]
2022-03-02 21:15:44.101 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:15:44.101 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9701164000000000
2022-03-02 21:15:44.102 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1604' 
2022-03-02 21:15:44.102 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:15:44.188 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:15:44.188 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1604' and type=? limit 0,1 
2022-03-02 21:15:44.189 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:15:44.269 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:15:44.269 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1604,比列:0.900000,数据库:0.87310476,计算:0.87310400
2022-03-02 21:15:44.270 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0970110000000000
2022-03-02 21:15:44.270 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-13.9700000000000000
2022-03-02 21:15:44.270 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '1609' 
2022-03-02 21:15:44.270 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-02 21:15:44.361 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-02 21:15:44.362 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:15:44.363 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 27(Integer)
2022-03-02 21:15:44.451 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 0
2022-03-02 21:15:44.452 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.9645284000000000
2022-03-02 21:15:44.453 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1609' 
2022-03-02 21:15:44.453 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:15:44.537 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:15:44.538 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:15:44.539 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:15:44.628 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:15:44.628 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:52,订单:1609,比列:0.900000,数据库:0.86807556,计算:0.86807556
2022-03-02 21:15:44.629 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0964528400000000
2022-03-02 21:15:44.629 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:16:52.215 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 21:16:52.217 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 21:16:52.310 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 21:16:52.312 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:16:52.312 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 21:16:52.393 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 21:16:52.394 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:984.0953552000000000,hold:0E-16
2022-03-02 21:16:52.394 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-15.7111809600000000,操作后，计算剩余的金额:984.2888190400000000,操作后，数据库存储的总金额:984.0953552000000000
2022-03-02 21:16:52.394 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:16:52.394 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:16:52.473 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:16:52.473 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 21:16:52.473 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:16:52.554 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:16:52.554 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 21:16:52.555 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 21:16:52.555 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 21:16:52.640 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 5
2022-03-02 21:16:52.641 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9701164000000000, preBalance=1000.0000000000000000, postBalance=999.0298836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1604, note=单号:1604开仓手续费-0.9701164000000000, createdDate=2022-03-02 20:01:53, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0970110000000000, preBalance=0E-16, postBalance=0.0970116400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1604, note=手续费返佣：0.09701164,单号来源:1604,用户来源: 51905053, createdDate=2022-03-02 20:01:54, fromUserId=51905053, total=null), UserBillChain(userId=51905053, type=4, size=-13.9700000000000000, preBalance=999.0298836000000000, postBalance=985.0598836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓收益-13.9700000000000000, createdDate=2022-03-02 21:14:49, fromUserId=0, total=null), UserBillChain(userId=51905053, type=52, size=-0.9645284000000000, preBalance=985.0598836000000000, postBalance=984.0953552000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓手续费-0.9645284000000000, createdDate=2022-03-02 21:14:52, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0964528400000000, preBalance=0.0970116400000000, postBalance=0.1934644800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1609, note=手续费返佣：0.09645284,单号来源:1609,用户来源: 51905053, createdDate=2022-03-02 21:14:53, fromUserId=51905053, total=null)]
2022-03-02 21:16:52.641 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:16:52.641 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9701164000000000
2022-03-02 21:16:52.642 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1604' 
2022-03-02 21:16:52.643 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:16:52.725 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:16:52.725 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1604' and type=? limit 0,1 
2022-03-02 21:16:52.726 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:16:52.810 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:16:52.811 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1604,比列:0.900000,数据库:0.87310476,计算:0.87310400
2022-03-02 21:16:52.812 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0970110000000000
2022-03-02 21:16:52.812 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-13.9700000000000000
2022-03-02 21:16:52.813 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '1609' 
2022-03-02 21:16:52.813 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-02 21:16:52.905 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-02 21:16:52.905 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:16:52.906 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 27(Integer)
2022-03-02 21:16:52.988 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 0
2022-03-02 21:16:52.990 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.9645284000000000
2022-03-02 21:16:52.991 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1609' 
2022-03-02 21:16:52.991 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:16:53.073 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:16:53.074 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and from_user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:16:53.075 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 51905053(String), 16(Integer)
2022-03-02 21:16:53.155 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:16:53.156 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:52,订单:1609,比列:0.900000,数据库:0.86807556,计算:0.86807556
2022-03-02 21:16:53.156 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0964528400000000
2022-03-02 21:16:53.156 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:20:06.578 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 21:20:06.590 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-02 21:20:12.561 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 42690 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-02 21:20:12.563 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-02 21:20:13.501 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 21:20:13.503 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-02 21:20:13.522 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 0 Elasticsearch repository interfaces.
2022-03-02 21:20:13.527 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 21:20:13.527 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-02 21:20:13.534 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-02 21:20:13.545 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-02 21:20:13.546 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-02 21:20:13.567 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2022-03-02 21:20:14.264 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-02 21:20:14.282 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-02 21:20:14.283 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-02 21:20:14.284 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-02 21:20:14.428 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-02 21:20:14.428 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1817 ms
2022-03-02 21:20:15.823 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-02 21:20:16.645 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-02 21:20:16.646 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-02 21:20:16.646 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-02 21:20:16.902 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-02 21:20:16.917 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-02 21:20:16.929 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.191 seconds (JVM running for 5.686)
2022-03-02 21:20:23.847 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-02 21:20:23.848 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-02 21:20:23.849 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-02 21:20:24.247 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-02 21:20:26.874 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-02 21:20:26.884 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? 
2022-03-02 21:20:26.914 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905053(String)
2022-03-02 21:20:27.036 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-02 21:20:27.042 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:20:27.042 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-02 21:20:27.124 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 1
2022-03-02 21:20:27.124 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:984.0953552000000000,hold:0E-16
2022-03-02 21:20:27.137 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-15.7111809600000000,操作后，计算剩余的金额:984.2888190400000000,操作后，数据库存储的总金额:984.0953552000000000
2022-03-02 21:20:27.138 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905053' LIMIT 0,1 
2022-03-02 21:20:27.138 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:20:27.225 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:20:27.225 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-02 21:20:27.226 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-02 21:20:27.333 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-02 21:20:27.342 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905053,合伙人:[UserDistributorChain(userId=51905053, parentId=51904446, gparentId=0, partnerId=51904446, distId=0, level=1, type=0, defaulted=0, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}), UserDistributorChain(userId=51904446, parentId=0, gparentId=0, partnerId=0, distId=0, level=0, type=0, defaulted=1, openBet=0, isProfession=0, config={"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000})]
2022-03-02 21:20:27.346 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905053' and created_date>='' 
2022-03-02 21:20:27.347 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-02 21:20:27.441 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 5
2022-03-02 21:20:27.441 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905053,流水:[UserBillChain(userId=51905053, type=51, size=-0.9701164000000000, preBalance=1000.0000000000000000, postBalance=999.0298836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1604, note=单号:1604开仓手续费-0.9701164000000000, createdDate=2022-03-02 20:01:53, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0970110000000000, preBalance=0E-16, postBalance=0.0970116400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1604, note=手续费返佣：0.09701164,单号来源:1604,用户来源: 51905053, createdDate=2022-03-02 20:01:54, fromUserId=51905053, total=null), UserBillChain(userId=51905053, type=4, size=-13.9700000000000000, preBalance=999.0298836000000000, postBalance=985.0598836000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓收益-13.9700000000000000, createdDate=2022-03-02 21:14:49, fromUserId=0, total=null), UserBillChain(userId=51905053, type=52, size=-0.9645284000000000, preBalance=985.0598836000000000, postBalance=984.0953552000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=1609, note=单号:1609平仓手续费-0.9645284000000000, createdDate=2022-03-02 21:14:52, fromUserId=0, total=null), UserBillChain(userId=51905053, type=16, size=0.0964528400000000, preBalance=0.0970116400000000, postBalance=0.1934644800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=null, parentId=null, sourceId=1609, note=手续费返佣：0.09645284,单号来源:1609,用户来源: 51905053, createdDate=2022-03-02 21:14:53, fromUserId=51905053, total=null)]
2022-03-02 21:20:27.442 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:20:27.442 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.9701164000000000
2022-03-02 21:20:27.496 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1604' 
2022-03-02 21:20:27.496 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:20:27.783 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:20:27.785 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='1604' and type=? limit 0,1 
2022-03-02 21:20:27.786 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-02 21:20:27.873 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:20:27.874 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:51,订单:1604,比列:0.900000,数据库:0.87310476,计算:0.87310400
2022-03-02 21:20:27.875 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0970110000000000
2022-03-02 21:20:27.875 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-13.9700000000000000
2022-03-02 21:20:27.876 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '1609' 
2022-03-02 21:20:27.876 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-02 21:20:27.959 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-02 21:20:27.960 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:20:27.961 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-02 21:20:28.046 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:20:28.046 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - defaultPartnerFeeAndProfit--只有默认合伙人--盈亏校验--->用户:51905053,默认合伙人:51904446,交易类型:4,订单:1609,数据库:-13.97000000,计算得:13.97000000
2022-03-02 21:20:28.046 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.9645284000000000
2022-03-02 21:20:28.048 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `type` = '16' AND `user_id` = '51905053' AND `source_id` = '1609' 
2022-03-02 21:20:28.048 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - ==> Parameters: 
2022-03-02 21:20:28.128 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getFeeToUser - <==      Total: 1
2022-03-02 21:20:28.129 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='1609' and type=? limit 0,1 
2022-03-02 21:20:28.130 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-02 21:20:28.215 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-02 21:20:28.215 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeAndProfitCalc - feeToPartnerClac--只有默认合伙人--用户不返回手续费--用户自己有返佣--给默认合伙人返佣--手续费校验-->用户:51905053,合伙人:51904446,交易类型:52,订单:1609,比列:0.900000,数据库:0.86807556,计算:0.86807556
2022-03-02 21:20:28.216 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 合伙人手续费  (合伙人收取下面邀请人的交易手续费) 区分普通和默认:0.0964528400000000
2022-03-02 21:20:28.216 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905053流水--------
2022-03-02 21:22:43.607 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-02 21:22:43.620 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
