2022-03-11 13:27:08.311 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 85576 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-11 13:27:08.314 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-11 13:27:09.542 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-11 13:27:09.545 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-11 13:27:09.571 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 21 ms. Found 0 Elasticsearch repository interfaces.
2022-03-11 13:27:09.578 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-11 13:27:09.579 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-11 13:27:09.587 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-11 13:27:09.604 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-11 13:27:09.606 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-11 13:27:09.631 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2022-03-11 13:27:10.509 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-11 13:27:10.527 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-11 13:27:10.527 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-11 13:27:10.527 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-11 13:27:10.695 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-11 13:27:10.695 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2327 ms
2022-03-11 13:27:12.184 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-11 13:27:13.156 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-11 13:27:13.158 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-11 13:27:13.158 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-11 13:27:13.435 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-11 13:27:13.452 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-11 13:27:13.464 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 6.017 seconds (JVM running for 6.625)
2022-03-11 13:27:18.883 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-11 13:27:18.884 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-11 13:27:18.885 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-11 13:27:19.041 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-11 13:27:20.478 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-11 13:27:20.494 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:27:20.529 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:27:20.668 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:27:20.674 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:27:20.674 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:27:20.771 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:27:20.978 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,账户user_balance:[UserBalanceChain(userId=51905047, currencyId=6, balance=100.0000000000000000, hold=0E-16)],user_partner_balance:[UserBalanceChain(userId=51905047, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 13:27:33.448 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 13:27:33.449 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 13:27:33.545 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 13:27:33.545 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:27:33.545 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:27:33.642 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:27:33.643 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:100.0000000000000000,hold:0E-16
2022-03-11 13:27:33.657 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:0,操作后，计算剩余的金额:100.0,操作后，数据库存储的总金额:100.0000000000000000
2022-03-11 13:27:33.659 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:27:33.659 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:33.758 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:33.759 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:27:33.759 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:33.855 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:33.856 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:27:33.856 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:33.952 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:33.953 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:27:33.954 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:34.051 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:34.051 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 13:27:34.052 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:34.147 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:34.148 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 13:27:34.148 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 13:27:34.148 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 13:27:34.250 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 0
2022-03-11 13:27:34.251 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[]
2022-03-11 13:27:42.970 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 13:27:42.971 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 13:27:43.070 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 13:27:43.071 [http-nio-10090-exec-5] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:27:43.072 [http-nio-10090-exec-5] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:27:43.168 [http-nio-10090-exec-5] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:27:43.169 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:73.6204703600000000,hold:1.0185146400000000
2022-03-11 13:27:43.170 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-25.3610150000000000,操作后，计算剩余的金额:74.6389850000000000,操作后，数据库存储的总金额:74.6389850000000000
2022-03-11 13:27:43.171 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:27:43.171 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:43.273 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:43.274 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:27:43.274 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:43.370 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:43.371 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:27:43.372 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:43.469 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:43.470 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:27:43.472 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:43.568 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:43.570 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 13:27:43.570 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:27:43.666 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:27:43.666 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 13:27:43.667 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 13:27:43.667 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 13:27:43.771 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 2
2022-03-11 13:27:43.771 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-25.4628660000000000, preBalance=100.0000000000000000, postBalance=74.5371340000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓保证金-25.4628660000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1018510000000000, preBalance=74.5371340000000000, postBalance=74.6389850000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027返还手续费0.1018510000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null)]
2022-03-11 13:27:43.772 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:27:43.772 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-25.4628660000000000
2022-03-11 13:27:43.772 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1018510000000000
2022-03-11 13:27:43.772 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:28:16.149 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 13:28:16.151 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 13:28:16.247 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 13:28:16.248 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:28:16.249 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:28:16.345 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:28:16.347 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:73.6204703600000000,hold:0E-16
2022-03-11 13:28:16.347 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-26.3795296400000000,操作后，计算剩余的金额:73.6204703600000000,操作后，数据库存储的总金额:73.6204703600000000
2022-03-11 13:28:16.348 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:28:16.348 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:28:16.447 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:28:16.448 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:28:16.449 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:28:16.545 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:28:16.547 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:28:16.548 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:28:16.645 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:28:16.646 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:28:16.647 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:28:16.745 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:28:16.746 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 13:28:16.746 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:28:16.844 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:28:16.844 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 13:28:16.845 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 13:28:16.846 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 13:28:16.950 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 3
2022-03-11 13:28:16.951 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-25.4628660000000000, preBalance=100.0000000000000000, postBalance=74.5371340000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓保证金-25.4628660000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1018510000000000, preBalance=74.5371340000000000, postBalance=74.6389850000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027返还手续费0.1018510000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0185146400000000, preBalance=74.6389850000000000, postBalance=73.6204703600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓手续费-1.0185146400000000, createdDate=2022-03-11 13:27:50, fromUserId=0, total=null)]
2022-03-11 13:28:16.951 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:28:16.951 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-25.4628660000000000
2022-03-11 13:28:16.951 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1018510000000000
2022-03-11 13:28:16.952 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0185146400000000
2022-03-11 13:28:16.961 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5027' LIMIT 0,1000 
2022-03-11 13:28:16.961 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:28:17.061 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:28:17.062 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:28:17.063 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:28:17.164 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:28:17.250 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:28:17.251 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:28:17.351 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:28:17.352 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5027,数据库:0.101851,计算:0.101851
2022-03-11 13:28:17.352 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:28:17.353 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:28:17.455 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:28:17.456 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:28:17.456 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:28:17.565 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:28:17.566 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:28:17.566 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:28:17.671 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:28:17.672 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:28:17.673 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:28:17.768 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:28:17.770 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:28:17.770 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:28:17.867 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:28:17.868 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5027,比列:0.300000,数据库:0.27499909,计算:0.274998
2022-03-11 13:28:17.869 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:28:17.870 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:28:17.972 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:28:17.973 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5027,比列:0.200000,数据库:0.18333272,计算:0.183332
2022-03-11 13:28:17.975 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:28:17.975 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:28:18.073 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:28:18.074 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5027,比列:0.400000,数据库:0.36666545,计算:0.366665
2022-03-11 13:28:18.075 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:28:18.076 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:28:18.172 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:28:18.172 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5027,比列:0.100000,数据库:0.09166636,计算:0.091666
2022-03-11 13:28:18.174 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:34:34.318 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 13:34:34.320 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 13:34:34.415 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 13:34:34.416 [http-nio-10090-exec-10] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:34:34.416 [http-nio-10090-exec-10] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:34.522 [http-nio-10090-exec-10] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:34.523 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:77.2706165600000000,hold:0E-16
2022-03-11 13:34:34.524 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-22.7293834400000000,操作后，计算剩余的金额:77.2706165600000000,操作后，数据库存储的总金额:77.2706165600000000
2022-03-11 13:34:34.524 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:34:34.525 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:34:34.626 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:34:34.627 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:34:34.627 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:34:34.724 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:34:34.725 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:34:34.726 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:34:34.820 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:34:34.821 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:34:34.822 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:34:34.918 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:34:34.918 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 13:34:34.918 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:34:35.020 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:34:35.020 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 13:34:35.021 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 13:34:35.021 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 13:34:35.124 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 6
2022-03-11 13:34:35.124 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-25.4628660000000000, preBalance=100.0000000000000000, postBalance=74.5371340000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓保证金-25.4628660000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1018510000000000, preBalance=74.5371340000000000, postBalance=74.6389850000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027返还手续费0.1018510000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0185146400000000, preBalance=74.6389850000000000, postBalance=73.6204703600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓手续费-1.0185146400000000, createdDate=2022-03-11 13:27:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=3.7890100000000000, preBalance=73.6204703600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028平仓收益3.6501462000000000, createdDate=2022-03-11 13:33:14, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0154290000000000, preBalance=77.2706165600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028返还手续费0.0154290000000000, createdDate=2022-03-11 13:33:14, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.1542928000000000, preBalance=77.2706165600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028平仓手续费-0.1542928000000000, createdDate=2022-03-11 13:33:20, fromUserId=0, total=null)]
2022-03-11 13:34:35.125 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:34:35.125 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-25.4628660000000000
2022-03-11 13:34:35.125 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1018510000000000
2022-03-11 13:34:35.125 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0185146400000000
2022-03-11 13:34:35.126 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5027' LIMIT 0,1000 
2022-03-11 13:34:35.126 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:34:35.226 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:34:35.227 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:34:35.227 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:34:35.322 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:34:35.323 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:34:35.323 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:34:35.421 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:35.421 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5027,数据库:0.101851,计算:0.101851
2022-03-11 13:34:35.422 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:34:35.423 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:35.519 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:35.519 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:34:35.520 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:35.618 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:35.618 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:34:35.618 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:35.714 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:35.714 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:34:35.714 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:35.810 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:35.810 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:34:35.811 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:34:36.046 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:36.047 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5027,比列:0.300000,数据库:0.27499909,计算:0.274998
2022-03-11 13:34:36.048 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:34:36.049 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:34:36.148 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:36.148 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5027,比列:0.200000,数据库:0.18333272,计算:0.183332
2022-03-11 13:34:36.149 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:34:36.150 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:34:36.327 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:36.328 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5027,比列:0.400000,数据库:0.36666545,计算:0.366665
2022-03-11 13:34:36.329 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:34:36.330 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:34:36.431 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:36.431 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5027,比列:0.100000,数据库:0.09166636,计算:0.091666
2022-03-11 13:34:36.431 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:3.7890100000000000
2022-03-11 13:34:36.432 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5028' LIMIT 0,1000 
2022-03-11 13:34:36.432 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:34:36.598 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:34:36.599 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:34:36.600 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:34:36.694 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:34:36.695 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5028' 
2022-03-11 13:34:36.695 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:34:36.830 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:34:36.831 [http-nio-10090-exec-10] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5028' AND `margin_type` = 'FIXED' 
2022-03-11 13:34:36.831 [http-nio-10090-exec-10] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:34:37.008 [http-nio-10090-exec-10] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:34:37.008 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:34:37.009 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:34:37.190 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:37.190 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5028,数据库:0.06210000,计算得:-0.069000
2022-03-11 13:34:37.191 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0154290000000000
2022-03-11 13:34:37.191 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.1542928000000000
2022-03-11 13:34:37.191 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5028' LIMIT 0,1000 
2022-03-11 13:34:37.191 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:34:37.344 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:34:37.344 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:34:37.345 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:34:37.525 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:34:37.526 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:34:37.526 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:34:37.623 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:37.624 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5028,数据库:0.015429,计算:0.015429
2022-03-11 13:34:37.624 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:34:37.624 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:37.720 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:37.721 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:34:37.721 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:37.818 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:37.819 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:34:37.819 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:37.924 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:37.924 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:34:37.925 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:34:38.021 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:34:38.023 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:34:38.023 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:34:38.118 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:38.119 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5028,比列:0.300000,数据库:0.04165914,计算:0.041659
2022-03-11 13:34:38.120 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:34:38.120 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:34:38.216 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:38.216 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5028,比列:0.200000,数据库:0.02777276,计算:0.027772
2022-03-11 13:34:38.217 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:34:38.217 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:34:38.317 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:38.317 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5028,比列:0.400000,数据库:0.05554552,计算:0.055545
2022-03-11 13:34:38.318 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:34:38.319 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:34:38.416 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:34:38.417 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5028,比列:0.100000,数据库:0.01388638,计算:0.013886
2022-03-11 13:34:38.417 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:36:50.238 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 13:36:50.240 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 13:36:50.335 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 13:36:50.335 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:36:50.336 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:50.433 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:50.434 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:98.5623304000000000,hold:0E-16
2022-03-11 13:36:50.434 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-1.4376696000000000,操作后，计算剩余的金额:98.5623304000000000,操作后，数据库存储的总金额:98.5623304000000000
2022-03-11 13:36:50.435 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:36:50.436 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:36:50.533 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:36:50.533 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:36:50.533 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:36:50.635 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:36:50.635 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:36:50.636 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:36:50.734 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:36:50.734 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:36:50.735 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:36:50.829 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:36:50.830 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 13:36:50.831 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:36:50.927 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:36:50.928 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 13:36:50.928 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 13:36:50.929 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 13:36:51.035 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 10
2022-03-11 13:36:51.036 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-25.4628660000000000, preBalance=100.0000000000000000, postBalance=74.5371340000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓保证金-25.4628660000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1018510000000000, preBalance=74.5371340000000000, postBalance=74.6389850000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027返还手续费0.1018510000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0185146400000000, preBalance=74.6389850000000000, postBalance=73.6204703600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓手续费-1.0185146400000000, createdDate=2022-03-11 13:27:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=3.7890100000000000, preBalance=73.6204703600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028平仓收益3.6501462000000000, createdDate=2022-03-11 13:33:14, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0154290000000000, preBalance=77.2706165600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028返还手续费0.0154290000000000, createdDate=2022-03-11 13:33:14, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.1542928000000000, preBalance=77.2706165600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028平仓手续费-0.1542928000000000, createdDate=2022-03-11 13:33:20, fromUserId=0, total=null), UserBillChain(userId=51905047, type=55, size=-11.0000000000000000, preBalance=77.2706165600000000, postBalance=66.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027增加保证金-11.0000000000000000, createdDate=2022-03-11 13:35:19, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=33.0696560000000000, preBalance=66.2706165600000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029平仓收益32.2917138400000000, createdDate=2022-03-11 13:35:37, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0864380000000000, preBalance=98.5623304000000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029返还手续费0.0864380000000000, createdDate=2022-03-11 13:35:37, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.8643801600000000, preBalance=98.5623304000000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029平仓手续费-0.8643801600000000, createdDate=2022-03-11 13:35:40, fromUserId=0, total=null)]
2022-03-11 13:36:51.036 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:36:51.036 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-25.4628660000000000
2022-03-11 13:36:51.036 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1018510000000000
2022-03-11 13:36:51.036 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0185146400000000
2022-03-11 13:36:51.037 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5027' LIMIT 0,1000 
2022-03-11 13:36:51.037 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:36:51.138 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 2
2022-03-11 13:36:51.139 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:36:51.139 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:36:51.236 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:36:51.238 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:36:51.238 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:36:51.336 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:51.336 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5027,数据库:0.101851,计算:0.101851
2022-03-11 13:36:51.337 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:36:51.337 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:51.432 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:51.433 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:36:51.434 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:51.535 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:51.536 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:36:51.537 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:51.633 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:51.634 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:36:51.634 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:51.735 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:51.736 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:36:51.736 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:36:51.833 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:51.834 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5027,比列:0.300000,数据库:0.27499909,计算:0.274998
2022-03-11 13:36:51.835 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:36:51.836 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:36:51.933 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:51.934 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5027,比列:0.200000,数据库:0.18333272,计算:0.183332
2022-03-11 13:36:51.935 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:36:51.935 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:36:52.033 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:52.034 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5027,比列:0.400000,数据库:0.36666545,计算:0.366665
2022-03-11 13:36:52.035 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:36:52.035 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:36:52.134 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:52.134 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5027,比列:0.100000,数据库:0.09166636,计算:0.091666
2022-03-11 13:36:52.135 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:3.7890100000000000
2022-03-11 13:36:52.136 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5028' LIMIT 0,1000 
2022-03-11 13:36:52.136 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:36:52.233 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:36:52.235 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:36:52.235 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:36:52.334 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:36:52.335 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5028' 
2022-03-11 13:36:52.335 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:36:52.432 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:36:52.433 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5028' AND `margin_type` = 'FIXED' 
2022-03-11 13:36:52.433 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:36:52.531 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:36:52.532 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:36:52.533 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:36:52.635 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:52.635 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5028,数据库:0.06210000,计算得:-0.069000
2022-03-11 13:36:52.636 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0154290000000000
2022-03-11 13:36:52.636 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.1542928000000000
2022-03-11 13:36:52.636 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5028' LIMIT 0,1000 
2022-03-11 13:36:52.637 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:36:52.738 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:36:52.738 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:36:52.739 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:36:52.834 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:36:52.835 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:36:52.836 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:36:52.933 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:52.934 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5028,数据库:0.015429,计算:0.015429
2022-03-11 13:36:52.934 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:36:52.934 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:53.030 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:53.031 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:36:53.032 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:53.132 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:53.132 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:36:53.133 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:53.228 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:53.229 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:36:53.229 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:53.325 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:53.326 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:36:53.327 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:36:53.424 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:53.424 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5028,比列:0.300000,数据库:0.04165914,计算:0.041659
2022-03-11 13:36:53.425 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:36:53.426 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:36:53.522 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:53.522 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5028,比列:0.200000,数据库:0.02777276,计算:0.027772
2022-03-11 13:36:53.523 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:36:53.524 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:36:53.622 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:53.623 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5028,比列:0.400000,数据库:0.05554552,计算:0.055545
2022-03-11 13:36:53.624 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:36:53.624 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:36:53.721 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:53.721 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5028,比列:0.100000,数据库:0.01388638,计算:0.013886
2022-03-11 13:36:53.722 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 逐仓保证金划入:-11.0000000000000000
2022-03-11 13:36:53.722 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:33.0696560000000000
2022-03-11 13:36:53.722 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5029' LIMIT 0,1000 
2022-03-11 13:36:53.723 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:36:53.819 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:36:53.820 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:36:53.820 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:36:53.914 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:36:53.915 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5029' 
2022-03-11 13:36:53.915 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:36:54.011 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:36:54.012 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5029' AND `margin_type` = 'FIXED' 
2022-03-11 13:36:54.012 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:36:54.110 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:36:54.111 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:36:54.111 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:36:54.208 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:54.209 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5029,数据库:-0.41832000,计算得:0.464800
2022-03-11 13:36:54.210 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0864380000000000
2022-03-11 13:36:54.210 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.8643801600000000
2022-03-11 13:36:54.210 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5029' LIMIT 0,1000 
2022-03-11 13:36:54.211 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:36:54.311 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:36:54.312 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:36:54.313 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:36:54.412 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:36:54.414 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:36:54.414 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:36:54.511 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:54.511 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5029,数据库:0.086438,计算:0.086438
2022-03-11 13:36:54.512 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:36:54.512 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:54.607 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:54.608 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:36:54.608 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:54.705 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:54.706 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:36:54.707 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:54.810 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:54.811 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:36:54.811 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:36:54.906 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:36:54.907 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:36:54.907 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:36:55.005 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:55.006 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5029,比列:0.300000,数据库:0.23338264,计算:0.233382
2022-03-11 13:36:55.007 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:36:55.007 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:36:55.104 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:55.104 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5029,比列:0.200000,数据库:0.15558843,计算:0.155588
2022-03-11 13:36:55.105 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:36:55.106 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:36:55.206 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:55.206 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5029,比列:0.400000,数据库:0.31117686,计算:0.311176
2022-03-11 13:36:55.206 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:36:55.207 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:36:55.301 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:36:55.302 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5029,比列:0.100000,数据库:0.07779421,计算:0.077794
2022-03-11 13:36:55.302 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:47:06.986 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 13:47:06.987 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 13:47:07.087 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 13:47:07.088 [http-nio-10090-exec-9] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:07.089 [http-nio-10090-exec-9] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:07.185 [http-nio-10090-exec-9] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:07.186 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:62.2879067600000000,hold:0E-16
2022-03-11 13:47:07.186 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-37.7120932400000000,操作后，计算剩余的金额:62.2879067600000000,操作后，数据库存储的总金额:62.2879067600000000
2022-03-11 13:47:07.186 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:07.187 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:07.287 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:07.288 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:07.288 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:07.389 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:07.391 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:07.392 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:07.491 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:07.492 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:07.493 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:07.592 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:07.593 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 13:47:07.593 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:07.690 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:07.690 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 13:47:07.691 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 13:47:07.691 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 13:47:07.796 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 22
2022-03-11 13:47:07.796 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-25.4628660000000000, preBalance=100.0000000000000000, postBalance=74.5371340000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓保证金-25.4628660000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1018510000000000, preBalance=74.5371340000000000, postBalance=74.6389850000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027返还手续费0.1018510000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0185146400000000, preBalance=74.6389850000000000, postBalance=73.6204703600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓手续费-1.0185146400000000, createdDate=2022-03-11 13:27:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=3.7890100000000000, preBalance=73.6204703600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028平仓收益3.6501462000000000, createdDate=2022-03-11 13:33:14, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0154290000000000, preBalance=77.2706165600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028返还手续费0.0154290000000000, createdDate=2022-03-11 13:33:14, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.1542928000000000, preBalance=77.2706165600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028平仓手续费-0.1542928000000000, createdDate=2022-03-11 13:33:20, fromUserId=0, total=null), UserBillChain(userId=51905047, type=55, size=-11.0000000000000000, preBalance=77.2706165600000000, postBalance=66.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027增加保证金-11.0000000000000000, createdDate=2022-03-11 13:35:19, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=33.0696560000000000, preBalance=66.2706165600000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029平仓收益32.2917138400000000, createdDate=2022-03-11 13:35:37, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0864380000000000, preBalance=98.5623304000000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029返还手续费0.0864380000000000, createdDate=2022-03-11 13:35:37, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.8643801600000000, preBalance=98.5623304000000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029平仓手续费-0.8643801600000000, createdDate=2022-03-11 13:35:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-38.2357800000000000, preBalance=98.5623304000000000, postBalance=60.3265504000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5030, note=单号:5030开仓保证金-38.2357800000000000, createdDate=2022-03-11 13:37:52, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1529430000000000, preBalance=60.3265504000000000, postBalance=60.4794934000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5030, note=单号:5030返还手续费0.1529430000000000, createdDate=2022-03-11 13:37:52, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.5294312000000000, preBalance=60.4794934000000000, postBalance=58.9500622000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5030, note=单号:5030开仓手续费-1.5294312000000000, createdDate=2022-03-11 13:38:00, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=0.1170200000000000, preBalance=58.9500622000000000, postBalance=59.0531672800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5036, note=单号:5036平仓收益0.1031050800000000, createdDate=2022-03-11 13:46:04, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0015450000000000, preBalance=59.0531672800000000, postBalance=59.0531672800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5036, note=单号:5036返还手续费0.0015450000000000, createdDate=2022-03-11 13:46:04, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.0154599200000000, preBalance=59.0531672800000000, postBalance=59.0531672800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5036, note=单号:5036平仓手续费-0.0154599200000000, createdDate=2022-03-11 13:46:13, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-2.3159820000000000, preBalance=59.0531672800000000, postBalance=56.7371852800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5037, note=单号:5037开仓保证金-2.3159820000000000, createdDate=2022-03-11 13:46:39, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0092630000000000, preBalance=56.7371852800000000, postBalance=56.7464482800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5037, note=单号:5037返还手续费0.0092630000000000, createdDate=2022-03-11 13:46:39, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.0926392800000000, preBalance=56.7464482800000000, postBalance=56.6538090000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5037, note=单号:5037开仓手续费-0.0926392800000000, createdDate=2022-03-11 13:46:43, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=6.9961600000000000, preBalance=56.6538090000000000, postBalance=62.2879067600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5038, note=单号:5038平仓收益5.6340977600000000, createdDate=2022-03-11 13:46:54, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1513400000000000, preBalance=62.2879067600000000, postBalance=62.2879067600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5038, note=单号:5038返还手续费0.1513400000000000, createdDate=2022-03-11 13:46:54, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.5134022400000000, preBalance=62.2879067600000000, postBalance=62.2879067600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5038, note=单号:5038平仓手续费-1.5134022400000000, createdDate=2022-03-11 13:47:03, fromUserId=0, total=null)]
2022-03-11 13:47:07.797 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:47:07.797 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-25.4628660000000000
2022-03-11 13:47:07.797 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1018510000000000
2022-03-11 13:47:07.797 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0185146400000000
2022-03-11 13:47:07.798 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5027' LIMIT 0,1000 
2022-03-11 13:47:07.798 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:07.897 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 2
2022-03-11 13:47:07.898 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:07.898 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:07.994 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:07.995 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:07.996 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:08.094 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:08.095 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5027,数据库:0.101851,计算:0.101851
2022-03-11 13:47:08.095 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:08.096 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:08.193 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:08.194 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:08.194 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:08.290 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:08.291 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:08.291 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:08.387 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:08.388 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:08.389 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:08.485 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:08.486 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:08.486 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:08.583 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:08.583 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5027,比列:0.300000,数据库:0.27499909,计算:0.274998
2022-03-11 13:47:08.584 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:08.585 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:08.683 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:08.683 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5027,比列:0.200000,数据库:0.18333272,计算:0.183332
2022-03-11 13:47:08.684 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:08.685 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:08.783 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:08.784 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5027,比列:0.400000,数据库:0.36666545,计算:0.366665
2022-03-11 13:47:08.785 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:08.785 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:08.886 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:08.887 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5027,比列:0.100000,数据库:0.09166636,计算:0.091666
2022-03-11 13:47:08.887 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:3.7890100000000000
2022-03-11 13:47:08.888 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5028' LIMIT 0,1000 
2022-03-11 13:47:08.888 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:08.987 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:08.988 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:08.988 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:09.088 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:09.089 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5028' 
2022-03-11 13:47:09.090 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:09.188 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:09.189 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5028' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:09.189 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:09.286 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:09.287 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:09.288 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:09.395 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:09.396 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5028,数据库:0.06210000,计算得:-0.069000
2022-03-11 13:47:09.396 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0154290000000000
2022-03-11 13:47:09.396 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.1542928000000000
2022-03-11 13:47:09.397 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5028' LIMIT 0,1000 
2022-03-11 13:47:09.397 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:09.497 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:09.497 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:09.497 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:09.592 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:09.593 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:09.594 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:09.695 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:09.696 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5028,数据库:0.015429,计算:0.015429
2022-03-11 13:47:09.696 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:09.696 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:09.792 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:09.792 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:09.793 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:09.891 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:09.891 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:09.891 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:09.987 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:09.988 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:09.988 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:10.085 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:10.086 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:10.087 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:10.188 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:10.188 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5028,比列:0.300000,数据库:0.04165914,计算:0.041659
2022-03-11 13:47:10.189 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:10.190 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:10.289 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:10.289 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5028,比列:0.200000,数据库:0.02777276,计算:0.027772
2022-03-11 13:47:10.290 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:10.291 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:10.388 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:10.388 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5028,比列:0.400000,数据库:0.05554552,计算:0.055545
2022-03-11 13:47:10.389 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:10.389 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:10.486 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:10.487 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5028,比列:0.100000,数据库:0.01388638,计算:0.013886
2022-03-11 13:47:10.487 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 逐仓保证金划入:-11.0000000000000000
2022-03-11 13:47:10.487 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:33.0696560000000000
2022-03-11 13:47:10.488 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5029' LIMIT 0,1000 
2022-03-11 13:47:10.488 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:10.585 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:10.586 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:10.586 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:10.682 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:10.683 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5029' 
2022-03-11 13:47:10.684 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:10.780 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:10.781 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5029' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:10.781 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:10.876 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:10.877 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:10.878 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:10.973 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:10.973 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5029,数据库:-0.41832000,计算得:0.464800
2022-03-11 13:47:10.973 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0864380000000000
2022-03-11 13:47:10.973 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.8643801600000000
2022-03-11 13:47:10.974 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5029' LIMIT 0,1000 
2022-03-11 13:47:10.974 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:11.076 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:11.077 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:11.077 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:11.173 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:11.174 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:11.174 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:11.272 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:11.272 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5029,数据库:0.086438,计算:0.086438
2022-03-11 13:47:11.273 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:11.274 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:11.378 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:11.378 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:11.379 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:11.474 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:11.475 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:11.475 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:11.573 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:11.573 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:11.574 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:11.668 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:11.669 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:11.670 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:11.765 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:11.766 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5029,比列:0.300000,数据库:0.23338264,计算:0.233382
2022-03-11 13:47:11.766 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:11.767 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:11.863 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:11.863 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5029,比列:0.200000,数据库:0.15558843,计算:0.155588
2022-03-11 13:47:11.863 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:11.864 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:11.962 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:11.962 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5029,比列:0.400000,数据库:0.31117686,计算:0.311176
2022-03-11 13:47:11.963 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:11.963 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:12.059 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:12.060 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5029,比列:0.100000,数据库:0.07779421,计算:0.077794
2022-03-11 13:47:12.060 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-38.2357800000000000
2022-03-11 13:47:12.060 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1529430000000000
2022-03-11 13:47:12.061 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.5294312000000000
2022-03-11 13:47:12.061 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5030' LIMIT 0,1000 
2022-03-11 13:47:12.061 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:12.158 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:12.159 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:12.159 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:12.255 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:12.257 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:12.257 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:12.354 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:12.355 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5030,数据库:0.152943,计算:0.152943
2022-03-11 13:47:12.356 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:12.356 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:12.458 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:12.458 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:12.458 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:12.553 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:12.553 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:12.553 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:12.652 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:12.653 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:12.653 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:12.748 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:12.749 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:12.749 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:12.847 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:12.847 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5030,比列:0.300000,数据库:0.41294646,计算:0.412946
2022-03-11 13:47:12.848 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:12.848 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:12.944 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:12.944 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5030,比列:0.200000,数据库:0.27529764,计算:0.275297
2022-03-11 13:47:12.945 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:12.945 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:13.041 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:13.041 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5030,比列:0.400000,数据库:0.55059528,计算:0.550595
2022-03-11 13:47:13.041 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:13.041 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:13.136 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:13.136 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5030,比列:0.100000,数据库:0.13764882,计算:0.137648
2022-03-11 13:47:13.137 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:0.1170200000000000
2022-03-11 13:47:13.137 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5036' LIMIT 0,1000 
2022-03-11 13:47:13.137 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:13.233 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:13.233 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:13.234 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:13.329 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:13.329 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5036' 
2022-03-11 13:47:13.329 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:13.427 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:13.427 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5036' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:13.427 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:13.523 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:13.524 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:13.524 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:13.620 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:13.620 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5036,数据库:0.24498000,计算得:-0.272200
2022-03-11 13:47:13.621 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0015450000000000
2022-03-11 13:47:13.621 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.0154599200000000
2022-03-11 13:47:13.622 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5036' LIMIT 0,1000 
2022-03-11 13:47:13.622 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:13.719 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:13.720 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:13.720 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:13.816 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:13.818 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:13.818 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:13.919 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:13.919 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5036,数据库:0.001545,计算:0.001545
2022-03-11 13:47:13.920 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:13.921 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:14.018 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:14.018 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:14.019 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:14.117 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:14.118 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:14.118 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:14.213 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:14.214 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:14.214 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:14.309 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:14.310 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:14.310 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:14.406 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:14.407 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5036,比列:0.300000,数据库:0.00417447,计算:0.004174
2022-03-11 13:47:14.408 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:14.408 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:14.505 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:14.505 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5036,比列:0.200000,数据库:0.00278298,计算:0.002782
2022-03-11 13:47:14.506 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:14.507 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:14.609 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:14.609 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5036,比列:0.400000,数据库:0.00556596,计算:0.005565
2022-03-11 13:47:14.610 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:14.610 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:14.706 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:14.706 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5036,比列:0.100000,数据库:0.00139149,计算:0.001391
2022-03-11 13:47:14.706 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-2.3159820000000000
2022-03-11 13:47:14.706 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0092630000000000
2022-03-11 13:47:14.706 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.0926392800000000
2022-03-11 13:47:14.707 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5037' LIMIT 0,1000 
2022-03-11 13:47:14.707 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:14.804 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:14.805 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:14.805 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:14.905 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:14.906 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:14.906 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:15.003 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:15.003 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5037,数据库:0.009263,计算:0.009263
2022-03-11 13:47:15.004 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:15.004 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:15.100 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:15.101 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:15.101 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:15.199 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:15.199 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:15.200 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:15.294 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:15.294 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:15.294 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:15.395 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:15.396 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:15.396 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:15.495 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:15.496 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5037,比列:0.300000,数据库:0.02501288,计算:0.025012
2022-03-11 13:47:15.497 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:15.498 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:15.594 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:15.594 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5037,比列:0.200000,数据库:0.01667525,计算:0.016675
2022-03-11 13:47:15.595 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:15.595 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:15.690 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:15.690 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5037,比列:0.400000,数据库:0.03335051,计算:0.033350
2022-03-11 13:47:15.691 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:15.691 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:15.786 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:15.786 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5037,比列:0.100000,数据库:0.00833762,计算:0.008337
2022-03-11 13:47:15.786 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:6.9961600000000000
2022-03-11 13:47:15.787 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5038' LIMIT 0,1000 
2022-03-11 13:47:15.787 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:15.883 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:15.884 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:15.884 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:15.982 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:15.983 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5038' 
2022-03-11 13:47:15.983 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:16.077 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:16.078 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5038' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:16.078 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:16.174 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:16.176 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:16.176 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:16.273 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:16.273 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5038,数据库:27.76536000,计算得:-30.850400
2022-03-11 13:47:16.273 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1513400000000000
2022-03-11 13:47:16.274 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.5134022400000000
2022-03-11 13:47:16.274 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5038' LIMIT 0,1000 
2022-03-11 13:47:16.275 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:16.371 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:16.372 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:16.372 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:16.467 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:16.468 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:16.468 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:16.564 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:16.565 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5038,数据库:0.151340,计算:0.151340
2022-03-11 13:47:16.566 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:16.566 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:16.662 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:16.663 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:16.664 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:16.760 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:16.761 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:16.761 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:16.858 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:16.859 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:16.859 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:16.963 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:16.964 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:16.964 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:17.068 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:17.068 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5038,比列:0.300000,数据库:0.40861867,计算:0.408618
2022-03-11 13:47:17.069 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:17.069 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:17.166 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:17.167 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5038,比列:0.200000,数据库:0.27241244,计算:0.272412
2022-03-11 13:47:17.168 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:17.169 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:17.267 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:17.267 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5038,比列:0.400000,数据库:0.54482489,计算:0.544824
2022-03-11 13:47:17.268 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:17.269 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:17.366 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:17.367 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5038,比列:0.100000,数据库:0.13620622,计算:0.136206
2022-03-11 13:47:17.367 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:47:17.395 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 13:47:17.395 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 13:47:17.490 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 13:47:17.491 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:17.491 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:17.587 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:17.588 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:64.5499232400000000,hold:0E-16
2022-03-11 13:47:17.588 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-35.4500767600000000,操作后，计算剩余的金额:64.5499232400000000,操作后，数据库存储的总金额:64.5499232400000000
2022-03-11 13:47:17.589 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:17.589 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:17.686 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:17.687 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:17.687 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:17.783 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:17.784 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:17.785 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:17.883 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:17.884 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:17.884 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:17.991 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:17.992 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 13:47:17.992 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 13:47:18.088 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 13:47:18.089 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 13:47:18.090 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 13:47:18.090 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 13:47:18.196 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 25
2022-03-11 13:47:18.196 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-25.4628660000000000, preBalance=100.0000000000000000, postBalance=74.5371340000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓保证金-25.4628660000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1018510000000000, preBalance=74.5371340000000000, postBalance=74.6389850000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027返还手续费0.1018510000000000, createdDate=2022-03-11 13:27:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0185146400000000, preBalance=74.6389850000000000, postBalance=73.6204703600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027开仓手续费-1.0185146400000000, createdDate=2022-03-11 13:27:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=3.7890100000000000, preBalance=73.6204703600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028平仓收益3.6501462000000000, createdDate=2022-03-11 13:33:14, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0154290000000000, preBalance=77.2706165600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028返还手续费0.0154290000000000, createdDate=2022-03-11 13:33:14, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.1542928000000000, preBalance=77.2706165600000000, postBalance=77.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5028, note=单号:5028平仓手续费-0.1542928000000000, createdDate=2022-03-11 13:33:20, fromUserId=0, total=null), UserBillChain(userId=51905047, type=55, size=-11.0000000000000000, preBalance=77.2706165600000000, postBalance=66.2706165600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5027, note=单号:5027增加保证金-11.0000000000000000, createdDate=2022-03-11 13:35:19, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=33.0696560000000000, preBalance=66.2706165600000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029平仓收益32.2917138400000000, createdDate=2022-03-11 13:35:37, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0864380000000000, preBalance=98.5623304000000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029返还手续费0.0864380000000000, createdDate=2022-03-11 13:35:37, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.8643801600000000, preBalance=98.5623304000000000, postBalance=98.5623304000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5029, note=单号:5029平仓手续费-0.8643801600000000, createdDate=2022-03-11 13:35:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-38.2357800000000000, preBalance=98.5623304000000000, postBalance=60.3265504000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5030, note=单号:5030开仓保证金-38.2357800000000000, createdDate=2022-03-11 13:37:52, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1529430000000000, preBalance=60.3265504000000000, postBalance=60.4794934000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5030, note=单号:5030返还手续费0.1529430000000000, createdDate=2022-03-11 13:37:52, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.5294312000000000, preBalance=60.4794934000000000, postBalance=58.9500622000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5030, note=单号:5030开仓手续费-1.5294312000000000, createdDate=2022-03-11 13:38:00, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=0.1170200000000000, preBalance=58.9500622000000000, postBalance=59.0531672800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5036, note=单号:5036平仓收益0.1031050800000000, createdDate=2022-03-11 13:46:04, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0015450000000000, preBalance=59.0531672800000000, postBalance=59.0531672800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5036, note=单号:5036返还手续费0.0015450000000000, createdDate=2022-03-11 13:46:04, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.0154599200000000, preBalance=59.0531672800000000, postBalance=59.0531672800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5036, note=单号:5036平仓手续费-0.0154599200000000, createdDate=2022-03-11 13:46:13, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-2.3159820000000000, preBalance=59.0531672800000000, postBalance=56.7371852800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5037, note=单号:5037开仓保证金-2.3159820000000000, createdDate=2022-03-11 13:46:39, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0092630000000000, preBalance=56.7371852800000000, postBalance=56.7464482800000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5037, note=单号:5037返还手续费0.0092630000000000, createdDate=2022-03-11 13:46:39, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.0926392800000000, preBalance=56.7464482800000000, postBalance=56.6538090000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5037, note=单号:5037开仓手续费-0.0926392800000000, createdDate=2022-03-11 13:46:43, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=6.9961600000000000, preBalance=56.6538090000000000, postBalance=62.2879067600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5038, note=单号:5038平仓收益5.6340977600000000, createdDate=2022-03-11 13:46:54, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1513400000000000, preBalance=62.2879067600000000, postBalance=62.2879067600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5038, note=单号:5038返还手续费0.1513400000000000, createdDate=2022-03-11 13:46:54, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.5134022400000000, preBalance=62.2879067600000000, postBalance=62.2879067600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5038, note=单号:5038平仓手续费-1.5134022400000000, createdDate=2022-03-11 13:47:03, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=2.3453820000000000, preBalance=62.2879067600000000, postBalance=64.5499232400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5039, note=单号:5039平仓收益2.2620164800000000, createdDate=2022-03-11 13:47:09, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0092620000000000, preBalance=64.5499232400000000, postBalance=64.5499232400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5039, note=单号:5039返还手续费0.0092620000000000, createdDate=2022-03-11 13:47:09, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-0.0926275200000000, preBalance=64.5499232400000000, postBalance=64.5499232400000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5039, note=单号:5039平仓手续费-0.0926275200000000, createdDate=2022-03-11 13:47:13, fromUserId=0, total=null)]
2022-03-11 13:47:18.196 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 13:47:18.196 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-25.4628660000000000
2022-03-11 13:47:18.197 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1018510000000000
2022-03-11 13:47:18.197 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0185146400000000
2022-03-11 13:47:18.197 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5027' LIMIT 0,1000 
2022-03-11 13:47:18.197 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:18.298 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 2
2022-03-11 13:47:18.298 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:18.299 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:18.400 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:18.402 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:18.402 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:18.501 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:18.501 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5027,数据库:0.101851,计算:0.101851
2022-03-11 13:47:18.503 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:18.503 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:18.608 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:18.609 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:18.609 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:18.704 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:18.705 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:18.705 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:18.802 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:18.803 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:18.803 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:18.900 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:18.901 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:18.902 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:19.003 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:19.003 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5027,比列:0.300000,数据库:0.27499909,计算:0.274998
2022-03-11 13:47:19.004 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:19.005 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:19.103 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:19.103 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5027,比列:0.200000,数据库:0.18333272,计算:0.183332
2022-03-11 13:47:19.104 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:19.104 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:19.199 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:19.200 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5027,比列:0.400000,数据库:0.36666545,计算:0.366665
2022-03-11 13:47:19.200 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5027' and type=? limit 0,1 
2022-03-11 13:47:19.200 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:19.302 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:19.303 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5027,比列:0.100000,数据库:0.09166636,计算:0.091666
2022-03-11 13:47:19.303 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:3.7890100000000000
2022-03-11 13:47:19.304 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5028' LIMIT 0,1000 
2022-03-11 13:47:19.304 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:19.404 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:19.405 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:19.406 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:19.501 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:19.502 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5028' 
2022-03-11 13:47:19.503 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:19.602 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:19.603 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5028' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:19.603 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:19.698 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:19.699 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:19.700 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:19.795 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:19.795 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5028,数据库:0.06210000,计算得:-0.069000
2022-03-11 13:47:19.796 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0154290000000000
2022-03-11 13:47:19.796 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.1542928000000000
2022-03-11 13:47:19.796 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5028' LIMIT 0,1000 
2022-03-11 13:47:19.796 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:19.894 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:19.894 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:19.895 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:19.992 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:19.993 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:19.994 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:20.094 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:20.095 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5028,数据库:0.015429,计算:0.015429
2022-03-11 13:47:20.096 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:20.097 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:20.198 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:20.199 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:20.199 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:20.295 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:20.296 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:20.297 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:20.397 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:20.398 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:20.398 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:20.494 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:20.495 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:20.495 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:20.592 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:20.592 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5028,比列:0.300000,数据库:0.04165914,计算:0.041659
2022-03-11 13:47:20.593 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:20.594 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:20.689 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:20.689 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5028,比列:0.200000,数据库:0.02777276,计算:0.027772
2022-03-11 13:47:20.690 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:20.690 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:20.785 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:20.785 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5028,比列:0.400000,数据库:0.05554552,计算:0.055545
2022-03-11 13:47:20.786 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5028' and type=? limit 0,1 
2022-03-11 13:47:20.786 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:20.884 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:20.884 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5028,比列:0.100000,数据库:0.01388638,计算:0.013886
2022-03-11 13:47:20.885 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 逐仓保证金划入:-11.0000000000000000
2022-03-11 13:47:20.885 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:33.0696560000000000
2022-03-11 13:47:20.886 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5029' LIMIT 0,1000 
2022-03-11 13:47:20.886 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:20.983 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:20.984 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:20.984 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:21.081 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:21.082 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5029' 
2022-03-11 13:47:21.083 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:21.178 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:21.179 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5029' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:21.180 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:21.275 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:21.275 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:21.275 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:21.375 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:21.375 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5029,数据库:-0.41832000,计算得:0.464800
2022-03-11 13:47:21.375 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0864380000000000
2022-03-11 13:47:21.375 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.8643801600000000
2022-03-11 13:47:21.376 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5029' LIMIT 0,1000 
2022-03-11 13:47:21.376 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:21.472 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:21.472 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:21.472 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:21.567 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:21.568 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:21.568 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:21.665 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:21.666 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5029,数据库:0.086438,计算:0.086438
2022-03-11 13:47:21.666 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:21.667 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:21.762 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:21.763 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:21.763 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:21.859 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:21.860 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:21.860 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:21.956 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:21.957 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:21.957 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:22.053 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:22.053 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:22.054 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:22.152 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:22.152 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5029,比列:0.300000,数据库:0.23338264,计算:0.233382
2022-03-11 13:47:22.153 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:22.153 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:22.248 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:22.249 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5029,比列:0.200000,数据库:0.15558843,计算:0.155588
2022-03-11 13:47:22.249 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:22.249 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:22.349 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:22.349 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5029,比列:0.400000,数据库:0.31117686,计算:0.311176
2022-03-11 13:47:22.350 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5029' and type=? limit 0,1 
2022-03-11 13:47:22.351 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:22.453 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:22.453 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5029,比列:0.100000,数据库:0.07779421,计算:0.077794
2022-03-11 13:47:22.453 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-38.2357800000000000
2022-03-11 13:47:22.454 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1529430000000000
2022-03-11 13:47:22.454 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.5294312000000000
2022-03-11 13:47:22.454 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5030' LIMIT 0,1000 
2022-03-11 13:47:22.455 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:22.552 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:22.552 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:22.553 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:22.647 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:22.648 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:22.649 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:22.751 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:22.751 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5030,数据库:0.152943,计算:0.152943
2022-03-11 13:47:22.752 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:22.752 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:22.858 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:22.858 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:22.858 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:22.962 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:22.963 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:22.963 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:23.062 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:23.062 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:23.063 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:23.159 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:23.160 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:23.160 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:23.259 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:23.259 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5030,比列:0.300000,数据库:0.41294646,计算:0.412946
2022-03-11 13:47:23.260 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:23.260 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:23.358 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:23.358 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5030,比列:0.200000,数据库:0.27529764,计算:0.275297
2022-03-11 13:47:23.359 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:23.359 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:23.455 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:23.455 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5030,比列:0.400000,数据库:0.55059528,计算:0.550595
2022-03-11 13:47:23.455 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5030' and type=? limit 0,1 
2022-03-11 13:47:23.455 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:23.557 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:23.557 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5030,比列:0.100000,数据库:0.13764882,计算:0.137648
2022-03-11 13:47:23.558 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:0.1170200000000000
2022-03-11 13:47:23.558 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5036' LIMIT 0,1000 
2022-03-11 13:47:23.558 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:23.655 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:23.656 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:23.656 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:23.759 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:23.760 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5036' 
2022-03-11 13:47:23.761 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:23.856 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:23.857 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5036' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:23.858 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:23.954 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:23.955 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:23.955 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:24.052 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:24.052 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5036,数据库:0.24498000,计算得:-0.272200
2022-03-11 13:47:24.053 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0015450000000000
2022-03-11 13:47:24.053 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.0154599200000000
2022-03-11 13:47:24.054 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5036' LIMIT 0,1000 
2022-03-11 13:47:24.054 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:24.153 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:24.154 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:24.154 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:24.250 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:24.251 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:24.251 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:24.346 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:24.346 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5036,数据库:0.001545,计算:0.001545
2022-03-11 13:47:24.347 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:24.347 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:24.443 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:24.444 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:24.444 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:24.540 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:24.540 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:24.541 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:24.637 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:24.638 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:24.638 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:24.734 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:24.735 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:24.736 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:24.831 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:24.831 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5036,比列:0.300000,数据库:0.00417447,计算:0.004174
2022-03-11 13:47:24.831 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:24.832 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:24.930 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:24.930 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5036,比列:0.200000,数据库:0.00278298,计算:0.002782
2022-03-11 13:47:24.931 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:24.932 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:25.029 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:25.029 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5036,比列:0.400000,数据库:0.00556596,计算:0.005565
2022-03-11 13:47:25.030 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5036' and type=? limit 0,1 
2022-03-11 13:47:25.030 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:25.126 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:25.127 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5036,比列:0.100000,数据库:0.00139149,计算:0.001391
2022-03-11 13:47:25.127 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-2.3159820000000000
2022-03-11 13:47:25.127 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0092630000000000
2022-03-11 13:47:25.127 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.0926392800000000
2022-03-11 13:47:25.128 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5037' LIMIT 0,1000 
2022-03-11 13:47:25.128 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:25.229 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:25.230 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:25.230 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:25.329 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:25.330 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:25.330 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:25.435 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:25.436 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5037,数据库:0.009263,计算:0.009263
2022-03-11 13:47:25.436 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:25.436 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:25.539 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:25.540 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:25.540 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:25.636 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:25.637 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:25.637 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:25.733 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:25.734 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:25.734 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:25.829 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:25.829 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:25.829 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:25.926 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:25.927 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5037,比列:0.300000,数据库:0.02501288,计算:0.025012
2022-03-11 13:47:25.927 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:25.928 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:26.024 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:26.024 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5037,比列:0.200000,数据库:0.01667525,计算:0.016675
2022-03-11 13:47:26.025 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:26.026 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:26.123 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:26.123 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5037,比列:0.400000,数据库:0.03335051,计算:0.033350
2022-03-11 13:47:26.124 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5037' and type=? limit 0,1 
2022-03-11 13:47:26.124 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:26.220 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:26.220 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5037,比列:0.100000,数据库:0.00833762,计算:0.008337
2022-03-11 13:47:26.221 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:6.9961600000000000
2022-03-11 13:47:26.221 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5038' LIMIT 0,1000 
2022-03-11 13:47:26.221 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:26.317 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:26.318 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:26.319 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:26.414 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:26.415 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5038' 
2022-03-11 13:47:26.415 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:26.513 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:26.514 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5038' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:26.514 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:26.612 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:26.612 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:26.612 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:26.708 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:26.709 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5038,数据库:27.76536000,计算得:-30.850400
2022-03-11 13:47:26.709 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1513400000000000
2022-03-11 13:47:26.709 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.5134022400000000
2022-03-11 13:47:26.710 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5038' LIMIT 0,1000 
2022-03-11 13:47:26.710 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:26.807 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:26.807 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:26.808 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:26.903 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:26.904 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:26.905 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:27.003 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:27.003 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5038,数据库:0.151340,计算:0.151340
2022-03-11 13:47:27.004 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:27.005 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:27.100 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:27.100 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:27.100 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:27.205 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:27.206 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:27.206 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:27.307 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:27.307 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:27.308 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:27.405 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:27.406 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:27.407 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:27.504 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:27.504 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5038,比列:0.300000,数据库:0.40861867,计算:0.408618
2022-03-11 13:47:27.505 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:27.505 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:27.606 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:27.607 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5038,比列:0.200000,数据库:0.27241244,计算:0.272412
2022-03-11 13:47:27.607 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:27.608 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:27.703 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:27.704 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5038,比列:0.400000,数据库:0.54482489,计算:0.544824
2022-03-11 13:47:27.705 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5038' and type=? limit 0,1 
2022-03-11 13:47:27.705 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:27.801 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:27.802 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5038,比列:0.100000,数据库:0.13620622,计算:0.136206
2022-03-11 13:47:27.802 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:2.3453820000000000
2022-03-11 13:47:27.802 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5039' LIMIT 0,1000 
2022-03-11 13:47:27.803 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:27.899 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:27.900 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:27.900 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:27.996 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:27.996 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5039' 
2022-03-11 13:47:27.997 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 13:47:28.092 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 13:47:28.093 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5039' AND `margin_type` = 'FIXED' 
2022-03-11 13:47:28.093 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 13:47:28.192 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 13:47:28.193 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5039' and type=? limit 0,1 
2022-03-11 13:47:28.193 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 13:47:28.290 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:28.290 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5039,数据库:-0.02646000,计算得:0.029400
2022-03-11 13:47:28.290 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0092620000000000
2022-03-11 13:47:28.290 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-0.0926275200000000
2022-03-11 13:47:28.291 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5039' LIMIT 0,1000 
2022-03-11 13:47:28.291 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 13:47:28.388 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 13:47:28.389 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 13:47:28.389 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 13:47:28.484 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 13:47:28.485 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5039' and type=? limit 0,1 
2022-03-11 13:47:28.486 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 13:47:28.582 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:28.582 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5039,数据库:0.009262,计算:0.009262
2022-03-11 13:47:28.583 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 13:47:28.583 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:28.681 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:28.682 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 13:47:28.682 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:28.781 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:28.781 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 13:47:28.782 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:28.878 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:28.879 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 13:47:28.879 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 13:47:28.974 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 13:47:28.975 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5039' and type=? limit 0,1 
2022-03-11 13:47:28.976 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 13:47:29.072 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:29.072 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5039,比列:0.300000,数据库:0.02500965,计算:0.025009
2022-03-11 13:47:29.073 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5039' and type=? limit 0,1 
2022-03-11 13:47:29.073 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 13:47:29.169 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:29.170 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5039,比列:0.200000,数据库:0.01667310,计算:0.016672
2022-03-11 13:47:29.170 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5039' and type=? limit 0,1 
2022-03-11 13:47:29.171 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 13:47:29.271 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:29.271 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5039,比列:0.400000,数据库:0.03334620,计算:0.033345
2022-03-11 13:47:29.272 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5039' and type=? limit 0,1 
2022-03-11 13:47:29.273 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 13:47:29.371 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 13:47:29.371 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5039,比列:0.100000,数据库:0.00833655,计算:0.008336
2022-03-11 13:47:29.371 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 15:06:21.771 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 15:06:21.771 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 15:06:22.178 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 15:06:22.179 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 15:06:22.179 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:22.283 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:22.283 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:0E-16,hold:0E-16
2022-03-11 15:06:22.284 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-100.0000000000000000,操作后，计算剩余的金额:0E-16,操作后，数据库存储的总金额:0E-16
2022-03-11 15:06:22.284 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 15:06:22.284 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:06:22.696 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:06:22.696 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 15:06:22.696 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:06:22.804 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:06:22.805 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 15:06:22.806 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:06:22.912 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:06:22.912 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 15:06:22.912 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:06:23.020 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:06:23.020 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 15:06:23.021 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:06:23.437 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:06:23.437 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 15:06:23.437 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 15:06:23.437 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 15:06:23.649 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 7
2022-03-11 15:06:23.649 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-51.5613120000000000, preBalance=100.0000000000000000, postBalance=48.4386880000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5104, note=单号:5104开仓保证金-51.5613120000000000, createdDate=2022-03-11 15:03:45, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1031220000000000, preBalance=48.4386880000000000, postBalance=48.5418100000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5104, note=单号:5104返还手续费0.1031220000000000, createdDate=2022-03-11 15:03:46, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0312262400000000, preBalance=48.5418100000000000, postBalance=47.5105837600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5104, note=单号:5104开仓手续费-1.0312262400000000, createdDate=2022-03-11 15:03:48, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-607.7258880000000000, preBalance=47.5105837600000000, postBalance=-561.1436646000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5105, note=单号:5105平仓收益-608.6542483600000000, createdDate=2022-03-11 15:04:27, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1031510000000000, preBalance=-561.1436646000000000, postBalance=-561.1436646000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5105, note=单号:5105返还手续费0.1031510000000000, createdDate=2022-03-11 15:04:27, fromUserId=0, total=null), UserBillChain(userId=51905047, type=54, size=561.1436646000000000, preBalance=-561.1436646000000000, postBalance=0E-16, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5105, note=单号:5105穿仓回补561.1436646000000000, createdDate=2022-03-11 15:04:28, fromUserId=51904446, total=null), UserBillChain(userId=51905047, type=52, size=-1.0315113600000000, preBalance=0E-16, postBalance=0E-16, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5105, note=单号:5105平仓手续费-1.0315113600000000, createdDate=2022-03-11 15:04:28, fromUserId=0, total=null)]
2022-03-11 15:06:23.649 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 15:06:23.649 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-51.5613120000000000
2022-03-11 15:06:23.649 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1031220000000000
2022-03-11 15:06:23.649 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0312262400000000
2022-03-11 15:06:23.650 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5104' LIMIT 0,1000 
2022-03-11 15:06:23.650 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 15:06:24.183 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 15:06:24.184 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 15:06:24.184 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 15:06:24.295 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 15:06:24.295 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5104' and type=? limit 0,1 
2022-03-11 15:06:24.296 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 15:06:24.397 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:24.398 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5104,数据库:0.103122,计算:0.103122
2022-03-11 15:06:24.398 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 15:06:24.398 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:24.509 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:24.509 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 15:06:24.510 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:24.612 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:24.612 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 15:06:24.612 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:24.716 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:24.717 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 15:06:24.717 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:24.825 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:24.826 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5104' and type=? limit 0,1 
2022-03-11 15:06:24.826 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 15:06:24.932 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:24.932 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5104,比列:0.300000,数据库:0.27843127,计算:0.278431
2022-03-11 15:06:24.933 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5104' and type=? limit 0,1 
2022-03-11 15:06:24.933 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 15:06:25.037 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:25.037 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5104,比列:0.200000,数据库:0.18562084,计算:0.185620
2022-03-11 15:06:25.038 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5104' and type=? limit 0,1 
2022-03-11 15:06:25.038 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 15:06:25.447 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:25.447 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5104,比列:0.400000,数据库:0.37124169,计算:0.371241
2022-03-11 15:06:25.447 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5104' and type=? limit 0,1 
2022-03-11 15:06:25.448 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 15:06:25.547 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:25.548 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5104,比列:0.100000,数据库:0.09281042,计算:0.092810
2022-03-11 15:06:25.548 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-607.7258880000000000
2022-03-11 15:06:25.548 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5105' LIMIT 0,1000 
2022-03-11 15:06:25.548 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 15:06:25.652 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 15:06:25.653 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 15:06:25.653 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 15:06:26.058 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 15:06:26.058 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5105' 
2022-03-11 15:06:26.058 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 15:06:26.161 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 15:06:26.161 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5105' AND `margin_type` = 'FIXED' 
2022-03-11 15:06:26.162 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 15:06:26.264 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 15:06:26.264 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5105' and type=? limit 0,1 
2022-03-11 15:06:26.264 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 15:06:26.372 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:26.372 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5105,数据库:659.28720000,计算得:-659.287200
2022-03-11 15:06:26.373 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1031510000000000
2022-03-11 15:06:26.373 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 穿仓回补（给用户加钱到0）给用户:561.1436646000000000
2022-03-11 15:06:26.373 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5105' and type=? limit 0,1 
2022-03-11 15:06:26.373 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 38(Integer)
2022-03-11 15:06:26.778 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:26.779 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ThroughPositionsCalc - partnerBack--合伙人--穿仓回退--->用户:51905047,合伙人:51904446,交易类型:54,订单:5105,数据库:-561.14366460,计算得:561.143664
2022-03-11 15:06:26.779 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.0315113600000000
2022-03-11 15:06:26.779 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5105' LIMIT 0,1000 
2022-03-11 15:06:26.780 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 15:06:26.889 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 15:06:26.890 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 15:06:26.890 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 15:06:26.996 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 15:06:26.996 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5105' and type=? limit 0,1 
2022-03-11 15:06:26.997 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 15:06:27.107 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:27.107 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5105,数据库:0.103151,计算:0.103151
2022-03-11 15:06:27.108 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 15:06:27.108 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:27.211 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:27.211 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 15:06:27.211 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:27.320 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:27.321 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 15:06:27.321 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:27.434 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:27.434 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 15:06:27.435 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:06:27.539 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:06:27.540 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5105' and type=? limit 0,1 
2022-03-11 15:06:27.540 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 15:06:27.652 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:27.653 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5105,比列:0.300000,数据库:0.27850810,计算:0.278508
2022-03-11 15:06:27.653 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5105' and type=? limit 0,1 
2022-03-11 15:06:27.653 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 15:06:27.758 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:27.758 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5105,比列:0.200000,数据库:0.18567207,计算:0.185672
2022-03-11 15:06:27.759 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5105' and type=? limit 0,1 
2022-03-11 15:06:27.759 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 15:06:27.864 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:27.864 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5105,比列:0.400000,数据库:0.37134414,计算:0.371344
2022-03-11 15:06:27.864 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5105' and type=? limit 0,1 
2022-03-11 15:06:27.865 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 15:06:28.271 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:06:28.272 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5105,比列:0.100000,数据库:0.09283603,计算:0.092836
2022-03-11 15:06:28.273 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 15:11:18.787 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 15:11:18.788 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 15:11:18.894 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 15:11:18.894 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 15:11:18.894 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:18.996 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:18.996 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:47.4319743600000000,hold:0E-16
2022-03-11 15:11:18.996 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-53.4983608400000000,操作后，计算剩余的金额:46.5016391600000000,操作后，数据库存储的总金额:47.4319743600000000
2022-03-11 15:11:18.996 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 15:11:18.997 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:11:19.100 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:11:19.101 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 15:11:19.101 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:11:19.211 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:11:19.211 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 15:11:19.212 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:11:19.627 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:11:19.628 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 15:11:19.628 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:11:19.732 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:11:19.733 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 15:11:19.734 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 15:11:19.839 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 15:11:19.840 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 15:11:19.840 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 15:11:19.841 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 15:11:19.952 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 5
2022-03-11 15:11:19.952 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-51.6385320000000000, preBalance=100.0000000000000000, postBalance=48.3614680000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5106, note=单号:5106开仓保证金-51.6385320000000000, createdDate=2022-03-11 15:06:53, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1032770000000000, preBalance=48.3614680000000000, postBalance=48.4647450000000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5106, note=单号:5106返还手续费0.1032770000000000, createdDate=2022-03-11 15:06:53, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0327706400000000, preBalance=48.4647450000000000, postBalance=47.4319743600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5106, note=单号:5106开仓手续费-1.0327706400000000, createdDate=2022-03-11 15:06:58, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1033700000000000, preBalance=47.4319743600000000, postBalance=47.4319743600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5107, note=单号:5107返还手续费0.1033700000000000, createdDate=2022-03-11 15:08:03, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.0337052000000000, preBalance=47.4319743600000000, postBalance=47.4319743600000000, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5107, note=单号:5107平仓手续费-1.0337052000000000, createdDate=2022-03-11 15:08:08, fromUserId=0, total=null)]
2022-03-11 15:11:19.953 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 15:11:19.953 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-51.6385320000000000
2022-03-11 15:11:19.953 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1032770000000000
2022-03-11 15:11:19.953 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0327706400000000
2022-03-11 15:11:19.953 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5106' LIMIT 0,1000 
2022-03-11 15:11:19.953 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 15:11:20.059 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 15:11:20.060 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 15:11:20.060 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 15:11:20.165 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 15:11:20.166 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5106' and type=? limit 0,1 
2022-03-11 15:11:20.166 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 15:11:20.272 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:20.272 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5106,数据库:0.103277,计算:0.103277
2022-03-11 15:11:20.272 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 15:11:20.272 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:20.362 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:20.363 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 15:11:20.363 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:20.464 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:20.464 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 15:11:20.464 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:20.563 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:20.564 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 15:11:20.564 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:20.665 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:20.666 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5106' and type=? limit 0,1 
2022-03-11 15:11:20.667 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 15:11:20.773 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:20.774 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5106,比列:0.300000,数据库:0.27884809,计算:0.278848
2022-03-11 15:11:20.774 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5106' and type=? limit 0,1 
2022-03-11 15:11:20.774 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 15:11:20.881 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:20.881 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5106,比列:0.200000,数据库:0.18589872,计算:0.185898
2022-03-11 15:11:20.882 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5106' and type=? limit 0,1 
2022-03-11 15:11:20.882 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 15:11:20.986 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:20.987 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5106,比列:0.400000,数据库:0.37179745,计算:0.371797
2022-03-11 15:11:20.987 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5106' and type=? limit 0,1 
2022-03-11 15:11:20.987 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 15:11:21.089 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:21.089 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5106,比列:0.100000,数据库:0.09294936,计算:0.092949
2022-03-11 15:11:21.089 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1033700000000000
2022-03-11 15:11:21.089 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.0337052000000000
2022-03-11 15:11:21.090 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5107' LIMIT 0,1000 
2022-03-11 15:11:21.090 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 15:11:21.196 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 15:11:21.196 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 15:11:21.197 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 15:11:21.607 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 15:11:21.607 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5107' and type=? limit 0,1 
2022-03-11 15:11:21.607 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 15:11:21.717 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:21.717 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5107,数据库:0.103370,计算:0.103370
2022-03-11 15:11:21.717 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 15:11:21.718 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:22.135 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:22.135 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 15:11:22.136 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:23.158 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:23.159 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 15:11:23.159 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:23.869 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:23.870 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 15:11:23.870 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 15:11:23.978 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 15:11:23.979 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5107' and type=? limit 0,1 
2022-03-11 15:11:23.980 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 15:11:24.087 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:24.087 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5107,比列:0.300000,数据库:0.27910056,计算:0.279100
2022-03-11 15:11:24.088 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5107' and type=? limit 0,1 
2022-03-11 15:11:24.088 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 15:11:24.188 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:24.188 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5107,比列:0.200000,数据库:0.18606704,计算:0.186066
2022-03-11 15:11:24.189 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5107' and type=? limit 0,1 
2022-03-11 15:11:24.189 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 15:11:24.286 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:24.286 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5107,比列:0.400000,数据库:0.37213408,计算:0.372133
2022-03-11 15:11:24.287 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5107' and type=? limit 0,1 
2022-03-11 15:11:24.287 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 15:11:24.392 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 15:11:24.393 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5107,比列:0.100000,数据库:0.09303352,计算:0.093033
2022-03-11 15:11:24.393 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:07:43.216 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:07:43.217 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:43.297 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:43.298 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:07:43.298 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:43.377 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:43.377 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:07:43.378 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:43.458 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:43.459 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:07:43.459 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:43.542 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:43.542 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:07:43.542 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:43.623 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:43.624 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:07:43.649 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:07:43.649 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:43.728 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:43.729 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:07:43.729 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:43.812 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:43.814 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `liquidate_by` LIKE '%coerceClose%' LIMIT 0,1000 
2022-03-11 16:07:43.814 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:07:43.904 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:07:43.905 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:07:43.905 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:07:43.985 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:07:43.987 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:07:43.987 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:44.069 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:44.070 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:07:44.071 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:07:44.152 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:07:44.153 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 账户初始保证金:8.4768666666666667,盈亏金额:-0.603200,手续费:0.203203,返的手续费:0.020320,最后金额:46.4837282266666667
2022-03-11 16:08:43.629 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:08:43.629 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:43.712 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:43.713 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:08:43.713 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:43.795 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:43.796 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:08:43.796 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:43.893 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:43.893 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:08:43.893 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:43.975 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:43.975 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:08:43.976 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:44.058 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:44.058 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:08:44.083 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:08:44.083 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:44.163 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:44.172 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:08:44.172 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:44.254 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:44.254 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `liquidate_by` LIKE '%coerceClose%' LIMIT 0,1000 
2022-03-11 16:08:44.255 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:08:44.337 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:08:44.338 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:08:44.339 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:08:44.420 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:08:44.421 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:08:44.421 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:44.505 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:44.506 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:08:44.506 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:08:44.589 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:08:44.590 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 账户初始保证金:8.4768666666666667,盈亏金额:-0.603200,手续费:0.203203,返的手续费:0.020320,最后金额:46.4837282266666667
2022-03-11 16:32:30.680 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:32:30.681 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:32:30.763 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:32:30.763 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:32:30.763 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:30.842 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:30.842 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:418.5824397623529412,hold:0E-16
2022-03-11 16:32:30.842 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-663.1385436799999999,操作后，计算剩余的金额:-563.1385436799999999,操作后，数据库存储的总金额:418.5824397623529412
2022-03-11 16:32:30.843 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:32:30.844 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:32:30.926 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:32:30.926 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:32:30.927 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:32:31.008 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:32:31.009 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:32:31.010 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:32:31.090 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:32:31.091 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:32:31.091 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:32:31.172 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:32:31.173 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:32:31.173 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:32:31.254 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:32:31.255 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:32:31.256 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:32:31.256 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:32:31.345 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 12
2022-03-11 16:32:31.345 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-37.8772058823529411, preBalance=100.0000000000000000, postBalance=62.1227941176470589, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5145, note=单号:5145开仓保证金-37.8772058823529411, createdDate=2022-03-11 16:27:06, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1030260000000000, preBalance=62.1227941176470589, postBalance=62.2258201176470589, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5145, note=单号:5145返还手续费0.1030260000000000, createdDate=2022-03-11 16:27:06, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0302600000000000, preBalance=62.2258201176470589, postBalance=61.1955601176470589, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5145, note=单号:5145开仓手续费-1.0302600000000000, createdDate=2022-03-11 16:27:10, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-41.8910500000000000, preBalance=61.1955601176470589, postBalance=19.3045101176470589, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5146, note=单号:5146开仓保证金-41.8910500000000000, createdDate=2022-03-11 16:27:11, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1139430000000000, preBalance=19.3045101176470589, postBalance=19.4184531176470589, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5146, note=单号:5146返还手续费0.1139430000000000, createdDate=2022-03-11 16:27:11, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.1394365600000000, preBalance=19.4184531176470589, postBalance=18.2790165576470589, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5146, note=单号:5146开仓手续费-1.1394365600000000, createdDate=2022-03-11 16:27:20, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-623.4229941176470588, preBalance=1000.0000000000000000, postBalance=375.6502389623529412, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5147, note=单号:5147平仓收益-624.3497610376470588, createdDate=2022-03-11 16:27:36, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1029730000000000, preBalance=375.6502389623529412, postBalance=375.6502389623529412, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5147, note=单号:5147返还手续费0.1029730000000000, createdDate=2022-03-11 16:27:36, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.0297399200000000, preBalance=375.6502389623529412, postBalance=375.6502389623529412, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5147, note=单号:5147平仓手续费-1.0297399200000000, createdDate=2022-03-11 16:27:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=43.9569500000000000, preBalance=375.6502389623529412, postBalance=418.5824397623529412, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5148, note=单号:5148平仓收益42.9322008000000000, createdDate=2022-03-11 16:27:48, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1138610000000000, preBalance=418.5824397623529412, postBalance=418.5824397623529412, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5148, note=单号:5148返还手续费0.1138610000000000, createdDate=2022-03-11 16:27:48, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.1386102000000000, preBalance=418.5824397623529412, postBalance=418.5824397623529412, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5148, note=单号:5148平仓手续费-1.1386102000000000, createdDate=2022-03-11 16:27:50, fromUserId=0, total=null)]
2022-03-11 16:32:31.347 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:32:31.347 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-37.8772058823529411
2022-03-11 16:32:31.347 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1030260000000000
2022-03-11 16:32:31.347 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0302600000000000
2022-03-11 16:32:31.348 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5145' LIMIT 0,1000 
2022-03-11 16:32:31.348 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:32:31.429 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:32:31.429 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:32:31.430 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:32:31.508 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:32:31.509 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5145' and type=? limit 0,1 
2022-03-11 16:32:31.510 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:32:31.590 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:31.591 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5145,数据库:0.103026,计算:0.103026
2022-03-11 16:32:31.591 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:32:31.591 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:31.671 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:31.672 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:32:31.672 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:31.751 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:31.752 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:32:31.752 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:31.835 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:31.836 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:32:31.836 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:31.915 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:31.916 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5145' and type=? limit 0,1 
2022-03-11 16:32:31.916 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:32:31.996 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:31.996 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5145,比列:0.300000,数据库:0.27817020,计算:0.278170
2022-03-11 16:32:31.996 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5145' and type=? limit 0,1 
2022-03-11 16:32:31.997 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:32:32.080 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:32.080 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5145,比列:0.200000,数据库:0.18544680,计算:0.185446
2022-03-11 16:32:32.081 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5145' and type=? limit 0,1 
2022-03-11 16:32:32.082 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:32:32.163 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:32.163 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5145,比列:0.400000,数据库:0.37089360,计算:0.370893
2022-03-11 16:32:32.164 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5145' and type=? limit 0,1 
2022-03-11 16:32:32.164 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:32:32.247 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:32.247 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5145,比列:0.100000,数据库:0.09272340,计算:0.092723
2022-03-11 16:32:32.247 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-41.8910500000000000
2022-03-11 16:32:32.247 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1139430000000000
2022-03-11 16:32:32.247 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.1394365600000000
2022-03-11 16:32:32.248 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5146' LIMIT 0,1000 
2022-03-11 16:32:32.248 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:32:32.330 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:32:32.330 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:32:32.330 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:32:32.414 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:32:32.415 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5146' and type=? limit 0,1 
2022-03-11 16:32:32.415 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:32:32.496 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:32.497 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5146,数据库:0.113943,计算:0.113943
2022-03-11 16:32:32.497 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:32:32.497 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:32.576 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:32.577 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:32:32.577 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:32.659 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:32.660 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:32:32.661 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:32.741 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:32.742 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:32:32.742 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:32.823 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:32.824 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5146' and type=? limit 0,1 
2022-03-11 16:32:32.825 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:32:32.906 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:32.907 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5146,比列:0.300000,数据库:0.30764806,计算:0.307647
2022-03-11 16:32:32.908 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5146' and type=? limit 0,1 
2022-03-11 16:32:32.908 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:32:32.991 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:32.991 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5146,比列:0.200000,数据库:0.20509871,计算:0.205098
2022-03-11 16:32:32.992 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5146' and type=? limit 0,1 
2022-03-11 16:32:32.993 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:32:33.073 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:33.074 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5146,比列:0.400000,数据库:0.41019742,计算:0.410197
2022-03-11 16:32:33.074 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5146' and type=? limit 0,1 
2022-03-11 16:32:33.075 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:32:33.155 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:33.155 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5146,比列:0.100000,数据库:0.10254935,计算:0.102549
2022-03-11 16:32:33.156 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-623.4229941176470588
2022-03-11 16:32:33.156 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5147' LIMIT 0,1000 
2022-03-11 16:32:33.156 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:32:33.236 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:32:33.237 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:32:33.237 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:32:33.315 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:32:33.316 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5147' 
2022-03-11 16:32:33.316 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:32:33.403 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:32:33.404 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5147' AND `margin_type` = 'FIXED' 
2022-03-11 16:32:33.405 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:32:33.484 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:32:33.485 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5147' and type=? limit 0,1 
2022-03-11 16:32:33.485 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:32:33.565 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:33.565 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5147,数据库:595.17018000,计算得:-661.300200
2022-03-11 16:32:33.566 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1029730000000000
2022-03-11 16:32:33.566 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.0297399200000000
2022-03-11 16:32:33.566 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5147' LIMIT 0,1000 
2022-03-11 16:32:33.566 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:32:33.649 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:32:33.649 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:32:33.649 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:32:33.729 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:32:33.730 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5147' and type=? limit 0,1 
2022-03-11 16:32:33.730 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:32:33.810 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:33.810 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5147,数据库:0.102973,计算:0.102973
2022-03-11 16:32:33.811 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:32:33.811 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:33.891 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:33.892 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:32:33.892 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:33.971 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:33.972 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:32:33.972 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:34.052 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:34.053 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:32:34.053 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:34.133 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:34.134 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5147' and type=? limit 0,1 
2022-03-11 16:32:34.134 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:32:34.214 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:34.214 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5147,比列:0.300000,数据库:0.27803007,计算:0.278029
2022-03-11 16:32:34.215 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5147' and type=? limit 0,1 
2022-03-11 16:32:34.215 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:32:34.295 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:34.296 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5147,比列:0.200000,数据库:0.18535338,计算:0.185353
2022-03-11 16:32:34.297 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5147' and type=? limit 0,1 
2022-03-11 16:32:34.297 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:32:34.377 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:34.377 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5147,比列:0.400000,数据库:0.37070676,计算:0.370706
2022-03-11 16:32:34.378 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5147' and type=? limit 0,1 
2022-03-11 16:32:34.379 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:32:34.459 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:34.459 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5147,比列:0.100000,数据库:0.09267669,计算:0.092676
2022-03-11 16:32:34.460 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:43.9569500000000000
2022-03-11 16:32:34.461 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5148' LIMIT 0,1000 
2022-03-11 16:32:34.461 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:32:34.542 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:32:34.543 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:32:34.543 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:32:34.624 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:32:34.625 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5148' 
2022-03-11 16:32:34.626 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:32:34.706 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:32:34.707 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5148' AND `margin_type` = 'FIXED' 
2022-03-11 16:32:34.708 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:32:34.786 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:32:34.787 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5148' and type=? limit 0,1 
2022-03-11 16:32:34.788 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:32:34.869 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:34.869 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5148,数据库:-1.85931000,计算得:2.065900
2022-03-11 16:32:34.870 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1138610000000000
2022-03-11 16:32:34.870 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.1386102000000000
2022-03-11 16:32:34.870 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5148' LIMIT 0,1000 
2022-03-11 16:32:34.870 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:32:34.950 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:32:34.951 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:32:34.951 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:32:35.031 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:32:35.032 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5148' and type=? limit 0,1 
2022-03-11 16:32:35.033 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:32:35.112 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:35.113 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5148,数据库:0.113861,计算:0.113861
2022-03-11 16:32:35.113 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:32:35.113 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:35.192 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:35.193 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:32:35.193 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:35.273 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:35.273 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:32:35.273 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:35.354 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:35.355 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:32:35.355 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:32:35.435 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:32:35.436 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5148' and type=? limit 0,1 
2022-03-11 16:32:35.437 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:32:35.518 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:35.518 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5148,比列:0.300000,数据库:0.30742476,计算:0.307424
2022-03-11 16:32:35.519 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5148' and type=? limit 0,1 
2022-03-11 16:32:35.519 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:32:35.599 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:35.599 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5148,比列:0.200000,数据库:0.20494984,计算:0.204949
2022-03-11 16:32:35.600 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5148' and type=? limit 0,1 
2022-03-11 16:32:35.600 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:32:35.688 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:35.688 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5148,比列:0.400000,数据库:0.40989968,计算:0.409899
2022-03-11 16:32:35.689 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5148' and type=? limit 0,1 
2022-03-11 16:32:35.689 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:32:35.769 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:32:35.769 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5148,比列:0.100000,数据库:0.10247492,计算:0.102474
2022-03-11 16:32:35.769 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:34:21.543 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:34:21.543 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:34:21.623 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:34:21.625 [http-nio-10090-exec-4] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:34:21.625 [http-nio-10090-exec-4] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:21.708 [http-nio-10090-exec-4] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:21.709 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:313.9463343064788734,hold:0E-16
2022-03-11 16:34:21.709 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:100.0,操作后，账户变化金额:-686.0536656935211266,操作后，计算剩余的金额:-586.0536656935211266,操作后，数据库存储的总金额:313.9463343064788734
2022-03-11 16:34:21.709 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:34:21.710 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:34:21.792 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:34:21.793 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:34:21.793 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:34:21.872 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:34:21.873 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:34:21.873 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:34:21.952 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:34:21.953 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:34:21.953 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:34:22.032 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:34:22.032 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:34:22.032 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:34:22.112 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:34:22.112 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:34:22.113 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:34:22.113 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:34:22.195 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 9
2022-03-11 16:34:22.195 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-37.7362764705882352, preBalance=1000.0000000000000000, postBalance=962.2637235294117648, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5149, note=单号:5149开仓保证金-37.7362764705882352, createdDate=2022-03-11 16:33:33, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026420000000000, preBalance=962.2637235294117648, postBalance=962.3663655294117648, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5149, note=单号:5149返还手续费0.1026420000000000, createdDate=2022-03-11 16:33:33, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0264267200000000, preBalance=962.3663655294117648, postBalance=961.3399388094117648, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5149, note=单号:5149开仓手续费-1.0264267200000000, createdDate=2022-03-11 16:33:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-23.5513422535211267, preBalance=961.3399388094117648, postBalance=937.7885965558906381, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5150, note=单号:5150开仓保证金-23.5513422535211267, createdDate=2022-03-11 16:33:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0668850000000000, preBalance=937.7885965558906381, postBalance=937.8554815558906381, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5150, note=单号:5150返还手续费0.0668850000000000, createdDate=2022-03-11 16:33:41, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.6688581200000000, preBalance=937.8554815558906381, postBalance=937.1866234358906381, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5150, note=单号:5150开仓手续费-0.6688581200000000, createdDate=2022-03-11 16:33:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-622.3165235294117647, preBalance=937.1866234358906381, postBalance=313.9463343064788734, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5151, note=单号:5151平仓收益-623.2402891294117647, createdDate=2022-03-11 16:34:16, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026400000000000, preBalance=313.9463343064788734, postBalance=313.9463343064788734, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5151, note=单号:5151返还手续费0.1026400000000000, createdDate=2022-03-11 16:34:16, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.0264056000000000, preBalance=313.9463343064788734, postBalance=313.9463343064788734, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5151, note=单号:5151平仓手续费-1.0264056000000000, createdDate=2022-03-11 16:34:20, fromUserId=0, total=null)]
2022-03-11 16:34:22.196 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:34:22.196 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-37.7362764705882352
2022-03-11 16:34:22.196 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026420000000000
2022-03-11 16:34:22.196 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0264267200000000
2022-03-11 16:34:22.196 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5149' LIMIT 0,1000 
2022-03-11 16:34:22.196 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:34:22.276 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:34:22.277 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:34:22.277 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:34:22.356 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:34:22.358 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5149' and type=? limit 0,1 
2022-03-11 16:34:22.358 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:34:22.439 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:22.439 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5149,数据库:0.102642,计算:0.102642
2022-03-11 16:34:22.440 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:34:22.440 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:22.519 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:22.521 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:34:22.522 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:22.602 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:22.604 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:34:22.604 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:22.695 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:22.696 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:34:22.696 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:22.781 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:22.781 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5149' and type=? limit 0,1 
2022-03-11 16:34:22.782 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:34:22.878 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:22.879 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5149,比列:0.300000,数据库:0.27713541,计算:0.277135
2022-03-11 16:34:22.879 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5149' and type=? limit 0,1 
2022-03-11 16:34:22.880 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:34:22.959 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:22.959 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5149,比列:0.200000,数据库:0.18475694,计算:0.184756
2022-03-11 16:34:22.960 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5149' and type=? limit 0,1 
2022-03-11 16:34:22.960 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:34:23.042 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:23.043 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5149,比列:0.400000,数据库:0.36951388,计算:0.369513
2022-03-11 16:34:23.045 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5149' and type=? limit 0,1 
2022-03-11 16:34:23.046 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:34:23.126 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:23.126 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5149,比列:0.100000,数据库:0.09237847,计算:0.092378
2022-03-11 16:34:23.127 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-23.5513422535211267
2022-03-11 16:34:23.127 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0668850000000000
2022-03-11 16:34:23.127 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.6688581200000000
2022-03-11 16:34:23.127 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5150' LIMIT 0,1000 
2022-03-11 16:34:23.128 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:34:23.208 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:34:23.208 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:34:23.209 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:34:23.288 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:34:23.290 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5150' and type=? limit 0,1 
2022-03-11 16:34:23.290 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:34:23.392 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:23.392 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5150,数据库:0.066885,计算:0.066885
2022-03-11 16:34:23.392 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:34:23.393 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:23.473 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:23.474 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:34:23.474 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:23.554 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:23.555 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:34:23.555 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:23.634 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:23.635 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:34:23.635 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:23.714 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:23.714 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5150' and type=? limit 0,1 
2022-03-11 16:34:23.715 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:34:23.795 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:23.795 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5150,比列:0.300000,数据库:0.18059193,计算:0.180591
2022-03-11 16:34:23.796 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5150' and type=? limit 0,1 
2022-03-11 16:34:23.796 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:34:23.876 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:23.876 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5150,比列:0.200000,数据库:0.12039462,计算:0.120394
2022-03-11 16:34:23.877 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5150' and type=? limit 0,1 
2022-03-11 16:34:23.877 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:34:23.956 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:23.957 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5150,比列:0.400000,数据库:0.24078924,计算:0.240788
2022-03-11 16:34:23.957 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5150' and type=? limit 0,1 
2022-03-11 16:34:23.958 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:34:24.037 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:24.037 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5150,比列:0.100000,数据库:0.06019731,计算:0.060197
2022-03-11 16:34:24.038 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-622.3165235294117647
2022-03-11 16:34:24.038 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5151' LIMIT 0,1000 
2022-03-11 16:34:24.039 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:34:24.120 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:34:24.121 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:34:24.121 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:34:24.202 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:34:24.202 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5151' 
2022-03-11 16:34:24.202 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:34:24.292 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:34:24.292 [http-nio-10090-exec-4] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5151' AND `margin_type` = 'FIXED' 
2022-03-11 16:34:24.292 [http-nio-10090-exec-4] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:34:24.377 [http-nio-10090-exec-4] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:34:24.377 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5151' and type=? limit 0,1 
2022-03-11 16:34:24.377 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:34:24.457 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:24.457 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5151,数据库:594.04752000,计算得:-660.052800
2022-03-11 16:34:24.457 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026400000000000
2022-03-11 16:34:24.457 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.0264056000000000
2022-03-11 16:34:24.458 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5151' LIMIT 0,1000 
2022-03-11 16:34:24.458 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:34:24.539 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:34:24.539 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:34:24.539 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:34:24.618 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:34:24.620 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5151' and type=? limit 0,1 
2022-03-11 16:34:24.620 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:34:24.700 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:24.700 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5151,数据库:0.102640,计算:0.102640
2022-03-11 16:34:24.701 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:34:24.701 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:24.780 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:24.781 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:34:24.781 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:24.860 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:24.861 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:34:24.861 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:24.940 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:24.941 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:34:24.941 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:25.020 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:25.021 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5151' and type=? limit 0,1 
2022-03-11 16:34:25.022 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:34:25.102 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:25.103 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5151,比列:0.300000,数据库:0.27712968,计算:0.277129
2022-03-11 16:34:25.104 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5151' and type=? limit 0,1 
2022-03-11 16:34:25.104 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:34:25.183 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:25.184 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5151,比列:0.200000,数据库:0.18475312,计算:0.184753
2022-03-11 16:34:25.184 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5151' and type=? limit 0,1 
2022-03-11 16:34:25.184 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:34:25.265 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:25.266 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5151,比列:0.400000,数据库:0.36950624,计算:0.369506
2022-03-11 16:34:25.266 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5151' and type=? limit 0,1 
2022-03-11 16:34:25.267 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:34:25.346 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:34:25.347 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5151,比列:0.100000,数据库:0.09237656,计算:0.092376
2022-03-11 16:34:25.347 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:34:40.955 [http-nio-10090-exec-6] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:34:40.956 [http-nio-10090-exec-6] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:41.036 [http-nio-10090-exec-6] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:41.037 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:34:41.037 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:34:41.118 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:34:41.144 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,账户user_balance:[UserBalanceChain(userId=51905047, currencyId=6, balance=1000.0000000000000000, hold=0E-16)],user_partner_balance:[UserBalanceChain(userId=51905047, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 16:35:28.007 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:35:28.007 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:35:28.087 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:35:28.087 [http-nio-10090-exec-8] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:28.087 [http-nio-10090-exec-8] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:28.168 [http-nio-10090-exec-8] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:28.168 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:913.8349009304021230,hold:0E-16
2022-03-11 16:35:28.169 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-86.1650990695978770,操作后，计算剩余的金额:913.8349009304021230,操作后，数据库存储的总金额:913.8349009304021230
2022-03-11 16:35:28.169 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:28.169 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:28.248 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:28.248 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:28.248 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:28.328 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:28.328 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:28.328 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:28.408 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:28.408 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:28.408 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:28.488 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:28.489 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:35:28.489 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:28.569 [http-nio-10090-exec-8] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:28.569 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:35:28.569 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:35:28.570 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:35:28.649 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 6
2022-03-11 16:35:28.650 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-36.1383464788732394, preBalance=1000.0000000000000000, postBalance=963.8616535211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓保证金-36.1383464788732394, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026320000000000, preBalance=963.8616535211267606, postBalance=963.9642855211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152返还手续费0.1026320000000000, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0263290400000000, preBalance=963.9642855211267606, postBalance=962.9379564811267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓手续费-1.0263290400000000, createdDate=2022-03-11 16:34:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-47.9128985507246376, preBalance=962.9379564811267606, postBalance=915.0250579304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓保证金-47.9128985507246376, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322390000000000, preBalance=915.0250579304021230, postBalance=915.1572969304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153返还手续费0.1322390000000000, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.3223960000000000, preBalance=915.1572969304021230, postBalance=913.8349009304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓手续费-1.3223960000000000, createdDate=2022-03-11 16:35:00, fromUserId=0, total=null)]
2022-03-11 16:35:28.650 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:35:28.650 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-36.1383464788732394
2022-03-11 16:35:28.651 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026320000000000
2022-03-11 16:35:28.651 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0263290400000000
2022-03-11 16:35:28.651 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5152' LIMIT 0,1000 
2022-03-11 16:35:28.651 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:28.730 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:28.731 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:28.731 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:28.811 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:28.811 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:28.812 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:35:28.891 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:28.892 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5152,数据库:0.102632,计算:0.102632
2022-03-11 16:35:28.892 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:28.892 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:28.973 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:28.973 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:28.974 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:29.053 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:29.053 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:29.054 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:29.146 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:29.146 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:29.147 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:29.229 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:29.230 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:29.230 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:35:29.310 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:29.311 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5152,比列:0.300000,数据库:0.27710911,计算:0.277108
2022-03-11 16:35:29.311 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:29.312 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:35:29.392 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:29.393 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5152,比列:0.200000,数据库:0.18473940,计算:0.184739
2022-03-11 16:35:29.394 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:29.394 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:35:29.474 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:29.474 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5152,比列:0.400000,数据库:0.36947881,计算:0.369478
2022-03-11 16:35:29.475 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:29.475 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:35:29.553 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:29.554 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5152,比列:0.100000,数据库:0.09236970,计算:0.092369
2022-03-11 16:35:29.554 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-47.9128985507246376
2022-03-11 16:35:29.554 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322390000000000
2022-03-11 16:35:29.554 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.3223960000000000
2022-03-11 16:35:29.554 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5153' LIMIT 0,1000 
2022-03-11 16:35:29.554 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:29.633 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:29.634 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:29.634 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:29.713 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:29.714 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:29.714 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:35:29.793 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:29.793 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5153,数据库:0.132239,计算:0.132239
2022-03-11 16:35:29.794 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:29.794 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:29.877 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:29.878 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:29.878 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:29.958 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:29.959 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:29.959 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:30.052 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:30.052 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:30.052 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:30.135 [http-nio-10090-exec-8] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:30.136 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:30.136 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:35:30.230 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:30.230 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5153,比列:0.300000,数据库:0.35704710,计算:0.357046
2022-03-11 16:35:30.231 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:30.231 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:35:30.312 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:30.312 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5153,比列:0.200000,数据库:0.23803140,计算:0.238031
2022-03-11 16:35:30.312 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:30.313 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:35:30.393 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:30.393 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5153,比列:0.400000,数据库:0.47606280,计算:0.476062
2022-03-11 16:35:30.394 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:30.394 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:35:30.475 [http-nio-10090-exec-8] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:30.475 [http-nio-10090-exec-8] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5153,比列:0.100000,数据库:0.11901570,计算:0.119015
2022-03-11 16:35:30.476 [http-nio-10090-exec-8] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:35:37.529 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:35:37.530 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:35:37.610 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:35:37.610 [http-nio-10090-exec-9] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:37.610 [http-nio-10090-exec-9] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:37.692 [http-nio-10090-exec-9] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:37.692 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:364.9288690811267607,hold:0E-16
2022-03-11 16:35:37.692 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-633.7489865188732393,操作后，计算剩余的金额:366.2510134811267607,操作后，数据库存储的总金额:364.9288690811267607
2022-03-11 16:35:37.692 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:37.692 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:37.776 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:37.777 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:37.777 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:37.857 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:37.858 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:37.858 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:37.938 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:37.939 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:37.939 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:38.019 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:38.020 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:35:38.020 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:38.100 [http-nio-10090-exec-9] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:38.100 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:35:38.101 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:35:38.101 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:35:38.184 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 8
2022-03-11 16:35:38.184 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-36.1383464788732394, preBalance=1000.0000000000000000, postBalance=963.8616535211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓保证金-36.1383464788732394, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026320000000000, preBalance=963.8616535211267606, postBalance=963.9642855211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152返还手续费0.1026320000000000, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0263290400000000, preBalance=963.9642855211267606, postBalance=962.9379564811267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓手续费-1.0263290400000000, createdDate=2022-03-11 16:34:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-47.9128985507246376, preBalance=962.9379564811267606, postBalance=915.0250579304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓保证金-47.9128985507246376, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322390000000000, preBalance=915.0250579304021230, postBalance=915.1572969304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153返还手续费0.1322390000000000, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.3223960000000000, preBalance=915.1572969304021230, postBalance=913.8349009304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓手续费-1.3223960000000000, createdDate=2022-03-11 16:35:00, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-547.7161014492753623, preBalance=913.8349009304021230, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154平仓收益-548.9060318492753623, createdDate=2022-03-11 16:35:35, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322140000000000, preBalance=364.9288690811267607, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154返还手续费0.1322140000000000, createdDate=2022-03-11 16:35:35, fromUserId=0, total=null)]
2022-03-11 16:35:38.185 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:35:38.185 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-36.1383464788732394
2022-03-11 16:35:38.185 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026320000000000
2022-03-11 16:35:38.186 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0263290400000000
2022-03-11 16:35:38.186 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5152' LIMIT 0,1000 
2022-03-11 16:35:38.186 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:38.266 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:38.267 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:38.267 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:38.346 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:38.348 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:38.348 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:35:38.428 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:38.428 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5152,数据库:0.102632,计算:0.102632
2022-03-11 16:35:38.429 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:38.429 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:38.508 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:38.509 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:38.509 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:38.589 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:38.590 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:38.590 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:38.670 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:38.670 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:38.670 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:38.750 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:38.751 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:38.752 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:35:38.835 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:38.835 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5152,比列:0.300000,数据库:0.27710911,计算:0.277108
2022-03-11 16:35:38.836 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:38.837 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:35:38.917 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:38.917 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5152,比列:0.200000,数据库:0.18473940,计算:0.184739
2022-03-11 16:35:38.918 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:38.919 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:35:39.001 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:39.001 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5152,比列:0.400000,数据库:0.36947881,计算:0.369478
2022-03-11 16:35:39.002 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:39.002 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:35:39.082 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:39.082 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5152,比列:0.100000,数据库:0.09236970,计算:0.092369
2022-03-11 16:35:39.082 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-47.9128985507246376
2022-03-11 16:35:39.082 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322390000000000
2022-03-11 16:35:39.082 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.3223960000000000
2022-03-11 16:35:39.083 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5153' LIMIT 0,1000 
2022-03-11 16:35:39.083 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:39.163 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:39.164 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:39.164 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:39.244 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:39.246 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:39.247 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:35:39.328 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:39.328 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5153,数据库:0.132239,计算:0.132239
2022-03-11 16:35:39.329 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:39.329 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:39.416 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:39.417 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:39.417 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:39.496 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:39.497 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:39.497 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:39.578 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:39.579 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:39.579 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:39.660 [http-nio-10090-exec-9] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:39.661 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:39.661 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:35:39.747 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:39.747 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5153,比列:0.300000,数据库:0.35704710,计算:0.357046
2022-03-11 16:35:39.748 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:39.748 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:35:39.830 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:39.830 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5153,比列:0.200000,数据库:0.23803140,计算:0.238031
2022-03-11 16:35:39.831 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:39.831 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:35:39.915 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:39.916 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5153,比列:0.400000,数据库:0.47606280,计算:0.476062
2022-03-11 16:35:39.916 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:39.916 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:35:39.999 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:40.000 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5153,比列:0.100000,数据库:0.11901570,计算:0.119015
2022-03-11 16:35:40.000 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-547.7161014492753623
2022-03-11 16:35:40.000 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5154' LIMIT 0,1000 
2022-03-11 16:35:40.001 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:40.084 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:40.085 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:40.085 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:40.180 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:40.181 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5154' 
2022-03-11 16:35:40.181 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:35:40.261 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:35:40.262 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5154' AND `margin_type` = 'FIXED' 
2022-03-11 16:35:40.262 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:35:40.343 [http-nio-10090-exec-9] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:35:40.344 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:35:40.344 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:35:40.427 [http-nio-10090-exec-9] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:40.427 [http-nio-10090-exec-9] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5154,数据库:536.06610000,计算得:-595.629000
2022-03-11 16:35:40.428 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322140000000000
2022-03-11 16:35:40.428 [http-nio-10090-exec-9] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:35:46.263 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:35:46.264 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:35:46.349 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:35:46.349 [http-nio-10090-exec-2] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:46.349 [http-nio-10090-exec-2] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:46.430 [http-nio-10090-exec-2] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:46.430 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:364.9288690811267607,hold:0E-16
2022-03-11 16:35:46.430 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-635.0711309188732393,操作后，计算剩余的金额:364.9288690811267607,操作后，数据库存储的总金额:364.9288690811267607
2022-03-11 16:35:46.430 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:46.431 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:46.511 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:46.512 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:46.512 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:46.592 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:46.592 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:46.592 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:46.672 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:46.672 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:46.673 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:46.762 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:46.763 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:35:46.763 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:35:46.843 [http-nio-10090-exec-2] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:35:46.844 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:35:46.844 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:35:46.845 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:35:46.930 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 9
2022-03-11 16:35:46.930 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-36.1383464788732394, preBalance=1000.0000000000000000, postBalance=963.8616535211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓保证金-36.1383464788732394, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026320000000000, preBalance=963.8616535211267606, postBalance=963.9642855211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152返还手续费0.1026320000000000, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0263290400000000, preBalance=963.9642855211267606, postBalance=962.9379564811267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓手续费-1.0263290400000000, createdDate=2022-03-11 16:34:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-47.9128985507246376, preBalance=962.9379564811267606, postBalance=915.0250579304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓保证金-47.9128985507246376, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322390000000000, preBalance=915.0250579304021230, postBalance=915.1572969304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153返还手续费0.1322390000000000, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.3223960000000000, preBalance=915.1572969304021230, postBalance=913.8349009304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓手续费-1.3223960000000000, createdDate=2022-03-11 16:35:00, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-547.7161014492753623, preBalance=913.8349009304021230, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154平仓收益-548.9060318492753623, createdDate=2022-03-11 16:35:35, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322140000000000, preBalance=364.9288690811267607, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154返还手续费0.1322140000000000, createdDate=2022-03-11 16:35:35, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.3221444000000000, preBalance=364.9288690811267607, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154平仓手续费-1.3221444000000000, createdDate=2022-03-11 16:35:40, fromUserId=0, total=null)]
2022-03-11 16:35:46.931 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:35:46.931 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-36.1383464788732394
2022-03-11 16:35:46.931 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026320000000000
2022-03-11 16:35:46.931 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0263290400000000
2022-03-11 16:35:46.932 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5152' LIMIT 0,1000 
2022-03-11 16:35:46.932 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:47.017 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:47.018 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:47.018 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:47.097 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:47.098 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:47.098 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:35:47.178 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:47.178 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5152,数据库:0.102632,计算:0.102632
2022-03-11 16:35:47.178 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:47.178 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:47.259 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:47.259 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:47.259 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:47.339 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:47.340 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:47.341 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:47.421 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:47.421 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:47.421 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:47.500 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:47.501 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:47.501 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:35:47.581 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:47.581 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5152,比列:0.300000,数据库:0.27710911,计算:0.277108
2022-03-11 16:35:47.582 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:47.582 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:35:47.665 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:47.665 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5152,比列:0.200000,数据库:0.18473940,计算:0.184739
2022-03-11 16:35:47.666 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:47.666 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:35:47.749 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:47.750 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5152,比列:0.400000,数据库:0.36947881,计算:0.369478
2022-03-11 16:35:47.751 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:35:47.751 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:35:47.832 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:47.832 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5152,比列:0.100000,数据库:0.09236970,计算:0.092369
2022-03-11 16:35:47.832 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-47.9128985507246376
2022-03-11 16:35:47.832 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322390000000000
2022-03-11 16:35:47.832 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.3223960000000000
2022-03-11 16:35:47.833 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5153' LIMIT 0,1000 
2022-03-11 16:35:47.833 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:47.914 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:47.915 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:47.915 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:47.996 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:47.997 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:47.997 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:35:48.081 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:48.081 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5153,数据库:0.132239,计算:0.132239
2022-03-11 16:35:48.082 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:48.082 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:48.161 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:48.161 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:48.161 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:48.242 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:48.242 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:48.242 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:48.323 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:48.324 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:48.324 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:48.403 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:48.404 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:48.404 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:35:48.484 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:48.484 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5153,比列:0.300000,数据库:0.35704710,计算:0.357046
2022-03-11 16:35:48.485 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:48.486 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:35:48.566 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:48.567 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5153,比列:0.200000,数据库:0.23803140,计算:0.238031
2022-03-11 16:35:48.567 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:48.568 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:35:48.649 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:48.650 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5153,比列:0.400000,数据库:0.47606280,计算:0.476062
2022-03-11 16:35:48.650 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:35:48.651 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:35:48.736 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:48.736 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5153,比列:0.100000,数据库:0.11901570,计算:0.119015
2022-03-11 16:35:48.737 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-547.7161014492753623
2022-03-11 16:35:48.738 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5154' LIMIT 0,1000 
2022-03-11 16:35:48.738 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:48.818 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:48.819 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:48.819 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:48.899 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:48.900 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5154' 
2022-03-11 16:35:48.900 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:35:48.979 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:35:48.980 [http-nio-10090-exec-2] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5154' AND `margin_type` = 'FIXED' 
2022-03-11 16:35:48.980 [http-nio-10090-exec-2] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:35:49.060 [http-nio-10090-exec-2] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:35:49.061 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:35:49.062 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:35:49.147 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:49.147 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(未开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5154,数据库:536.06610000,计算得:-595.629000
2022-03-11 16:35:49.147 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322140000000000
2022-03-11 16:35:49.147 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.3221444000000000
2022-03-11 16:35:49.148 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5154' LIMIT 0,1000 
2022-03-11 16:35:49.148 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:35:49.229 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:35:49.229 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:35:49.229 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:35:49.309 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:35:49.310 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:35:49.310 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:35:49.390 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:49.390 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5154,数据库:0.132214,计算:0.132214
2022-03-11 16:35:49.391 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:35:49.391 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:49.472 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:49.472 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:35:49.473 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:49.552 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:49.552 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:35:49.552 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:49.634 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:49.635 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:35:49.635 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:35:49.716 [http-nio-10090-exec-2] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:35:49.717 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:35:49.717 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:35:49.799 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:49.799 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5154,比列:0.300000,数据库:0.35697912,计算:0.356978
2022-03-11 16:35:49.800 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:35:49.800 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:35:49.883 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:49.883 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5154,比列:0.200000,数据库:0.23798608,计算:0.237985
2022-03-11 16:35:49.884 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:35:49.884 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:35:49.964 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:49.965 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5154,比列:0.400000,数据库:0.47597216,计算:0.475971
2022-03-11 16:35:49.965 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:35:49.966 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:35:50.045 [http-nio-10090-exec-2] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:35:50.046 [http-nio-10090-exec-2] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5154,比列:0.100000,数据库:0.11899304,计算:0.118992
2022-03-11 16:35:50.046 [http-nio-10090-exec-2] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:36:29.967 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:36:29.969 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:36:30.048 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:36:30.049 [http-nio-10090-exec-4] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:30.049 [http-nio-10090-exec-4] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:30.130 [http-nio-10090-exec-4] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:30.130 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:364.9288690811267607,hold:0E-16
2022-03-11 16:36:30.131 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-635.0711309188732393,操作后，计算剩余的金额:364.9288690811267607,操作后，数据库存储的总金额:364.9288690811267607
2022-03-11 16:36:30.131 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:30.132 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:30.216 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:30.217 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:30.217 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:30.295 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:30.296 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:30.296 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:30.376 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:30.377 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:30.377 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:30.458 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:30.458 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:36:30.459 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:30.538 [http-nio-10090-exec-4] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:30.539 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:36:30.541 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:36:30.541 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:36:30.624 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 9
2022-03-11 16:36:30.625 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-36.1383464788732394, preBalance=1000.0000000000000000, postBalance=963.8616535211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓保证金-36.1383464788732394, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026320000000000, preBalance=963.8616535211267606, postBalance=963.9642855211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152返还手续费0.1026320000000000, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0263290400000000, preBalance=963.9642855211267606, postBalance=962.9379564811267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓手续费-1.0263290400000000, createdDate=2022-03-11 16:34:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-47.9128985507246376, preBalance=962.9379564811267606, postBalance=915.0250579304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓保证金-47.9128985507246376, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322390000000000, preBalance=915.0250579304021230, postBalance=915.1572969304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153返还手续费0.1322390000000000, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.3223960000000000, preBalance=915.1572969304021230, postBalance=913.8349009304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓手续费-1.3223960000000000, createdDate=2022-03-11 16:35:00, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-547.7161014492753623, preBalance=913.8349009304021230, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154平仓收益-548.9060318492753623, createdDate=2022-03-11 16:35:35, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322140000000000, preBalance=364.9288690811267607, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154返还手续费0.1322140000000000, createdDate=2022-03-11 16:35:35, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.3221444000000000, preBalance=364.9288690811267607, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154平仓手续费-1.3221444000000000, createdDate=2022-03-11 16:35:40, fromUserId=0, total=null)]
2022-03-11 16:36:30.626 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:36:30.627 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-36.1383464788732394
2022-03-11 16:36:30.627 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026320000000000
2022-03-11 16:36:30.627 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0263290400000000
2022-03-11 16:36:30.628 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5152' LIMIT 0,1000 
2022-03-11 16:36:30.628 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:30.711 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:30.711 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:30.711 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:30.797 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:30.798 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:30.798 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:36:30.893 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:30.894 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5152,数据库:0.102632,计算:0.102632
2022-03-11 16:36:30.894 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:30.894 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:30.974 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:30.974 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:30.975 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:31.055 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:31.056 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:31.057 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:31.137 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:31.138 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:31.138 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:31.220 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:31.221 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:31.221 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:36:31.300 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:31.301 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5152,比列:0.300000,数据库:0.27710911,计算:0.277108
2022-03-11 16:36:31.301 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:31.301 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:36:31.381 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:31.381 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5152,比列:0.200000,数据库:0.18473940,计算:0.184739
2022-03-11 16:36:31.381 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:31.382 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:36:31.461 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:31.461 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5152,比列:0.400000,数据库:0.36947881,计算:0.369478
2022-03-11 16:36:31.461 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:31.462 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:36:31.541 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:31.542 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5152,比列:0.100000,数据库:0.09236970,计算:0.092369
2022-03-11 16:36:31.542 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-47.9128985507246376
2022-03-11 16:36:31.542 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322390000000000
2022-03-11 16:36:31.542 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.3223960000000000
2022-03-11 16:36:31.543 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5153' LIMIT 0,1000 
2022-03-11 16:36:31.543 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:31.623 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:31.624 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:31.624 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:31.703 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:31.705 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:31.705 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:36:31.784 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:31.800 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5153,数据库:0.132239,计算:0.132239
2022-03-11 16:36:31.802 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:31.803 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:31.882 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:31.883 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:31.883 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:31.962 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:31.962 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:31.962 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:32.042 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:32.043 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:32.043 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:32.123 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:32.124 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:32.124 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:36:32.206 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:32.207 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5153,比列:0.300000,数据库:0.35704710,计算:0.357046
2022-03-11 16:36:32.208 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:32.208 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:36:32.288 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:32.288 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5153,比列:0.200000,数据库:0.23803140,计算:0.238031
2022-03-11 16:36:32.289 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:32.290 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:36:32.371 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:32.372 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5153,比列:0.400000,数据库:0.47606280,计算:0.476062
2022-03-11 16:36:32.373 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:32.373 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:36:32.453 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:32.454 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5153,比列:0.100000,数据库:0.11901570,计算:0.119015
2022-03-11 16:36:32.454 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-547.7161014492753623
2022-03-11 16:36:32.455 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5154' LIMIT 0,1000 
2022-03-11 16:36:32.455 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:32.537 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:32.538 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:32.538 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:32.617 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:32.618 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5154' 
2022-03-11 16:36:32.619 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:36:32.700 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:36:32.701 [http-nio-10090-exec-4] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5154' AND `margin_type` = 'FIXED' 
2022-03-11 16:36:32.701 [http-nio-10090-exec-4] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:36:32.784 [http-nio-10090-exec-4] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:36:32.785 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:32.785 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:36:32.865 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:32.865 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51905041,交易类型:4,订单:5154,比例:0.100000,数据库:59.56290000,计算得:59.562900
2022-03-11 16:36:32.866 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:32.866 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:36:32.947 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:32.947 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5154,数据库:536.06610000,计算得:536.066100
2022-03-11 16:36:32.948 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322140000000000
2022-03-11 16:36:32.948 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.3221444000000000
2022-03-11 16:36:32.948 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5154' LIMIT 0,1000 
2022-03-11 16:36:32.948 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:33.033 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:33.033 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:33.034 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:33.114 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:33.115 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:33.115 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:36:33.198 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:33.198 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5154,数据库:0.132214,计算:0.132214
2022-03-11 16:36:33.198 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:33.199 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:33.279 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:33.279 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:33.279 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:33.359 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:33.359 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:33.359 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:33.439 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:33.440 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:33.440 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:33.522 [http-nio-10090-exec-4] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:33.523 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:33.524 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:36:33.606 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:33.606 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5154,比列:0.300000,数据库:0.35697912,计算:0.356978
2022-03-11 16:36:33.607 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:33.607 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:36:33.690 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:33.690 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5154,比列:0.200000,数据库:0.23798608,计算:0.237985
2022-03-11 16:36:33.691 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:33.691 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:36:33.772 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:33.772 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5154,比列:0.400000,数据库:0.47597216,计算:0.475971
2022-03-11 16:36:33.773 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:33.774 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:36:33.854 [http-nio-10090-exec-4] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:33.855 [http-nio-10090-exec-4] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5154,比列:0.100000,数据库:0.11899304,计算:0.118992
2022-03-11 16:36:33.855 [http-nio-10090-exec-4] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:36:42.783 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:36:42.783 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:36:42.864 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:36:42.864 [http-nio-10090-exec-6] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:42.864 [http-nio-10090-exec-6] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:42.944 [http-nio-10090-exec-6] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:42.945 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:397.8789040000000001,hold:0E-16
2022-03-11 16:36:42.946 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-602.1210959999999999,操作后，计算剩余的金额:397.8789040000000001,操作后，数据库存储的总金额:397.8789040000000001
2022-03-11 16:36:42.946 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:42.947 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:43.027 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:43.028 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:43.028 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:43.109 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:43.110 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:43.110 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:43.190 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:43.190 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:43.190 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:43.279 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:43.279 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:36:43.280 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:36:43.360 [http-nio-10090-exec-6] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:36:43.361 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:36:43.362 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:36:43.362 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:36:43.446 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 12
2022-03-11 16:36:43.447 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-36.1383464788732394, preBalance=1000.0000000000000000, postBalance=963.8616535211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓保证金-36.1383464788732394, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026320000000000, preBalance=963.8616535211267606, postBalance=963.9642855211267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152返还手续费0.1026320000000000, createdDate=2022-03-11 16:34:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0263290400000000, preBalance=963.9642855211267606, postBalance=962.9379564811267606, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5152, note=单号:5152开仓手续费-1.0263290400000000, createdDate=2022-03-11 16:34:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-47.9128985507246376, preBalance=962.9379564811267606, postBalance=915.0250579304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓保证金-47.9128985507246376, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322390000000000, preBalance=915.0250579304021230, postBalance=915.1572969304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153返还手续费0.1322390000000000, createdDate=2022-03-11 16:34:57, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.3223960000000000, preBalance=915.1572969304021230, postBalance=913.8349009304021230, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5153, note=单号:5153开仓手续费-1.3223960000000000, createdDate=2022-03-11 16:35:00, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-547.7161014492753623, preBalance=913.8349009304021230, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154平仓收益-548.9060318492753623, createdDate=2022-03-11 16:35:35, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1322140000000000, preBalance=364.9288690811267607, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154返还手续费0.1322140000000000, createdDate=2022-03-11 16:35:35, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.3221444000000000, preBalance=364.9288690811267607, postBalance=364.9288690811267607, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5154, note=单号:5154平仓手续费-1.3221444000000000, createdDate=2022-03-11 16:35:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=33.8745464788732394, preBalance=364.9288690811267607, postBalance=397.8789040000000001, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5155, note=单号:5155平仓收益32.9500349188732394, createdDate=2022-03-11 16:36:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1027230000000000, preBalance=397.8789040000000001, postBalance=397.8789040000000001, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5155, note=单号:5155返还手续费0.1027230000000000, createdDate=2022-03-11 16:36:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.0272345600000000, preBalance=397.8789040000000001, postBalance=397.8789040000000001, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5155, note=单号:5155平仓手续费-1.0272345600000000, createdDate=2022-03-11 16:36:40, fromUserId=0, total=null)]
2022-03-11 16:36:43.448 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:36:43.449 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-36.1383464788732394
2022-03-11 16:36:43.449 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026320000000000
2022-03-11 16:36:43.449 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0263290400000000
2022-03-11 16:36:43.450 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5152' LIMIT 0,1000 
2022-03-11 16:36:43.450 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:43.536 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:43.537 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:43.537 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:43.622 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:43.623 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:43.624 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:36:43.704 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:43.704 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5152,数据库:0.102632,计算:0.102632
2022-03-11 16:36:43.704 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:43.704 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:43.785 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:43.785 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:43.786 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:43.864 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:43.865 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:43.865 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:43.944 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:43.945 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:43.945 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:44.024 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:44.025 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:44.025 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:36:44.104 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:44.104 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5152,比列:0.300000,数据库:0.27710911,计算:0.277108
2022-03-11 16:36:44.105 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:44.105 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:36:44.188 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:44.188 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5152,比列:0.200000,数据库:0.18473940,计算:0.184739
2022-03-11 16:36:44.189 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:44.189 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:36:44.270 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:44.270 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5152,比列:0.400000,数据库:0.36947881,计算:0.369478
2022-03-11 16:36:44.270 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5152' and type=? limit 0,1 
2022-03-11 16:36:44.271 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:36:44.350 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:44.351 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5152,比列:0.100000,数据库:0.09236970,计算:0.092369
2022-03-11 16:36:44.351 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-47.9128985507246376
2022-03-11 16:36:44.351 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322390000000000
2022-03-11 16:36:44.351 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.3223960000000000
2022-03-11 16:36:44.352 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5153' LIMIT 0,1000 
2022-03-11 16:36:44.352 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:44.432 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:44.433 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:44.433 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:44.513 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:44.515 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:44.515 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:36:44.594 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:44.595 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5153,数据库:0.132239,计算:0.132239
2022-03-11 16:36:44.595 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:44.595 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:44.681 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:44.681 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:44.682 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:44.763 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:44.764 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:44.765 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:44.844 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:44.845 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:44.846 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:44.926 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:44.927 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:44.927 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:36:45.009 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:45.009 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5153,比列:0.300000,数据库:0.35704710,计算:0.357046
2022-03-11 16:36:45.010 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:45.011 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:36:45.090 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:45.091 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5153,比列:0.200000,数据库:0.23803140,计算:0.238031
2022-03-11 16:36:45.091 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:45.091 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:36:45.174 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:45.174 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5153,比列:0.400000,数据库:0.47606280,计算:0.476062
2022-03-11 16:36:45.175 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5153' and type=? limit 0,1 
2022-03-11 16:36:45.175 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:36:45.261 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:45.261 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5153,比列:0.100000,数据库:0.11901570,计算:0.119015
2022-03-11 16:36:45.261 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-547.7161014492753623
2022-03-11 16:36:45.262 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5154' LIMIT 0,1000 
2022-03-11 16:36:45.262 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:45.342 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:45.343 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:45.343 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:45.421 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:45.422 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5154' 
2022-03-11 16:36:45.422 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:36:45.501 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:36:45.501 [http-nio-10090-exec-6] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5154' AND `margin_type` = 'FIXED' 
2022-03-11 16:36:45.502 [http-nio-10090-exec-6] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:36:45.581 [http-nio-10090-exec-6] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:36:45.581 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:45.581 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:36:45.662 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:45.662 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51905041,交易类型:4,订单:5154,比例:0.100000,数据库:59.56290000,计算得:59.562900
2022-03-11 16:36:45.662 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:45.663 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:36:45.742 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:45.742 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5154,数据库:536.06610000,计算得:536.066100
2022-03-11 16:36:45.742 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1322140000000000
2022-03-11 16:36:45.742 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.3221444000000000
2022-03-11 16:36:45.743 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5154' LIMIT 0,1000 
2022-03-11 16:36:45.743 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:45.825 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:45.826 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:45.826 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:45.906 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:45.906 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:45.907 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:36:45.986 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:45.986 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5154,数据库:0.132214,计算:0.132214
2022-03-11 16:36:45.987 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:45.987 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:46.068 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:46.069 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:46.069 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:46.149 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:46.149 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:46.149 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:46.230 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:46.231 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:46.231 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:46.311 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:46.312 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:46.312 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:36:46.393 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:46.393 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5154,比列:0.300000,数据库:0.35697912,计算:0.356978
2022-03-11 16:36:46.393 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:46.393 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:36:46.473 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:46.473 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5154,比列:0.200000,数据库:0.23798608,计算:0.237985
2022-03-11 16:36:46.474 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:46.474 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:36:46.554 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:46.555 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5154,比列:0.400000,数据库:0.47597216,计算:0.475971
2022-03-11 16:36:46.555 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5154' and type=? limit 0,1 
2022-03-11 16:36:46.555 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:36:46.634 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:46.634 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5154,比列:0.100000,数据库:0.11899304,计算:0.118992
2022-03-11 16:36:46.634 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:33.8745464788732394
2022-03-11 16:36:46.635 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5155' LIMIT 0,1000 
2022-03-11 16:36:46.635 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:46.719 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:46.720 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:46.720 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:46.806 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:46.807 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5155' 
2022-03-11 16:36:46.807 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:36:46.887 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:36:46.887 [http-nio-10090-exec-6] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5155' AND `margin_type` = 'FIXED' 
2022-03-11 16:36:46.888 [http-nio-10090-exec-6] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:36:46.967 [http-nio-10090-exec-6] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:36:46.968 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5155' and type=? limit 0,1 
2022-03-11 16:36:46.968 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:36:47.049 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:47.050 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51905041,交易类型:4,订单:5155,比例:0.100000,数据库:0.22638000,计算得:0.226380
2022-03-11 16:36:47.051 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5155' and type=? limit 0,1 
2022-03-11 16:36:47.051 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:36:47.131 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:47.131 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5155,数据库:2.03742000,计算得:2.037420
2022-03-11 16:36:47.131 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1027230000000000
2022-03-11 16:36:47.131 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.0272345600000000
2022-03-11 16:36:47.131 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5155' LIMIT 0,1000 
2022-03-11 16:36:47.132 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:36:47.212 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:36:47.213 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:36:47.213 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:36:47.293 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:36:47.295 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5155' and type=? limit 0,1 
2022-03-11 16:36:47.295 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:36:47.379 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:47.380 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5155,数据库:0.102723,计算:0.102723
2022-03-11 16:36:47.380 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:36:47.381 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:47.462 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:47.463 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:36:47.463 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:47.544 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:47.545 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:36:47.545 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:47.625 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:47.625 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:36:47.625 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:36:47.706 [http-nio-10090-exec-6] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:36:47.707 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5155' and type=? limit 0,1 
2022-03-11 16:36:47.707 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:36:47.787 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:47.788 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5155,比列:0.300000,数据库:0.27735346,计算:0.277353
2022-03-11 16:36:47.789 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5155' and type=? limit 0,1 
2022-03-11 16:36:47.789 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:36:47.872 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:47.872 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5155,比列:0.200000,数据库:0.18490231,计算:0.184902
2022-03-11 16:36:47.873 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5155' and type=? limit 0,1 
2022-03-11 16:36:47.874 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:36:47.955 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:47.956 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5155,比列:0.400000,数据库:0.36980462,计算:0.369804
2022-03-11 16:36:47.957 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5155' and type=? limit 0,1 
2022-03-11 16:36:47.957 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:36:48.041 [http-nio-10090-exec-6] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:36:48.042 [http-nio-10090-exec-6] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5155,比列:0.100000,数据库:0.09245115,计算:0.092451
2022-03-11 16:36:48.042 [http-nio-10090-exec-6] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:38:46.794 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:38:46.796 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:38:46.876 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:38:46.877 [http-nio-10090-exec-10] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:46.877 [http-nio-10090-exec-10] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:46.956 [http-nio-10090-exec-10] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:46.956 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:1485.1823456230985917,hold:0E-16
2022-03-11 16:38:46.956 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:486.2106203430985917,操作后，计算剩余的金额:1486.2106203430985917,操作后，数据库存储的总金额:1485.1823456230985917
2022-03-11 16:38:46.957 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:46.957 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:47.036 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:47.037 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:38:47.037 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:47.117 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:47.117 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:38:47.117 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:47.201 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:47.201 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:38:47.201 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:47.285 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:47.286 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:38:47.286 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:47.365 [http-nio-10090-exec-10] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:47.366 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:38:47.367 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:38:47.367 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:38:47.449 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 8
2022-03-11 16:38:47.449 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-37.2061130434782608, preBalance=1000.0000000000000000, postBalance=962.7938869565217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156开仓保证金-37.2061130434782608, createdDate=2022-03-11 16:37:25, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026880000000000, preBalance=962.7938869565217392, postBalance=962.8965749565217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156返还手续费0.1026880000000000, createdDate=2022-03-11 16:37:25, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0268887200000000, preBalance=962.8965749565217392, postBalance=961.8696862365217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156开仓手续费-1.0268887200000000, createdDate=2022-03-11 16:37:30, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-43.3256028169014084, preBalance=961.8696862365217392, postBalance=918.5440834196203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157开仓保证金-43.3256028169014084, createdDate=2022-03-11 16:37:34, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1230440000000000, preBalance=918.5440834196203308, postBalance=918.6671274196203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157返还手续费0.1230440000000000, createdDate=2022-03-11 16:37:34, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.2304471200000000, preBalance=918.6671274196203308, postBalance=917.4366802996203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157开仓手续费-1.2304471200000000, createdDate=2022-03-11 16:37:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=568.6711130434782609, preBalance=917.4366802996203308, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158平仓收益567.7456653234782609, createdDate=2022-03-11 16:38:44, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1028270000000000, preBalance=1485.1823456230985917, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158返还手续费0.1028270000000000, createdDate=2022-03-11 16:38:44, fromUserId=0, total=null)]
2022-03-11 16:38:47.450 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:38:47.451 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-37.2061130434782608
2022-03-11 16:38:47.451 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026880000000000
2022-03-11 16:38:47.451 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0268887200000000
2022-03-11 16:38:47.451 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5156' LIMIT 0,1000 
2022-03-11 16:38:47.451 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:38:47.532 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:38:47.532 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:38:47.533 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:38:47.611 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:38:47.612 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:47.613 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:38:47.692 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:47.692 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5156,数据库:0.102688,计算:0.102688
2022-03-11 16:38:47.692 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:38:47.692 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:47.771 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:47.772 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:38:47.772 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:47.852 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:47.853 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:38:47.853 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:47.935 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:47.935 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:47.935 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:48.015 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:48.017 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:48.017 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:38:48.096 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:48.097 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5156,比列:0.300000,数据库:0.27726021,计算:0.277259
2022-03-11 16:38:48.097 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:48.097 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:38:48.177 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:48.177 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5156,比列:0.200000,数据库:0.18484014,计算:0.184839
2022-03-11 16:38:48.177 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:48.177 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:38:48.257 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:48.258 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5156,比列:0.400000,数据库:0.36968028,计算:0.369679
2022-03-11 16:38:48.258 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:48.259 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:38:48.343 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:48.343 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5156,比列:0.100000,数据库:0.09242007,计算:0.092419
2022-03-11 16:38:48.343 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-43.3256028169014084
2022-03-11 16:38:48.343 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1230440000000000
2022-03-11 16:38:48.343 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.2304471200000000
2022-03-11 16:38:48.343 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5157' LIMIT 0,1000 
2022-03-11 16:38:48.344 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:38:48.424 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:38:48.424 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:38:48.424 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:38:48.506 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:38:48.507 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:48.507 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:38:48.587 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:48.587 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5157,数据库:0.123044,计算:0.123044
2022-03-11 16:38:48.588 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:38:48.588 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:48.667 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:48.668 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:38:48.668 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:48.748 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:48.749 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:38:48.751 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:48.836 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:48.836 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:48.837 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:48.916 [http-nio-10090-exec-10] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:48.917 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:48.917 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:38:48.997 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:48.997 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5157,比列:0.300000,数据库:0.33222093,计算:0.332220
2022-03-11 16:38:48.998 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:48.998 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:38:49.077 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:49.078 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5157,比列:0.200000,数据库:0.22148062,计算:0.221480
2022-03-11 16:38:49.078 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:49.078 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:38:49.158 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:49.158 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5157,比列:0.400000,数据库:0.44296124,计算:0.442960
2022-03-11 16:38:49.159 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:49.159 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:38:49.239 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:49.239 [http-nio-10090-exec-10] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5157,比列:0.100000,数据库:0.11074031,计算:0.110740
2022-03-11 16:38:49.239 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:568.6711130434782609
2022-03-11 16:38:49.240 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5158' LIMIT 0,1000 
2022-03-11 16:38:49.240 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:38:49.321 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:38:49.322 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:38:49.322 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:38:49.402 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:38:49.403 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5158' 
2022-03-11 16:38:49.403 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:38:49.483 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:38:49.483 [http-nio-10090-exec-10] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5158' AND `margin_type` = 'FIXED' 
2022-03-11 16:38:49.483 [http-nio-10090-exec-10] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:38:49.563 [http-nio-10090-exec-10] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:38:49.563 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:38:49.564 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:38:49.643 [http-nio-10090-exec-10] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 0
2022-03-11 16:38:49.643 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1028270000000000
2022-03-11 16:38:49.643 [http-nio-10090-exec-10] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:38:53.054 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:38:53.054 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:38:53.133 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:38:53.133 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:53.134 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:53.215 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:53.215 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:1485.1823456230985917,hold:0E-16
2022-03-11 16:38:53.215 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:485.1823456230985917,操作后，计算剩余的金额:1485.1823456230985917,操作后，数据库存储的总金额:1485.1823456230985917
2022-03-11 16:38:53.216 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:53.216 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:53.296 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:53.296 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:38:53.296 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:53.375 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:53.376 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:38:53.376 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:53.456 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:53.457 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:38:53.457 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:53.537 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:53.538 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:38:53.538 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:38:53.617 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:38:53.618 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:38:53.619 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:38:53.620 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:38:53.704 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 9
2022-03-11 16:38:53.704 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-37.2061130434782608, preBalance=1000.0000000000000000, postBalance=962.7938869565217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156开仓保证金-37.2061130434782608, createdDate=2022-03-11 16:37:25, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026880000000000, preBalance=962.7938869565217392, postBalance=962.8965749565217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156返还手续费0.1026880000000000, createdDate=2022-03-11 16:37:25, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0268887200000000, preBalance=962.8965749565217392, postBalance=961.8696862365217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156开仓手续费-1.0268887200000000, createdDate=2022-03-11 16:37:30, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-43.3256028169014084, preBalance=961.8696862365217392, postBalance=918.5440834196203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157开仓保证金-43.3256028169014084, createdDate=2022-03-11 16:37:34, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1230440000000000, preBalance=918.5440834196203308, postBalance=918.6671274196203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157返还手续费0.1230440000000000, createdDate=2022-03-11 16:37:34, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.2304471200000000, preBalance=918.6671274196203308, postBalance=917.4366802996203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157开仓手续费-1.2304471200000000, createdDate=2022-03-11 16:37:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=568.6711130434782609, preBalance=917.4366802996203308, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158平仓收益567.7456653234782609, createdDate=2022-03-11 16:38:44, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1028270000000000, preBalance=1485.1823456230985917, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158返还手续费0.1028270000000000, createdDate=2022-03-11 16:38:44, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.0282747200000000, preBalance=1485.1823456230985917, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158平仓手续费-1.0282747200000000, createdDate=2022-03-11 16:38:50, fromUserId=0, total=null)]
2022-03-11 16:38:53.705 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:38:53.706 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-37.2061130434782608
2022-03-11 16:38:53.706 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026880000000000
2022-03-11 16:38:53.706 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0268887200000000
2022-03-11 16:38:53.706 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5156' LIMIT 0,1000 
2022-03-11 16:38:53.707 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:38:53.788 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:38:53.788 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:38:53.789 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:38:53.868 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:38:53.869 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:53.869 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:38:53.949 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:53.950 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5156,数据库:0.102688,计算:0.102688
2022-03-11 16:38:53.950 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:38:53.950 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:54.040 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:54.041 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:38:54.041 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:54.122 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:54.122 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:38:54.123 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:54.203 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:54.204 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:54.204 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:54.287 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:54.288 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:54.289 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:38:54.370 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:54.371 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5156,比列:0.300000,数据库:0.27726021,计算:0.277259
2022-03-11 16:38:54.372 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:54.372 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:38:54.455 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:54.455 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5156,比列:0.200000,数据库:0.18484014,计算:0.184839
2022-03-11 16:38:54.456 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:54.456 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:38:54.539 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:54.539 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5156,比列:0.400000,数据库:0.36968028,计算:0.369679
2022-03-11 16:38:54.540 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:38:54.541 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:38:54.623 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:54.624 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5156,比列:0.100000,数据库:0.09242007,计算:0.092419
2022-03-11 16:38:54.624 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-43.3256028169014084
2022-03-11 16:38:54.624 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1230440000000000
2022-03-11 16:38:54.624 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.2304471200000000
2022-03-11 16:38:54.625 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5157' LIMIT 0,1000 
2022-03-11 16:38:54.625 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:38:54.705 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:38:54.706 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:38:54.706 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:38:54.786 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:38:54.787 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:54.788 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:38:54.871 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:54.871 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5157,数据库:0.123044,计算:0.123044
2022-03-11 16:38:54.872 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:38:54.872 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:54.962 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:54.963 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:38:54.963 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:55.043 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:55.043 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:38:55.043 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:55.122 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:55.122 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:55.122 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:55.202 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:55.203 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:55.203 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:38:55.287 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:55.287 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5157,比列:0.300000,数据库:0.33222093,计算:0.332220
2022-03-11 16:38:55.288 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:55.289 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:38:55.370 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:55.371 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5157,比列:0.200000,数据库:0.22148062,计算:0.221480
2022-03-11 16:38:55.372 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:55.372 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:38:55.452 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:55.453 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5157,比列:0.400000,数据库:0.44296124,计算:0.442960
2022-03-11 16:38:55.454 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:38:55.454 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:38:55.535 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:55.535 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5157,比列:0.100000,数据库:0.11074031,计算:0.110740
2022-03-11 16:38:55.536 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:568.6711130434782609
2022-03-11 16:38:55.536 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5158' LIMIT 0,1000 
2022-03-11 16:38:55.537 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:38:55.616 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:38:55.617 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:38:55.617 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:38:55.697 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:38:55.697 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5158' 
2022-03-11 16:38:55.697 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:38:55.776 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:38:55.777 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5158' AND `margin_type` = 'FIXED' 
2022-03-11 16:38:55.777 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:38:55.868 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:38:55.869 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:38:55.870 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:38:55.951 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:55.951 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51905041,交易类型:4,订单:5158,比例:0.100000,数据库:-53.14650000,计算得:-53.146500
2022-03-11 16:38:55.952 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:38:55.952 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:38:56.032 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:56.032 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5158,数据库:-478.31850000,计算得:-478.318500
2022-03-11 16:38:56.032 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1028270000000000
2022-03-11 16:38:56.032 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.0282747200000000
2022-03-11 16:38:56.033 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5158' LIMIT 0,1000 
2022-03-11 16:38:56.033 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:38:56.124 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:38:56.125 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:38:56.125 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:38:56.206 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:38:56.207 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:38:56.208 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:38:56.290 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:56.291 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5158,数据库:0.102827,计算:0.102827
2022-03-11 16:38:56.291 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:38:56.291 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:56.371 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:56.372 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:38:56.372 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:56.453 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:56.453 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:38:56.454 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:56.533 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:56.533 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:38:56.534 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:38:56.614 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:38:56.614 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:38:56.615 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:38:56.695 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:56.695 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5158,比列:0.300000,数据库:0.27763431,计算:0.277634
2022-03-11 16:38:56.696 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:38:56.696 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:38:56.788 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:56.788 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5158,比列:0.200000,数据库:0.18508954,计算:0.185089
2022-03-11 16:38:56.789 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:38:56.789 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:38:56.870 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:56.871 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5158,比列:0.400000,数据库:0.37017908,计算:0.370178
2022-03-11 16:38:56.872 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:38:56.872 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:38:56.952 [http-nio-10090-exec-1] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:38:56.952 [http-nio-10090-exec-1] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5158,比列:0.100000,数据库:0.09254477,计算:0.092544
2022-03-11 16:38:56.952 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:39:26.413 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:39:26.414 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:39:26.493 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:39:26.494 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:39:26.494 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:26.575 [http-nio-10090-exec-3] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:26.575 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:1365.3226777600000002,hold:0E-16
2022-03-11 16:39:26.575 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:366.5547554400000002,操作后，计算剩余的金额:1366.5547554400000002,操作后，数据库存储的总金额:1365.3226777600000002
2022-03-11 16:39:26.576 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:39:26.576 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:39:26.654 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:39:26.655 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:39:26.655 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:39:26.734 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:39:26.734 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:39:26.735 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:39:26.814 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:39:26.814 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:39:26.814 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:39:26.898 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:39:26.898 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:39:26.898 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:39:26.977 [http-nio-10090-exec-3] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:39:26.977 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:39:26.977 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:39:26.977 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:39:27.059 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 11
2022-03-11 16:39:27.059 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-37.2061130434782608, preBalance=1000.0000000000000000, postBalance=962.7938869565217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156开仓保证金-37.2061130434782608, createdDate=2022-03-11 16:37:25, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026880000000000, preBalance=962.7938869565217392, postBalance=962.8965749565217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156返还手续费0.1026880000000000, createdDate=2022-03-11 16:37:25, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0268887200000000, preBalance=962.8965749565217392, postBalance=961.8696862365217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156开仓手续费-1.0268887200000000, createdDate=2022-03-11 16:37:30, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-43.3256028169014084, preBalance=961.8696862365217392, postBalance=918.5440834196203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157开仓保证金-43.3256028169014084, createdDate=2022-03-11 16:37:34, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1230440000000000, preBalance=918.5440834196203308, postBalance=918.6671274196203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157返还手续费0.1230440000000000, createdDate=2022-03-11 16:37:34, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.2304471200000000, preBalance=918.6671274196203308, postBalance=917.4366802996203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157开仓手续费-1.2304471200000000, createdDate=2022-03-11 16:37:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=568.6711130434782609, preBalance=917.4366802996203308, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158平仓收益567.7456653234782609, createdDate=2022-03-11 16:38:44, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1028270000000000, preBalance=1485.1823456230985917, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158返还手续费0.1028270000000000, createdDate=2022-03-11 16:38:44, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.0282747200000000, preBalance=1485.1823456230985917, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158平仓手续费-1.0282747200000000, createdDate=2022-03-11 16:38:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-118.7507971830985915, preBalance=1485.1823456230985917, postBalance=1365.3226777600000002, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5159, note=单号:5159平仓收益-119.8596678630985915, createdDate=2022-03-11 16:39:22, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1232070000000000, preBalance=1365.3226777600000002, postBalance=1365.3226777600000002, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5159, note=单号:5159返还手续费0.1232070000000000, createdDate=2022-03-11 16:39:22, fromUserId=0, total=null)]
2022-03-11 16:39:27.060 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:39:27.060 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-37.2061130434782608
2022-03-11 16:39:27.060 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026880000000000
2022-03-11 16:39:27.060 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0268887200000000
2022-03-11 16:39:27.060 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5156' LIMIT 0,1000 
2022-03-11 16:39:27.061 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:39:27.140 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:39:27.140 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:39:27.140 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:39:27.220 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:39:27.220 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:39:27.221 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:39:27.304 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:27.304 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5156,数据库:0.102688,计算:0.102688
2022-03-11 16:39:27.305 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:39:27.305 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:27.385 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:27.386 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:39:27.386 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:27.464 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:27.465 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:39:27.465 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:27.545 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:27.545 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:39:27.546 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:27.625 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:27.625 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:39:27.625 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:39:27.705 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:27.705 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5156,比列:0.300000,数据库:0.27726021,计算:0.277259
2022-03-11 16:39:27.705 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:39:27.706 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:39:27.784 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:27.784 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5156,比列:0.200000,数据库:0.18484014,计算:0.184839
2022-03-11 16:39:27.785 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:39:27.785 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:39:27.868 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:27.868 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5156,比列:0.400000,数据库:0.36968028,计算:0.369679
2022-03-11 16:39:27.868 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:39:27.868 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:39:27.953 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:27.953 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5156,比列:0.100000,数据库:0.09242007,计算:0.092419
2022-03-11 16:39:27.953 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-43.3256028169014084
2022-03-11 16:39:27.953 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1230440000000000
2022-03-11 16:39:27.953 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.2304471200000000
2022-03-11 16:39:27.954 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5157' LIMIT 0,1000 
2022-03-11 16:39:27.954 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:39:28.033 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:39:28.033 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:39:28.034 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:39:28.112 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:39:28.113 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:39:28.113 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:39:28.193 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:28.193 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5157,数据库:0.123044,计算:0.123044
2022-03-11 16:39:28.194 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:39:28.194 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:28.273 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:28.273 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:39:28.273 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:28.351 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:28.352 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:39:28.353 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:28.432 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:28.432 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:39:28.432 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:28.512 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:28.513 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:39:28.513 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:39:28.593 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:28.593 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5157,比列:0.300000,数据库:0.33222093,计算:0.332220
2022-03-11 16:39:28.593 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:39:28.593 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:39:28.673 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:28.673 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5157,比列:0.200000,数据库:0.22148062,计算:0.221480
2022-03-11 16:39:28.673 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:39:28.674 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:39:28.756 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:28.756 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5157,比列:0.400000,数据库:0.44296124,计算:0.442960
2022-03-11 16:39:28.756 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:39:28.756 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:39:28.837 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:28.837 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5157,比列:0.100000,数据库:0.11074031,计算:0.110740
2022-03-11 16:39:28.837 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:568.6711130434782609
2022-03-11 16:39:28.837 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5158' LIMIT 0,1000 
2022-03-11 16:39:28.837 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:39:28.917 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:39:28.917 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:39:28.918 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:39:28.996 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:39:28.997 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5158' 
2022-03-11 16:39:28.997 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:39:29.077 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:39:29.077 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5158' AND `margin_type` = 'FIXED' 
2022-03-11 16:39:29.077 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:39:29.156 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:39:29.156 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:39:29.157 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:39:29.236 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:29.236 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51905041,交易类型:4,订单:5158,比例:0.100000,数据库:-53.14650000,计算得:-53.146500
2022-03-11 16:39:29.237 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:39:29.237 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:39:29.319 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:29.319 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5158,数据库:-478.31850000,计算得:-478.318500
2022-03-11 16:39:29.320 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1028270000000000
2022-03-11 16:39:29.320 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.0282747200000000
2022-03-11 16:39:29.320 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5158' LIMIT 0,1000 
2022-03-11 16:39:29.320 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:39:29.414 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:39:29.414 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:39:29.414 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:39:29.493 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:39:29.493 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:39:29.493 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:39:29.574 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:29.574 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5158,数据库:0.102827,计算:0.102827
2022-03-11 16:39:29.574 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:39:29.574 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:29.653 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:29.654 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:39:29.654 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:29.733 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:29.733 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:39:29.733 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:29.812 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:29.812 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:39:29.812 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:39:29.892 [http-nio-10090-exec-3] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:39:29.893 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:39:29.893 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:39:29.972 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:29.972 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5158,比列:0.300000,数据库:0.27763431,计算:0.277634
2022-03-11 16:39:29.972 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:39:29.973 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:39:30.056 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:30.057 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5158,比列:0.200000,数据库:0.18508954,计算:0.185089
2022-03-11 16:39:30.057 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:39:30.057 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:39:30.138 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:30.138 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5158,比列:0.400000,数据库:0.37017908,计算:0.370178
2022-03-11 16:39:30.138 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:39:30.139 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:39:30.224 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:30.224 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5158,比列:0.100000,数据库:0.09254477,计算:0.092544
2022-03-11 16:39:30.224 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-118.7507971830985915
2022-03-11 16:39:30.224 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5159' LIMIT 0,1000 
2022-03-11 16:39:30.224 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:39:30.304 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:39:30.305 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:39:30.305 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:39:30.384 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:39:30.385 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5159' 
2022-03-11 16:39:30.385 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:39:30.464 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:39:30.464 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5159' AND `margin_type` = 'FIXED' 
2022-03-11 16:39:30.464 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:39:30.545 [http-nio-10090-exec-3] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:39:30.545 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:39:30.546 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:39:30.625 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:30.625 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51905041,交易类型:4,订单:5159,比例:0.100000,数据库:16.20764000,计算得:16.207640
2022-03-11 16:39:30.625 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:39:30.625 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:39:30.706 [http-nio-10090-exec-3] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:39:30.706 [http-nio-10090-exec-3] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5159,数据库:145.86876000,计算得:145.868760
2022-03-11 16:39:30.706 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1232070000000000
2022-03-11 16:39:30.706 [http-nio-10090-exec-3] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:40:20.125 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 16:40:20.126 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 16:40:20.205 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 16:40:20.205 [http-nio-10090-exec-5] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:40:20.205 [http-nio-10090-exec-5] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:20.286 [http-nio-10090-exec-5] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:20.287 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:1365.3226777600000002,hold:0E-16
2022-03-11 16:40:20.287 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:365.3226777600000002,操作后，计算剩余的金额:1365.3226777600000002,操作后，数据库存储的总金额:1365.3226777600000002
2022-03-11 16:40:20.287 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:40:20.287 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:40:20.374 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:40:20.374 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:40:20.374 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:40:20.458 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:40:20.459 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:40:20.459 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:40:20.540 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:40:20.540 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:40:20.541 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:40:20.621 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:40:20.622 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 16:40:20.622 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 16:40:20.702 [http-nio-10090-exec-5] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 16:40:20.702 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 16:40:20.703 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 16:40:20.704 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 16:40:20.788 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 12
2022-03-11 16:40:20.788 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-37.2061130434782608, preBalance=1000.0000000000000000, postBalance=962.7938869565217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156开仓保证金-37.2061130434782608, createdDate=2022-03-11 16:37:25, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1026880000000000, preBalance=962.7938869565217392, postBalance=962.8965749565217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156返还手续费0.1026880000000000, createdDate=2022-03-11 16:37:25, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.0268887200000000, preBalance=962.8965749565217392, postBalance=961.8696862365217392, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5156, note=单号:5156开仓手续费-1.0268887200000000, createdDate=2022-03-11 16:37:30, fromUserId=0, total=null), UserBillChain(userId=51905047, type=3, size=-43.3256028169014084, preBalance=961.8696862365217392, postBalance=918.5440834196203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157开仓保证金-43.3256028169014084, createdDate=2022-03-11 16:37:34, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1230440000000000, preBalance=918.5440834196203308, postBalance=918.6671274196203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157返还手续费0.1230440000000000, createdDate=2022-03-11 16:37:34, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-1.2304471200000000, preBalance=918.6671274196203308, postBalance=917.4366802996203308, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5157, note=单号:5157开仓手续费-1.2304471200000000, createdDate=2022-03-11 16:37:40, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=568.6711130434782609, preBalance=917.4366802996203308, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158平仓收益567.7456653234782609, createdDate=2022-03-11 16:38:44, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1028270000000000, preBalance=1485.1823456230985917, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158返还手续费0.1028270000000000, createdDate=2022-03-11 16:38:44, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.0282747200000000, preBalance=1485.1823456230985917, postBalance=1485.1823456230985917, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5158, note=单号:5158平仓手续费-1.0282747200000000, createdDate=2022-03-11 16:38:50, fromUserId=0, total=null), UserBillChain(userId=51905047, type=4, size=-118.7507971830985915, preBalance=1485.1823456230985917, postBalance=1365.3226777600000002, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5159, note=单号:5159平仓收益-119.8596678630985915, createdDate=2022-03-11 16:39:22, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.1232070000000000, preBalance=1365.3226777600000002, postBalance=1365.3226777600000002, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5159, note=单号:5159返还手续费0.1232070000000000, createdDate=2022-03-11 16:39:22, fromUserId=0, total=null), UserBillChain(userId=51905047, type=52, size=-1.2320776800000000, preBalance=1365.3226777600000002, postBalance=1365.3226777600000002, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5159, note=单号:5159平仓手续费-1.2320776800000000, createdDate=2022-03-11 16:39:30, fromUserId=0, total=null)]
2022-03-11 16:40:20.790 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 16:40:20.790 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-37.2061130434782608
2022-03-11 16:40:20.790 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1026880000000000
2022-03-11 16:40:20.790 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.0268887200000000
2022-03-11 16:40:20.790 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5156' LIMIT 0,1000 
2022-03-11 16:40:20.791 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:40:20.879 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:40:20.879 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:40:20.880 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:40:20.962 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:40:20.963 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:40:20.964 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:40:21.043 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:21.044 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5156,数据库:0.102688,计算:0.102688
2022-03-11 16:40:21.044 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:40:21.045 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:21.124 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:21.125 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:40:21.125 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:21.205 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:21.206 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:40:21.206 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:21.287 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:21.287 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:40:21.287 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:21.367 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:21.368 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:40:21.368 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:40:21.450 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:21.451 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5156,比列:0.300000,数据库:0.27726021,计算:0.277259
2022-03-11 16:40:21.451 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:40:21.452 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:40:21.533 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:21.533 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5156,比列:0.200000,数据库:0.18484014,计算:0.184839
2022-03-11 16:40:21.534 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:40:21.534 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:40:21.614 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:21.614 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5156,比列:0.400000,数据库:0.36968028,计算:0.369679
2022-03-11 16:40:21.615 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5156' and type=? limit 0,1 
2022-03-11 16:40:21.615 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:40:21.694 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:21.694 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5156,比列:0.100000,数据库:0.09242007,计算:0.092419
2022-03-11 16:40:21.694 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-43.3256028169014084
2022-03-11 16:40:21.694 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1230440000000000
2022-03-11 16:40:21.695 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-1.2304471200000000
2022-03-11 16:40:21.695 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5157' LIMIT 0,1000 
2022-03-11 16:40:21.695 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:40:21.775 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:40:21.776 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:40:21.776 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:40:21.855 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:40:21.856 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:40:21.857 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:40:21.938 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:21.938 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5157,数据库:0.123044,计算:0.123044
2022-03-11 16:40:21.939 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:40:21.939 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:22.019 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:22.020 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:40:22.020 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:22.100 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:22.101 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:40:22.101 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:22.181 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:22.181 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:40:22.182 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:22.260 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:22.261 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:40:22.261 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:40:22.346 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:22.347 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5157,比列:0.300000,数据库:0.33222093,计算:0.332220
2022-03-11 16:40:22.347 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:40:22.347 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:40:22.427 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:22.427 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5157,比列:0.200000,数据库:0.22148062,计算:0.221480
2022-03-11 16:40:22.428 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:40:22.428 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:40:22.508 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:22.508 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5157,比列:0.400000,数据库:0.44296124,计算:0.442960
2022-03-11 16:40:22.509 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5157' and type=? limit 0,1 
2022-03-11 16:40:22.509 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:40:22.591 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:22.592 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5157,比列:0.100000,数据库:0.11074031,计算:0.110740
2022-03-11 16:40:22.592 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:568.6711130434782609
2022-03-11 16:40:22.592 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5158' LIMIT 0,1000 
2022-03-11 16:40:22.593 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:40:22.673 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:40:22.674 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:40:22.674 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:40:22.759 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:40:22.759 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5158' 
2022-03-11 16:40:22.760 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:40:22.839 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:40:22.840 [http-nio-10090-exec-5] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5158' AND `margin_type` = 'FIXED' 
2022-03-11 16:40:22.840 [http-nio-10090-exec-5] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:40:22.922 [http-nio-10090-exec-5] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:40:22.923 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:40:22.923 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:40:23.005 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:23.005 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51905041,交易类型:4,订单:5158,比例:0.100000,数据库:-53.14650000,计算得:-53.146500
2022-03-11 16:40:23.006 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:40:23.007 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:40:23.089 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:23.089 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5158,数据库:-478.31850000,计算得:-478.318500
2022-03-11 16:40:23.089 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1028270000000000
2022-03-11 16:40:23.089 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.0282747200000000
2022-03-11 16:40:23.090 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5158' LIMIT 0,1000 
2022-03-11 16:40:23.090 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:40:23.171 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:40:23.172 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:40:23.173 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:40:23.252 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:40:23.253 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:40:23.254 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:40:23.338 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:23.338 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5158,数据库:0.102827,计算:0.102827
2022-03-11 16:40:23.339 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:40:23.339 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:23.424 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:23.425 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:40:23.425 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:23.505 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:23.505 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:40:23.505 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:23.584 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:23.585 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:40:23.585 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:23.666 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:23.667 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:40:23.667 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:40:23.746 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:23.746 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5158,比列:0.300000,数据库:0.27763431,计算:0.277634
2022-03-11 16:40:23.747 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:40:23.747 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:40:23.831 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:23.832 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5158,比列:0.200000,数据库:0.18508954,计算:0.185089
2022-03-11 16:40:23.832 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:40:23.832 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:40:23.913 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:23.913 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5158,比列:0.400000,数据库:0.37017908,计算:0.370178
2022-03-11 16:40:23.914 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5158' and type=? limit 0,1 
2022-03-11 16:40:23.914 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:40:23.994 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:23.994 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5158,比列:0.100000,数据库:0.09254477,计算:0.092544
2022-03-11 16:40:23.994 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓-平仓收益:-118.7507971830985915
2022-03-11 16:40:23.995 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5159' LIMIT 0,1000 
2022-03-11 16:40:23.995 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:40:24.075 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:40:24.075 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:40:24.076 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:40:24.157 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:40:24.158 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==>  Preparing: SELECT id sourceId,margin_type marginType FROM `bib_cfd`.`swap_order` WHERE `id` = '5159' 
2022-03-11 16:40:24.158 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - ==> Parameters: 
2022-03-11 16:40:24.237 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getMarginType - <==      Total: 1
2022-03-11 16:40:24.238 [http-nio-10090-exec-5] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==>  Preparing: SELECT amount,profit,fee FROM `bib_cfd`.`clearing_transfer` WHERE `user_id` = '51905047' AND `source_type` LIKE 'cfd.bill.type.code.4' AND `order_id` = '5159' AND `margin_type` = 'FIXED' 
2022-03-11 16:40:24.238 [http-nio-10090-exec-5] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - ==> Parameters: 
2022-03-11 16:40:24.317 [http-nio-10090-exec-5] DEBUG c.z.demo.dao.dev1.AccountDao.getClearlingTransfer - <==      Total: 1
2022-03-11 16:40:24.318 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:40:24.318 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 27(Integer)
2022-03-11 16:40:24.397 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:24.397 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51905041,交易类型:4,订单:5159,比例:0.100000,数据库:16.20764000,计算得:16.207640
2022-03-11 16:40:24.398 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:40:24.398 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 27(Integer)
2022-03-11 16:40:24.478 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:24.478 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.ProfitCalc - morePartnerProfit--有合伙人(开启对赌)--盈亏校验--->用户:51905047,默认合伙人:51904446,交易类型:4,订单:5159,数据库:145.86876000,计算得:145.868760
2022-03-11 16:40:24.478 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.1232070000000000
2022-03-11 16:40:24.478 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 平仓手续费 -扣用户:-1.2320776800000000
2022-03-11 16:40:24.478 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5159' LIMIT 0,1000 
2022-03-11 16:40:24.478 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 16:40:24.561 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 1
2022-03-11 16:40:24.561 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 16:40:24.561 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 16:40:24.640 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 16:40:24.640 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:40:24.640 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 16:40:24.721 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:24.721 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:52,订单:5159,数据库:0.123207,计算:0.123207
2022-03-11 16:40:24.722 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 16:40:24.722 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:24.805 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:24.806 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 16:40:24.806 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:24.891 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:24.891 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 16:40:24.891 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:24.973 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:24.974 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 16:40:24.974 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 16:40:25.054 [http-nio-10090-exec-5] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 16:40:25.054 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:40:25.055 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 16:40:25.135 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:25.136 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:52,订单:5159,比列:0.300000,数据库:0.33266120,计算:0.332660
2022-03-11 16:40:25.137 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:40:25.137 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 16:40:25.217 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:25.218 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:52,订单:5159,比列:0.200000,数据库:0.22177413,计算:0.221773
2022-03-11 16:40:25.218 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:40:25.219 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 16:40:25.299 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:25.299 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:52,订单:5159,比列:0.400000,数据库:0.44354827,计算:0.443547
2022-03-11 16:40:25.299 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5159' and type=? limit 0,1 
2022-03-11 16:40:25.299 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 16:40:25.379 [http-nio-10090-exec-5] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 16:40:25.380 [http-nio-10090-exec-5] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:52,订单:5159,比列:0.100000,数据库:0.11088706,计算:0.110886
2022-03-11 16:40:25.380 [http-nio-10090-exec-5] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 17:06:56.990 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 17:06:56.991 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 17:06:57.080 [http-nio-10090-exec-1] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 17:06:57.081 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 17:06:57.081 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 17:06:57.171 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 17:06:57.194 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,账户user_balance:[UserBalanceChain(userId=51905047, currencyId=6, balance=1000.0000000000000000, hold=0E-16)],user_partner_balance:[UserBalanceChain(userId=51905047, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 17:44:07.373 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==>  Preparing: SELECT user_id userId,sum(size) total from `bib_cfd`.`user_bill` where created_date>'' and user_id = ? and type not in (16,27) 
2022-03-11 17:44:07.375 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - ==> Parameters: 51905047(String)
2022-03-11 17:44:07.464 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillTotal - <==      Total: 1
2022-03-11 17:44:07.465 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 17:44:07.465 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - ==> Parameters: 
2022-03-11 17:44:07.554 [http-nio-10090-exec-7] DEBUG c.z.d.d.dev1.AccountDao.getUserBalanceHoldByUserId - <==      Total: 1
2022-03-11 17:44:07.555 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 操作后，数据库金额，balance:470.1570599312676057,hold:0E-16
2022-03-11 17:44:07.555 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 下单前，账户金额:1000.0,操作后，账户变化金额:-529.8429400687323943,操作后，计算剩余的金额:470.1570599312676057,操作后，数据库存储的总金额:470.1570599312676057
2022-03-11 17:44:07.555 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 17:44:07.555 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 17:44:07.645 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 17:44:07.645 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 17:44:07.645 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 17:44:07.736 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 17:44:07.736 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 17:44:07.736 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 17:44:07.826 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 17:44:07.826 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 17:44:07.826 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 17:44:07.917 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 17:44:07.917 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==>  Preparing: SELECT user_id userId,parent_id parentId,gparent_id gparentId,partner_id partnerId,dist_id distId,level,type,defaulted,config,open_bet openBet,is_profession isProfession FROM `bib_cfd`.`user_distributor` WHERE `user_id` = '51904446' LIMIT 0,1 
2022-03-11 17:44:07.917 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - ==> Parameters: 
2022-03-11 17:44:08.011 [http-nio-10090-exec-7] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserDistributor - <==      Total: 1
2022-03-11 17:44:08.012 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.SqlUtil - 用户:51905047,合伙人:[{"userId":"51905047","parentId":"51905041","gparentId":"0","partnerId":"51905041","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":}, {"userId":"51905041","parentId":"51905043","gparentId":"0","partnerId":"51905043","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.100000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.200000,"partnerTransferOutRatio":0.100000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905043","parentId":"51905052","gparentId":"0","partnerId":"51905052","distId":"0","level":"1","type":3,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.100000,"userLossGivingBonsRate":0.000000}}, {"userId":"51905052","parentId":"51904446","gparentId":"0","partnerId":"51904446","distId":"0","level":"1","type":0,"defaulted":"0","openBet":1,"isProfession":"0","config":{"allotLowerFeeRate":0.700000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.200000,"rebateUserRatio":0.300000,"userLossGivingBonsRate":0.000000}}, {"userId":"51904446","parentId":"0","gparentId":"0","partnerId":"0","distId":"0","level":"0","type":0,"defaulted":"1","openBet":0,"isProfession":"0","config":{"allotLowerFeeRate":0.500000,"level":0,"maxConfigLevel":10,"partnerTransferOutMin":0.000000,"partnerTransferOutRatio":0.000000,"rebateUserRatio":0.000000,"userLossGivingBonsRate":0.000000}}]
2022-03-11 17:44:08.012 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==>  Preparing: SELECT user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId FROM `bib_cfd`.`user_bill` WHERE `user_id` = '51905047' and created_date>='' 
2022-03-11 17:44:08.013 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - ==> Parameters: 
2022-03-11 17:44:08.113 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBillByUser - <==      Total: 4
2022-03-11 17:44:08.113 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51905047,流水:[UserBillChain(userId=51905047, type=3, size=-29.0991647887323943, preBalance=1000.0000000000000000, postBalance=970.9008352112676057, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5181, note=单号:5181开仓保证金-29.0991647887323943, createdDate=2022-03-11 17:42:42, fromUserId=0, total=null), UserBillChain(userId=51905047, type=41, size=0.0826410000000000, preBalance=970.9008352112676057, postBalance=970.9834762112676057, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5181, note=单号:5181返还手续费0.0826410000000000, createdDate=2022-03-11 17:42:42, fromUserId=0, total=null), UserBillChain(userId=51905047, type=51, size=-0.8264162800000000, preBalance=970.9834762112676057, postBalance=970.1570599312676057, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5181, note=单号:5181开仓手续费-0.8264162800000000, createdDate=2022-03-11 17:42:49, fromUserId=0, total=null), UserBillChain(userId=51905047, type=55, size=-500.0000000000000000, preBalance=970.1570599312676057, postBalance=470.1570599312676057, preProfit=0E-16, postProfit=0E-16, preMargin=0E-16, postMargin=0E-16, partnerId=51904446, parentId=51904446, sourceId=5181, note=单号:5181增加保证金-500.0000000000000000, createdDate=2022-03-11 17:43:57, fromUserId=0, total=null)]
2022-03-11 17:44:08.114 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 17:44:08.114 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓-保证金:-29.0991647887323943
2022-03-11 17:44:08.114 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 返手续费(给用户) 直接去掉不去返佣:0.0826410000000000
2022-03-11 17:44:08.114 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 开仓手续费(永续合约) -扣用户:-0.8264162800000000
2022-03-11 17:44:08.114 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==>  Preparing: SELECT id,position_id positionId,order_id orderId,user_id userId,symbol,leverage,margin_type marginType,direction,side,quantity,closed_quantity closedQuantity,margin, open_price openPrice,close_price closePrice,avg_cost avgCost,liquidate_by liquidateBy FROM `bib_cfd`.`position_action` WHERE `user_id` = '51905047' AND `order_id` = '5181' LIMIT 0,1000 
2022-03-11 17:44:08.114 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - ==> Parameters: 
2022-03-11 17:44:08.209 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.positionAction - <==      Total: 2
2022-03-11 17:44:08.209 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==>  Preparing: SELECT one_lot_size oneLotSize FROM `bib_cfd`.`instruments` WHERE `symbol` LIKE '%btcusdt%' 
2022-03-11 17:44:08.209 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - ==> Parameters: 
2022-03-11 17:44:08.305 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.instruments - <==      Total: 1
2022-03-11 17:44:08.312 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5181' and type=? limit 0,1 
2022-03-11 17:44:08.312 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905047(String), 41(Integer)
2022-03-11 17:44:08.402 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 17:44:08.403 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - partnerFee--有合伙人--用户先返回手续费--用户返手续费校验--->用户:51905047,交易类型:51,订单:5181,数据库:0.082641,计算:0.082641
2022-03-11 17:44:08.403 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905041' LIMIT 0,1 
2022-03-11 17:44:08.403 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 17:44:08.494 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 17:44:08.495 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905043' LIMIT 0,1 
2022-03-11 17:44:08.495 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 17:44:08.586 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 17:44:08.586 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905052' LIMIT 0,1 
2022-03-11 17:44:08.587 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 17:44:08.677 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 17:44:08.677 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51905047' LIMIT 0,1 
2022-03-11 17:44:08.677 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 17:44:08.767 [http-nio-10090-exec-7] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 17:44:08.768 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5181' and type=? limit 0,1 
2022-03-11 17:44:08.769 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51904446(String), 16(Integer)
2022-03-11 17:44:08.859 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 17:44:08.859 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51904446,交易类型:51,订单:5181,比列:0.300000,数据库:0.22313258,计算:0.223132
2022-03-11 17:44:08.859 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5181' and type=? limit 0,1 
2022-03-11 17:44:08.860 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905052(String), 16(Integer)
2022-03-11 17:44:08.952 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 17:44:08.952 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905052,交易类型:51,订单:5181,比列:0.200000,数据库:0.14875505,计算:0.148754
2022-03-11 17:44:08.953 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5181' and type=? limit 0,1 
2022-03-11 17:44:08.953 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905043(String), 16(Integer)
2022-03-11 17:44:09.042 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 17:44:09.042 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905043,交易类型:51,订单:5181,比列:0.400000,数据库:0.29751011,计算:0.297509
2022-03-11 17:44:09.043 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==>  Preparing: select user_id userId,type,size,pre_balance preBalance,post_balance postBalance,pre_profit preProfit,post_profit postProfit,pre_margin preMargin,post_margin postMargin,partner_id partnerId,parent_id parentId,source_id sourceId,note,created_date createdDate,from_user_id fromUserId from `bib_cfd`.`user_bill` where user_id=? and source_id='5181' and type=? limit 0,1 
2022-03-11 17:44:09.043 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - ==> Parameters: 51905041(String), 16(Integer)
2022-03-11 17:44:09.136 [http-nio-10090-exec-7] DEBUG com.zmj.demo.dao.dev1.AccountDao.getUserBill - <==      Total: 1
2022-03-11 17:44:09.136 [http-nio-10090-exec-7] INFO  com.zmj.demo.common.dev1.FeeCalc - feeToPartnerClac--有合伙人--用户无返佣--手续费校验-->用户:51905047,合伙人:51905041,交易类型:51,订单:5181,比列:0.100000,数据库:0.07437752,计算:0.074377
2022-03-11 17:44:09.136 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 逐仓保证金划入:-500.0000000000000000
2022-03-11 17:44:09.136 [http-nio-10090-exec-7] INFO  com.zmj.demo.service.impl.ToolServiceImpl - --------51905047流水--------
2022-03-11 18:44:28.704 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m6s371ms).
2022-03-11 18:53:43.740 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=8m45s18ms).
2022-03-11 19:02:30.455 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=8m46s715ms).
2022-03-11 19:11:46.920 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=8m46s434ms).
2022-03-11 19:13:25.993 [HikariPool-1 housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m9s51ms).
2022-03-11 19:38:42.702 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-11 19:38:42.707 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2022-03-11 19:38:48.011 [main] INFO  com.zmj.demo.DemoApplication - Starting DemoApplication using Java 1.8.0_312 on gai.local with PID 87319 (/Users/mac/tools/gitPro/515/demo/target/classes started by mac in /Users/mac/tools/gitPro/515/demo)
2022-03-11 19:38:48.014 [main] INFO  com.zmj.demo.DemoApplication - No active profile set, falling back to default profiles: default
2022-03-11 19:38:49.016 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-11 19:38:49.020 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2022-03-11 19:38:49.043 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Elasticsearch repository interfaces.
2022-03-11 19:38:49.048 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-11 19:38:49.049 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2022-03-11 19:38:49.059 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Reactive Elasticsearch repository interfaces.
2022-03-11 19:38:49.071 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2022-03-11 19:38:49.072 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-03-11 19:38:49.090 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2022-03-11 19:38:49.817 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 10090 (http)
2022-03-11 19:38:49.832 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-10090"]
2022-03-11 19:38:49.833 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2022-03-11 19:38:49.833 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-11 19:38:50.003 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2022-03-11 19:38:50.003 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1932 ms
2022-03-11 19:38:51.175 [main] INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2022-03-11 19:38:51.907 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Spring Data Elasticsearch: 4.2.1
2022-03-11 19:38:51.908 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client in build: 7.12.1
2022-03-11 19:38:51.908 [main] INFO  o.s.data.elasticsearch.support.VersionInfo - Version Elasticsearch Client used: 7.12.1
2022-03-11 19:38:52.202 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-10090"]
2022-03-11 19:38:52.223 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 10090 (http) with context path ''
2022-03-11 19:38:52.235 [main] INFO  com.zmj.demo.DemoApplication - Started DemoApplication in 5.026 seconds (JVM running for 5.545)
2022-03-11 19:40:20.829 [http-nio-10090-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-03-11 19:40:20.832 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2022-03-11 19:40:20.833 [http-nio-10090-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2022-03-11 19:40:21.018 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2022-03-11 19:40:22.185 [http-nio-10090-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2022-03-11 19:40:22.203 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getAllUserBalanceHold - ==>  Preparing: SELECT sum(balance) balance,sum(hold) hold FROM `bib_cfd`.`user_balance` 
2022-03-11 19:40:22.231 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getAllUserBalanceHold - ==> Parameters: 
2022-03-11 19:40:22.353 [http-nio-10090-exec-1] DEBUG c.z.demo.dao.dev1.AccountDao.getAllUserBalanceHold - <==      Total: 1
2022-03-11 19:40:22.539 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.AccountDao.getAllUserPartnerBalanceHold - ==>  Preparing: SELECT sum(balance) balance,sum(hold) hold FROM `bib_cfd`.`user_partner_balance` 
2022-03-11 19:40:22.540 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.AccountDao.getAllUserPartnerBalanceHold - ==> Parameters: 
2022-03-11 19:40:22.628 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.AccountDao.getAllUserPartnerBalanceHold - <==      Total: 1
2022-03-11 19:40:22.648 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_balance` LIMIT 0,10 
2022-03-11 19:40:22.649 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - ==> Parameters: 
2022-03-11 19:40:22.738 [http-nio-10090-exec-1] DEBUG c.zmj.demo.dao.dev1.AccountDao.getUserBalanceHold - <==      Total: 10
2022-03-11 19:40:22.747 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51894801,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.758 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903407,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.767 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903408,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.777 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903409,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.785 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903410,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.794 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903411,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.802 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903412,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.812 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903413,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.820 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903414,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.829 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903415,账户user_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=170219466.9204301000000000, hold=0E-16), UserBalanceChain(userId=51903407, currencyId=6, balance=100.0000000000000000, hold=0E-16), UserBalanceChain(userId=51903408, currencyId=6, balance=0.0000921900000000, hold=0E-16), UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903410, currencyId=6, balance=4.3472462E-9, hold=0E-16), UserBalanceChain(userId=51903411, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903412, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903413, currencyId=6, balance=0E-16, hold=0E-16), UserBalanceChain(userId=51903414, currencyId=6, balance=0.0000337683950617, hold=0E-16), UserBalanceChain(userId=51903415, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:22.890 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51894801' LIMIT 0,1 
2022-03-11 19:40:22.891 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:22.978 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 19:40:22.992 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51894801,账户user_partner_balance:[UserBalanceChain(userId=51894801, currencyId=6, balance=861.2336963200000000, hold=0E-16)]
2022-03-11 19:40:22.992 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903407' LIMIT 0,1 
2022-03-11 19:40:22.993 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.079 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 0
2022-03-11 19:40:23.080 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903408' LIMIT 0,1 
2022-03-11 19:40:23.081 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.167 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 0
2022-03-11 19:40:23.167 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903409' LIMIT 0,1 
2022-03-11 19:40:23.167 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.254 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 19:40:23.270 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903409,账户user_partner_balance:[UserBalanceChain(userId=51903409, currencyId=6, balance=0E-16, hold=0E-16)]
2022-03-11 19:40:23.271 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903410' LIMIT 0,1 
2022-03-11 19:40:23.271 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.358 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 0
2022-03-11 19:40:23.359 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903411' LIMIT 0,1 
2022-03-11 19:40:23.359 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.451 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 0
2022-03-11 19:40:23.452 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903412' LIMIT 0,1 
2022-03-11 19:40:23.453 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.541 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 1
2022-03-11 19:40:23.559 [http-nio-10090-exec-1] INFO  com.zmj.demo.service.impl.ToolServiceImpl - 用户:51903412,账户user_partner_balance:[UserBalanceChain(userId=51903412, currencyId=6, balance=1000.0000000000000000, hold=0E-16)]
2022-03-11 19:40:23.560 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903413' LIMIT 0,1 
2022-03-11 19:40:23.560 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.647 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 0
2022-03-11 19:40:23.648 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903414' LIMIT 0,1 
2022-03-11 19:40:23.649 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.736 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 0
2022-03-11 19:40:23.736 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==>  Preparing: SELECT user_id userId,currency_id currencyId,balance,hold FROM `bib_cfd`.`user_partner_balance` WHERE `user_id` = '51903415' LIMIT 0,1 
2022-03-11 19:40:23.737 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - ==> Parameters: 
2022-03-11 19:40:23.823 [http-nio-10090-exec-1] DEBUG c.z.d.d.d.A.getUserPartnerBalanceHoldByUserId - <==      Total: 0
2022-03-11 20:09:10.881 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2022-03-11 20:09:10.893 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
